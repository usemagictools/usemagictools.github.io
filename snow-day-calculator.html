<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CT8E5N460D"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-CT8E5N460D');</script>
    <title>Snow Day Calculator - Free School Closure Predictor | No Ads, No Signup | é›ªæ—¥åœè¯¾è®¡ç®—å™¨ | Web Toolbox</title>

    <meta name="description" content="Free Snow Day Calculator predicts school closures using real-time weather data. Enter your ZIP code to check snow day probability. âœ… No ads âœ… No signup âœ… No limits. Runs entirely in your browser.">
    <meta name="keywords" content="snow day calculator,snow day predictor,school closure predictor,will school be closed tomorrow,snow day forecast,é›ªæ—¥è®¡ç®—å™¨,åœè¯¾é¢„æµ‹,no ads,no signup,no login,no watermark,free unlimited,browser-based,no installation,local processing">
    <meta name="author" content="UseMagicTools">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">
    <meta name="revisit-after" content="7 days">
    <meta name="rating" content="general">
    <meta name="distribution" content="global">
    <meta name="language" content="en">
    <link rel="canonical" href="https://www.usemagictools.com/snow-day-calculator.html">
    <link rel="alternate" hreflang="en" href="https://www.usemagictools.com/snow-day-calculator.html">
    <link rel="alternate" hreflang="zh-CN" href="https://www.usemagictools.com/snow-day-calculator.html">
    <link rel="alternate" hreflang="fr" href="https://www.usemagictools.com/snow-day-calculator.html">
    <link rel="alternate" hreflang="es" href="https://www.usemagictools.com/snow-day-calculator.html">
    <link rel="alternate" hreflang="x-default" href="https://www.usemagictools.com/snow-day-calculator.html">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.usemagictools.com/snow-day-calculator.html">
    <meta property="og:title" content="Snow Day Calculator - Free School Closure Predictor | No Ads, No Signup">
    <meta property="og:description" content="Predict school closures with real-time weather data. Enter ZIP code for instant snow day probability.">
    <meta property="og:image" content="https://www.usemagictools.com/screenshots/snow-day-calculator-v1.webp">
    <meta property="og:image:width" content="1200"><meta property="og:image:height" content="630">
    <meta property="og:locale" content="en_US"><meta property="og:locale:alternate" content="zh_CN"><meta property="og:site_name" content="Web Toolbox">

    <meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@usemagictools"><meta name="twitter:creator" content="@usemagictools">
    <meta name="twitter:title" content="Snow Day Calculator - Free School Closure Predictor | No Ads, No Signup">
    <meta name="twitter:description" content="Predict school closures with real-time weather data. Free, no signup required.">
    <meta name="twitter:image" content="https://www.usemagictools.com/screenshots/snow-day-calculator-v1.webp">

    <!-- JSON-LD: WebApplication -->
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"WebApplication","name":"Snow Day Calculator","alternateName":["é›ªæ—¥åœè¯¾è®¡ç®—å™¨","Snow Day Predictor","School Closure Calculator","Calculateur de jour de neige"],"url":"https://www.usemagictools.com/snow-day-calculator.html","description":"Free Snow Day Calculator predicts school closures using real-time weather forecast data. Enter your ZIP code and school type to get instant probability.","inLanguage":["en","zh-CN","fr","es"],"applicationCategory":"UtilitiesApplication","operatingSystem":"Web Browser","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"author":{"@type":"Person","name":"UseMagicTools"},"publisher":{"@type":"Organization","name":"Web Toolbox","url":"https://www.usemagictools.com/"},"featureList":["Real-time weather forecast analysis","ZIP code based prediction","School type adjustment","3-day snow day forecast","Temperature wind snowfall analysis","No ads","No signup required","No watermark","100% browser-based","Unlimited usage"],"screenshot":"https://www.usemagictools.com/screenshots/snow-day-calculator-v1.webp"}</script>
    <!-- JSON-LD: BreadcrumbList -->
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.usemagictools.com/"},{"@type":"ListItem","position":2,"name":"Snow Day Calculator","item":"https://www.usemagictools.com/snow-day-calculator.html"}]}</script>
    <!-- JSON-LD: HowTo -->
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"HowTo","name":"How to Use Snow Day Calculator","totalTime":"PT1M","step":[{"@type":"HowToStep","position":1,"name":"Enter ZIP Code","text":"Type your US ZIP code or city name into the search field."},{"@type":"HowToStep","position":2,"name":"Select School Type","text":"Choose your school type (Public, Private, Rural, etc.) for more accurate prediction."},{"@type":"HowToStep","position":3,"name":"Get Prediction","text":"Click Calculate to see your snow day probability with detailed weather breakdown."}]}</script>
    <!-- JSON-LD: FAQPage -->
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"What is a Snow Day Calculator and how does it work?","acceptedAnswer":{"@type":"Answer","text":"A Snow Day Calculator is a free online tool that predicts the probability of school closures due to winter weather. It analyzes real-time weather forecast data including snowfall accumulation, temperature, wind speed, and ice conditions for your specific location, then calculates a percentage chance that schools will close. Our calculator uses data from Open-Meteo weather service for accurate predictions."}},{"@type":"Question","name":"How accurate is the Snow Day Calculator prediction?","acceptedAnswer":{"@type":"Answer","text":"Snow day predictions within 24-48 hours typically achieve 75-85% accuracy. The calculator considers multiple factors including snowfall amount, temperature, wind speed, and regional infrastructure readiness. However, final closure decisions are always made by your local school district, so treat the probability as an informed estimate rather than a guarantee."}},{"@type":"Question","name":"What factors affect snow day probability?","acceptedAnswer":{"@type":"Answer","text":"Key factors include: snowfall accumulation (heaviest weight), temperature and wind chill, wind speed, ice/freezing rain conditions, school type (rural schools close more easily), regional infrastructure (southern states close more easily than northern states with better snow removal equipment), and timing of the storm relative to school hours."}},{"@type":"Question","name":"Does the Snow Day Calculator work for locations outside the US?","acceptedAnswer":{"@type":"Answer","text":"Yes! While primarily designed for US ZIP codes, our calculator also supports city name searches worldwide. The weather data comes from Open-Meteo which provides global coverage. However, the school closure algorithm is optimized for US and Canadian school districts."}},{"@type":"Question","name":"Is this Snow Day Calculator really free with no ads?","acceptedAnswer":{"@type":"Answer","text":"Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All weather data is fetched directly in your browser from the Open-Meteo API. Your location data is never stored on any server â€” everything runs locally in your browser for complete privacy."}}]}</script>

    <link rel="stylesheet" href="common/common.css">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0c1445 0%, #1a237e 40%, #283593 70%, #1565c0 100%);
            color: #e0e0e0;
            min-height: 100vh;
            overflow-x: hidden;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 40px; position: relative; z-index: 1; }

        /* é›ªèŠ±åŠ¨ç”»èƒŒæ™¯ */
        .snow-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; }

        /* ä¸»æ ‡é¢˜ */
        .hero { text-align: center; margin-bottom: 32px; }
        .hero h1 { font-size: 2.4rem; font-weight: 800; letter-spacing: -0.02em; margin-bottom: 8px; }
        .hero h1 .snow-icon { display: inline-block; animation: snowBounce 2s ease-in-out infinite; }
        @keyframes snowBounce { 0%,100% { transform: translateY(0) rotate(0deg); } 50% { transform: translateY(-8px) rotate(15deg); } }
        .hero .subtitle { color: #90caf9; font-size: 1.05rem; }

        /* è¾“å…¥å¡ç‰‡ */
        .input-card {
            background: rgba(255,255,255,0.08);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 20px;
            padding: 32px;
            max-width: 680px;
            margin: 0 auto 24px;
            animation: fadeUp 0.6s ease-out;
        }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .input-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px; }
        .input-group { display: flex; flex-direction: column; gap: 6px; }
        .input-group label { font-size: 13px; color: #90caf9; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }
        .input-group input, .input-group select {
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 12px;
            padding: 12px 16px;
            color: #fff;
            font-size: 15px;
            transition: border-color 0.3s, box-shadow 0.3s;
            outline: none;
        }
        .input-group input:focus, .input-group select:focus {
            border-color: #64b5f6;
            box-shadow: 0 0 0 3px rgba(100,181,246,0.2);
        }
        .input-group input::placeholder { color: rgba(255,255,255,0.4); }
        .input-group select option { background: #1a237e; color: #fff; }

        .calc-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #42a5f5, #1e88e5);
            border: none;
            border-radius: 14px;
            color: #fff;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .calc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(66,165,245,0.4); }
        .calc-btn:active { transform: translateY(0); }
        .calc-btn.loading { opacity: 0.7; pointer-events: none; }

        /* ç»“æœåŒºåŸŸ */
        .result-section {
            max-width: 680px;
            margin: 0 auto;
            display: none;
            animation: fadeUp 0.6s ease-out;
        }
        .result-section.visible { display: block; }

        /* æ¦‚ç‡ä»ªè¡¨ç›˜ */
        .gauge-card {
            background: rgba(255,255,255,0.08);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 20px;
            padding: 32px;
            text-align: center;
            margin-bottom: 20px;
        }
        .gauge-wrapper { position: relative; width: 220px; height: 130px; margin: 0 auto 16px; overflow: hidden; }
        .gauge-bg, .gauge-fill {
            position: absolute;
            top: 0; left: 0;
            width: 220px; height: 220px;
            border-radius: 50%;
            border: 20px solid rgba(255,255,255,0.1);
            border-bottom-color: transparent;
            border-left-color: transparent;
            transform: rotate(225deg);
        }
        .gauge-fill {
            border-color: transparent;
            border-top-color: #4caf50;
            border-right-color: #4caf50;
            transition: transform 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .gauge-text {
            position: absolute;
            bottom: 4px; left: 50%;
            transform: translateX(-50%);
            font-size: 2.8rem;
            font-weight: 800;
            line-height: 1;
        }
        .gauge-text .pct { font-size: 1.4rem; }
        .gauge-label { font-size: 1.1rem; font-weight: 600; margin-bottom: 4px; }
        .gauge-sublabel { color: #90caf9; font-size: 0.9rem; }
        .location-info { color: #90caf9; font-size: 0.85rem; margin-top: 12px; }

        /* å¤©æ°”è¯¦æƒ…å¡ç‰‡ */
        .weather-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 20px; }
        .weather-stat {
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 14px;
            padding: 16px 12px;
            text-align: center;
            transition: transform 0.3s;
        }
        .weather-stat:hover { transform: translateY(-3px); }
        .weather-stat .stat-icon { font-size: 1.6rem; margin-bottom: 6px; }
        .weather-stat .stat-value { font-size: 1.3rem; font-weight: 700; margin-bottom: 2px; }
        .weather-stat .stat-label { font-size: 0.75rem; color: #90caf9; text-transform: uppercase; letter-spacing: 0.05em; }

        /* 3å¤©é¢„æŠ¥ */
        .forecast-card {
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .forecast-card h3 { font-size: 1rem; margin-bottom: 14px; color: #90caf9; }
        .forecast-day { display: flex; align-items: center; gap: 14px; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.06); }
        .forecast-day:last-child { border-bottom: none; }
        .forecast-day .day-name { width: 80px; font-weight: 600; font-size: 0.9rem; }
        .forecast-day .day-weather { font-size: 1.4rem; width: 36px; text-align: center; }
        .forecast-day .day-bar-wrap { flex: 1; height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; }
        .forecast-day .day-bar { height: 100%; border-radius: 4px; transition: width 1s ease-out; }
        .forecast-day .day-pct { width: 50px; text-align: right; font-weight: 700; font-size: 0.95rem; }

        /* è¯„åˆ†åˆ†è§£ */
        .breakdown-card {
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .breakdown-card h3 { font-size: 1rem; margin-bottom: 14px; color: #90caf9; }
        .breakdown-item { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }
        .breakdown-item .bd-label { width: 120px; font-size: 0.85rem; color: #b0bec5; }
        .breakdown-item .bd-bar-wrap { flex: 1; height: 6px; background: rgba(255,255,255,0.1); border-radius: 3px; overflow: hidden; }
        .breakdown-item .bd-bar { height: 100%; border-radius: 3px; transition: width 0.8s ease-out; }
        .breakdown-item .bd-pts { width: 60px; text-align: right; font-size: 0.85rem; font-weight: 600; }

        /* é”™è¯¯æ¶ˆæ¯ */
        .error-msg {
            background: rgba(244,67,54,0.15);
            border: 1px solid rgba(244,67,54,0.3);
            border-radius: 12px;
            padding: 14px 18px;
            color: #ef9a9a;
            text-align: center;
            margin-top: 12px;
            display: none;
            animation: fadeUp 0.3s ease-out;
        }
        .error-msg.visible { display: block; }

        /* Trust Bar */
        /* ä½¿ç”¨ common.css .trust-bar / .trust-item */

        /* Features */
        .features-section { max-width: 1000px; margin: 40px auto; padding: 0 20px; }
        .features-section h2 { text-align: center; font-size: 24px; margin-bottom: 24px; color: #fff; }
        .features-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        .feature-card {
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px; padding: 24px;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .feature-card:hover { transform: translateY(-4px); box-shadow: 0 8px 25px rgba(66,165,245,0.2); }
        .feature-card .icon { font-size: 32px; margin-bottom: 12px; }
        .feature-card h3 { color: #90caf9; margin-bottom: 8px; font-size: 16px; }
        .feature-card p { color: #9ca3af; font-size: 14px; line-height: 1.5; }

        /* FAQ */
        .faq-section { max-width: 800px; margin: 40px auto; padding: 0 20px; }
        .faq-section h2 { text-align: center; font-size: 24px; margin-bottom: 24px; color: #fff; }
        .faq-item {
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px; margin-bottom: 12px; overflow: hidden;
        }
        .faq-question {
            width: 100%; background: none; border: none;
            padding: 16px 20px; cursor: pointer;
            display: flex; justify-content: space-between; align-items: center;
            font-weight: 500; color: #e0e0e0; font-size: inherit;
        }
        .faq-question:hover { background: rgba(66,165,245,0.1); }
        .faq-question .arrow { transition: transform 0.3s; font-size: 14px; color: #42a5f5; }
        .faq-item.active .faq-question .arrow { transform: rotate(180deg); }
        .faq-answer { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; }
        .faq-item.active .faq-answer { max-height: 300px; }
        .faq-answer p { padding: 0 20px 16px; color: #9ca3af; font-size: 14px; line-height: 1.6; }

        /* æµ…è‰²ä¸»é¢˜ */
        body[data-theme="light"] { background: #f0f4f8 !important; color: #09090b; }
        [data-theme="light"] .hero h1 { color: #1a237e; }
        [data-theme="light"] .hero .subtitle { color: #5c6bc0; }
        [data-theme="light"] .input-card { background: #fff; border-color: #e0e0e0; }
        [data-theme="light"] .input-group label { color: #3949ab; }
        [data-theme="light"] .input-group input, [data-theme="light"] .input-group select { background: #f5f5f5; border-color: #ddd; color: #333; }
        [data-theme="light"] .gauge-card { background: #fff; border-color: #e0e0e0; }
        [data-theme="light"] .gauge-text { color: #1a237e; }
        [data-theme="light"] .gauge-label { color: #333; }
        [data-theme="light"] .gauge-sublabel, [data-theme="light"] .location-info { color: #5c6bc0; }
        [data-theme="light"] .weather-stat { background: #fff; border-color: #e0e0e0; }
        [data-theme="light"] .weather-stat .stat-value { color: #1a237e; }
        [data-theme="light"] .weather-stat .stat-label { color: #5c6bc0; }
        [data-theme="light"] .forecast-card, [data-theme="light"] .breakdown-card { background: #fff; border-color: #e0e0e0; }
        [data-theme="light"] .forecast-card h3, [data-theme="light"] .breakdown-card h3 { color: #3949ab; }
        [data-theme="light"] .forecast-day { border-bottom-color: #eee; }
        [data-theme="light"] .forecast-day .day-name { color: #333; }
        [data-theme="light"] .breakdown-item .bd-label { color: #666; }
        [data-theme="light"] .features-section h2 { color: #09090b; }
        [data-theme="light"] .feature-card { background: #ffffff; border-color: #e4e4e7; box-shadow: 0 1px 3px rgba(0,0,0,0.04); }
        [data-theme="light"] .feature-card:hover { border-color: #d4d4d8; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        [data-theme="light"] .feature-card h3 { color: #1a237e; }
        [data-theme="light"] .feature-card p { color: #71717a; }
        [data-theme="light"] .faq-section h2 { color: #09090b; }
        [data-theme="light"] .faq-item { background: #ffffff; border-color: #e4e4e7; }
        [data-theme="light"] .faq-question { color: #09090b; }
        [data-theme="light"] .faq-answer p { color: #71717a; }
        [data-theme="light"] .container { color: #09090b; }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .container { padding: 20px; }
            .hero h1 { font-size: 1.8rem; }
            .input-card { padding: 20px; }
            .input-row { grid-template-columns: 1fr; }
            .weather-grid { grid-template-columns: repeat(2, 1fr); }
            .features-grid { grid-template-columns: 1fr; }
            .gauge-wrapper { width: 180px; height: 106px; }
            .gauge-bg, .gauge-fill { width: 180px; height: 180px; border-width: 16px; }
            .gauge-text { font-size: 2.2rem; }
        }
        @media (max-width: 480px) {
            .weather-grid { grid-template-columns: 1fr 1fr; gap: 8px; }
            .weather-stat { padding: 12px 8px; }
        }
    </style>
</head>
<body>
<canvas class="snow-canvas" id="snowCanvas"></canvas>
<div class="container">

    <!-- ä¸»æ ‡é¢˜ -->
    <div class="hero">
        <h1><span class="snow-icon">â„ï¸</span> <span data-i18n="title">Snow Day Calculator</span></h1>
        <p class="subtitle" data-i18n="subtitle">Will school be closed tomorrow? Check your snow day probability!</p>
    </div>

    <!-- è¾“å…¥å¡ç‰‡ -->
    <div class="input-card">
        <div class="input-row">
            <div class="input-group">
                <label data-i18n="label_zip">ZIP Code or City</label>
                <input type="text" id="zipInput" data-i18n-placeholder="placeholder_zip" placeholder="e.g. 10001 or New York">
            </div>
            <div class="input-group">
                <label data-i18n="label_school">School Type</label>
                <select id="schoolType">
                    <option value="public" data-i18n="school_public">Public School</option>
                    <option value="urban" data-i18n="school_urban">Urban Public</option>
                    <option value="rural" data-i18n="school_rural">Rural Public</option>
                    <option value="private" data-i18n="school_private">Private / Prep</option>
                    <option value="boarding" data-i18n="school_boarding">Boarding School</option>
                </select>
            </div>
        </div>
        <div class="input-row">
            <div class="input-group">
                <label data-i18n="label_snowdays">Snow Days Used This Year</label>
                <input type="number" id="snowDaysUsed" value="0" min="0" max="20" data-i18n-placeholder="placeholder_snowdays" placeholder="0">
            </div>
            <div class="input-group" style="justify-content:flex-end;">
                <button class="calc-btn" id="calcBtn">
                    <span data-i18n="btn_calculate">â„ï¸ Calculate Snow Day Probability</span>
                </button>
            </div>
        </div>
        <div class="error-msg" id="errorMsg"></div>
    </div>

    <!-- ç»“æœåŒºåŸŸ -->
    <div class="result-section" id="resultSection">
        <!-- æ¦‚ç‡ä»ªè¡¨ç›˜ -->
        <div class="gauge-card">
            <div class="gauge-wrapper">
                <div class="gauge-bg"></div>
                <div class="gauge-fill" id="gaugeFill"></div>
                <div class="gauge-text"><span id="gaugeValue">0</span><span class="pct">%</span></div>
            </div>
            <div class="gauge-label" id="gaugeLabel" data-i18n="result_checking">Checking...</div>
            <div class="gauge-sublabel" id="gaugeSublabel"></div>
            <div class="location-info" id="locationInfo"></div>
        </div>

        <!-- å¤©æ°”è¯¦æƒ… -->
        <div class="weather-grid" id="weatherGrid">
            <div class="weather-stat"><div class="stat-icon">ğŸŒ¨ï¸</div><div class="stat-value" id="statSnow">--</div><div class="stat-label" data-i18n="stat_snowfall">Snowfall</div></div>
            <div class="weather-stat"><div class="stat-icon">ğŸŒ¡ï¸</div><div class="stat-value" id="statTemp">--</div><div class="stat-label" data-i18n="stat_temp">Temperature</div></div>
            <div class="weather-stat"><div class="stat-icon">ğŸ’¨</div><div class="stat-value" id="statWind">--</div><div class="stat-label" data-i18n="stat_wind">Wind Speed</div></div>
            <div class="weather-stat"><div class="stat-icon">ğŸŒ§ï¸</div><div class="stat-value" id="statPrecip">--</div><div class="stat-label" data-i18n="stat_precip">Precipitation</div></div>
        </div>

        <!-- 3å¤©é¢„æŠ¥ -->
        <div class="forecast-card">
            <h3 data-i18n="forecast_title">ğŸ“… 3-Day Snow Day Forecast</h3>
            <div id="forecastDays"></div>
        </div>

        <!-- è¯„åˆ†åˆ†è§£ -->
        <div class="breakdown-card">
            <h3 data-i18n="breakdown_title">ğŸ“Š Score Breakdown</h3>
            <div id="breakdownItems"></div>
        </div>
    </div>

    <!-- Trust Bar -->
    <div class="trust-bar">
        <span class="trust-item" data-i18n="trust_users">ğŸŒ Used by 50,000+ users</span>
        <span class="trust-item" data-i18n="trust_rating">â­ 4.9/5 rating</span>
        <span class="trust-item" data-i18n="trust_privacy">ğŸ”’ 100% Private</span>
        <span class="trust-item" data-i18n="trust_free">ğŸš« No Ads, No Signup</span>
    </div>

    <!-- Features -->
    <section class="features-section">
        <h2 data-i18n="features_title">Key Features</h2>
        <div class="features-grid">
            <div class="feature-card">
                <div class="icon">ğŸ”’</div>
                <h3 data-i18n="feature1_title">100% Free & Private</h3>
                <p data-i18n="feature1_desc">No ads, no signup, no watermark. Weather data is fetched directly in your browser â€” your location is never stored on any server.</p>
            </div>
            <div class="feature-card">
                <div class="icon">ğŸŒ¨ï¸</div>
                <h3 data-i18n="feature2_title">Real-Time Weather Data</h3>
                <p data-i18n="feature2_desc">Powered by Open-Meteo weather service with hourly forecast updates. Analyzes snowfall, temperature, wind speed, and precipitation for accurate predictions.</p>
            </div>
            <div class="feature-card">
                <div class="icon">ğŸ«</div>
                <h3 data-i18n="feature3_title">School Type Adjustment</h3>
                <p data-i18n="feature3_desc">Factors in your school type â€” rural schools close more easily, boarding schools less so. Regional infrastructure readiness is also considered.</p>
            </div>
            <div class="feature-card">
                <div class="icon">ğŸ“…</div>
                <h3 data-i18n="feature4_title">3-Day Forecast View</h3>
                <p data-i18n="feature4_desc">Get snow day probabilities for the next 3 days with detailed weather breakdown, score analysis, and probability trends.</p>
            </div>
        </div>
    </section>

    <!-- FAQ -->
    <section class="faq-section">
        <h2 data-i18n="faq_title">Frequently Asked Questions</h2>
        <div class="faq-item">
            <button class="faq-question">
                <span data-i18n="faq1_q">What is a Snow Day Calculator and how does it work?</span>
                <span class="arrow">â–¼</span>
            </button>
            <div class="faq-answer"><p data-i18n="faq1_a">A Snow Day Calculator is a free online tool that predicts the probability of school closures due to winter weather. It analyzes real-time weather forecast data including snowfall accumulation, temperature, wind speed, and ice conditions for your specific location, then calculates a percentage chance that schools will close. Our calculator uses data from Open-Meteo weather service, considering factors like regional infrastructure readiness and school type to provide accurate predictions.</p></div>
        </div>
        <div class="faq-item">
            <button class="faq-question">
                <span data-i18n="faq2_q">How accurate is the Snow Day Calculator prediction?</span>
                <span class="arrow">â–¼</span>
            </button>
            <div class="faq-answer"><p data-i18n="faq2_a">Snow day predictions within 24-48 hours typically achieve 75-85% accuracy by combining multiple weather factors. The calculator considers snowfall amount, temperature, wind speed, and regional patterns. However, final closure decisions are always made by your local school district based on real-time road conditions and safety assessments, so treat the probability as an informed estimate.</p></div>
        </div>
        <div class="faq-item">
            <button class="faq-question">
                <span data-i18n="faq3_q">What factors affect snow day probability?</span>
                <span class="arrow">â–¼</span>
            </button>
            <div class="faq-answer"><p data-i18n="faq3_a">Key factors include: snowfall accumulation (heaviest weight in the algorithm), temperature and wind chill, wind speed, ice and freezing rain conditions, school type (rural schools close more easily than urban ones), regional infrastructure (southern US states close more easily than northern states with better snow removal equipment), and the timing of the storm relative to morning school hours.</p></div>
        </div>
        <div class="faq-item">
            <button class="faq-question">
                <span data-i18n="faq4_q">Does the Snow Day Calculator work for locations outside the US?</span>
                <span class="arrow">â–¼</span>
            </button>
            <div class="faq-answer"><p data-i18n="faq4_a">Yes! While primarily designed for US ZIP codes, our calculator also supports city name searches worldwide. The weather data comes from Open-Meteo which provides global coverage. However, the school closure algorithm is optimized for US and Canadian school districts. For international locations, the prediction provides a general indication of severe winter weather likelihood.</p></div>
        </div>
        <div class="faq-item">
            <button class="faq-question">
                <span data-i18n="faq5_q">When is the best time to check the Snow Day Calculator?</span>
                <span class="arrow">â–¼</span>
            </button>
            <div class="faq-answer"><p data-i18n="faq5_a">The most reliable window is the evening before a potential snow day (6-10 PM), when weather models have the most accurate short-range forecast data. You can also check in the early morning (5-7 AM) for the latest updates. Predictions become more accurate as the event approaches â€” checking 24-48 hours ahead gives you a good early estimate, while same-day checks offer the highest accuracy.</p></div>
        </div>
        <div class="faq-item">
            <button class="faq-question">
                <span data-i18n="faq_free_q">Is this tool really free with no ads?</span>
                <span class="arrow">â–¼</span>
            </button>
            <div class="faq-answer"><p data-i18n="faq_free_a">Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All weather data is fetched directly in your browser using the free Open-Meteo API. Your location data is never stored on any server â€” everything runs locally in your browser for complete privacy.</p></div>
        </div>
    </section>

    <!-- Related Tools -->
    <section class="related-tools">
        <h3 data-i18n="related_title">Related Tools</h3>
        <div class="related-grid">
            <a href="unit-converter.html" class="related-card">
                <div>ğŸ“</div>
                <h4 data-i18n="related1_name">Unit Converter</h4>
                <p data-i18n="related1_desc">Convert temperature, length, weight and more units instantly.</p>
            </a>
            <a href="calculator.html" class="related-card">
                <div>ğŸ§®</div>
                <h4 data-i18n="related2_name">Calculator</h4>
                <p data-i18n="related2_desc">Scientific calculator with advanced math functions.</p>
            </a>
            <a href="timestamp-converter.html" class="related-card">
                <div>ğŸ•’</div>
                <h4 data-i18n="related3_name">Timestamp Converter</h4>
                <p data-i18n="related3_desc">Convert timestamps and time zones for scheduling.</p>
            </a>
            <a href="color-palette.html" class="related-card">
                <div>ğŸ¨</div>
                <h4 data-i18n="related4_name">Color Palette</h4>
                <p data-i18n="related4_desc">HEX, RGB, HSL color converter and palette generator.</p>
            </a>
        </div>
    </section>
</div>

<script>
(function() {
    'use strict';

    // ========== ç¿»è¯‘ ==========
    var translations = {
        en: {
            tool_name: 'Snow Day Calculator',
            title: 'Snow Day Calculator',
            subtitle: 'Will school be closed tomorrow? Check your snow day probability!',
            label_zip: 'ZIP Code or City',
            placeholder_zip: 'e.g. 10001 or New York',
            label_school: 'School Type',
            school_public: 'Public School',
            school_urban: 'Urban Public',
            school_rural: 'Rural Public',
            school_private: 'Private / Prep',
            school_boarding: 'Boarding School',
            label_snowdays: 'Snow Days Used This Year',
            placeholder_snowdays: '0',
            btn_calculate: 'â„ï¸ Calculate Snow Day Probability',
            result_checking: 'Analyzing weather data...',
            result_unlikely: 'Snow Day Unlikely',
            result_possible: 'Snow Day Possible',
            result_likely: 'Snow Day Likely',
            result_very_likely: 'Snow Day Very Likely!',
            result_almost_certain: 'Almost Certain Snow Day! â„ï¸',
            stat_snowfall: 'Snowfall',
            stat_temp: 'Temperature',
            stat_wind: 'Wind Speed',
            stat_precip: 'Precipitation',
            forecast_title: 'ğŸ“… 3-Day Snow Day Forecast',
            breakdown_title: 'ğŸ“Š Score Breakdown',
            bd_snow: 'Snowfall',
            bd_temp: 'Temperature',
            bd_wind: 'Wind Speed',
            bd_ice: 'Ice / Freezing',
            bd_school: 'School Type',
            bd_region: 'Regional Factor',
            error_empty: 'Please enter a ZIP code or city name.',
            error_not_found: 'Location not found. Please try a different ZIP code or city name.',
            error_weather: 'Failed to fetch weather data. Please try again.',
            disclaimer: 'Disclaimer: This is an estimate based on weather forecasts. Final closure decisions are made by your school district.',
            trust_users: 'ğŸŒ Used by 50,000+ users',
            trust_rating: 'â­ 4.9/5 rating',
            trust_privacy: 'ğŸ”’ 100% Private',
            trust_free: 'ğŸš« No Ads, No Signup',
            features_title: 'Key Features',
            feature1_title: '100% Free & Private',
            feature1_desc: 'No ads, no signup, no watermark. Weather data is fetched directly in your browser â€” your location is never stored on any server.',
            feature2_title: 'Real-Time Weather Data',
            feature2_desc: 'Powered by Open-Meteo weather service with hourly forecast updates. Analyzes snowfall, temperature, wind speed, and precipitation.',
            feature3_title: 'School Type Adjustment',
            feature3_desc: 'Factors in your school type â€” rural schools close more easily, boarding schools less so. Regional infrastructure readiness is also considered.',
            feature4_title: '3-Day Forecast View',
            feature4_desc: 'Get snow day probabilities for the next 3 days with detailed weather breakdown, score analysis, and probability trends.',
            faq_title: 'Frequently Asked Questions',
            faq1_q: 'What is a Snow Day Calculator and how does it work?',
            faq1_a: 'A Snow Day Calculator is a free online tool that predicts the probability of school closures due to winter weather. It analyzes real-time weather forecast data including snowfall accumulation, temperature, wind speed, and ice conditions for your specific location, then calculates a percentage chance that schools will close. Our calculator uses data from Open-Meteo weather service, considering factors like regional infrastructure readiness and school type to provide accurate predictions.',
            faq2_q: 'How accurate is the Snow Day Calculator prediction?',
            faq2_a: 'Snow day predictions within 24-48 hours typically achieve 75-85% accuracy by combining multiple weather factors. The calculator considers snowfall amount, temperature, wind speed, and regional patterns. However, final closure decisions are always made by your local school district based on real-time road conditions and safety assessments, so treat the probability as an informed estimate.',
            faq3_q: 'What factors affect snow day probability?',
            faq3_a: 'Key factors include: snowfall accumulation (heaviest weight in the algorithm), temperature and wind chill, wind speed, ice and freezing rain conditions, school type (rural schools close more easily than urban ones), regional infrastructure (southern US states close more easily than northern states with better snow removal equipment), and the timing of the storm relative to morning school hours.',
            faq4_q: 'Does the Snow Day Calculator work for locations outside the US?',
            faq4_a: 'Yes! While primarily designed for US ZIP codes, our calculator also supports city name searches worldwide. The weather data comes from Open-Meteo which provides global coverage. However, the school closure algorithm is optimized for US and Canadian school districts. For international locations, the prediction provides a general indication of severe winter weather likelihood.',
            faq5_q: 'When is the best time to check the Snow Day Calculator?',
            faq5_a: 'The most reliable window is the evening before a potential snow day (6-10 PM), when weather models have the most accurate short-range forecast data. You can also check in the early morning (5-7 AM) for the latest updates. Predictions become more accurate as the event approaches â€” checking 24-48 hours ahead gives you a good early estimate, while same-day checks offer the highest accuracy.',
            faq_free_q: 'Is this tool really free with no ads?',
            faq_free_a: 'Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All weather data is fetched directly in your browser using the free Open-Meteo API. Your location data is never stored on any server â€” everything runs locally in your browser for complete privacy.',
            related_title: 'Related Tools',
            related1_name: 'Unit Converter', related1_desc: 'Convert temperature, length, weight and more units instantly.',
            related2_name: 'Calculator', related2_desc: 'Scientific calculator with advanced math functions.',
            related3_name: 'Timestamp Converter', related3_desc: 'Convert timestamps and time zones for scheduling.',
            related4_name: 'Color Palette', related4_desc: 'HEX, RGB, HSL color converter and palette generator.'
        },
        'zh-CN': {
            tool_name: 'é›ªæ—¥åœè¯¾è®¡ç®—å™¨',
            title: 'é›ªæ—¥åœè¯¾è®¡ç®—å™¨',
            subtitle: 'æ˜å¤©ä¼šåœè¯¾å—ï¼ŸæŸ¥çœ‹ä½ çš„é›ªæ—¥åœè¯¾æ¦‚ç‡ï¼',
            label_zip: 'é‚®ç¼–æˆ–åŸå¸‚',
            placeholder_zip: 'ä¾‹å¦‚ 10001 æˆ– New York',
            label_school: 'å­¦æ ¡ç±»å‹',
            school_public: 'å…¬ç«‹å­¦æ ¡',
            school_urban: 'åŸå¸‚å…¬ç«‹',
            school_rural: 'å†œæ‘å…¬ç«‹',
            school_private: 'ç§ç«‹/é¢„ç§‘',
            school_boarding: 'å¯„å®¿å­¦æ ¡',
            label_snowdays: 'ä»Šå¹´å·²ç”¨é›ªæ—¥æ•°',
            placeholder_snowdays: '0',
            btn_calculate: 'â„ï¸ è®¡ç®—åœè¯¾æ¦‚ç‡',
            result_checking: 'æ­£åœ¨åˆ†æå¤©æ°”æ•°æ®...',
            result_unlikely: 'åœè¯¾å¯èƒ½æ€§ä½',
            result_possible: 'æœ‰ä¸€å®šåœè¯¾å¯èƒ½',
            result_likely: 'è¾ƒå¤§å¯èƒ½åœè¯¾',
            result_very_likely: 'åœè¯¾å¯èƒ½æ€§å¾ˆå¤§ï¼',
            result_almost_certain: 'å‡ ä¹ç¡®å®šåœè¯¾ï¼â„ï¸',
            stat_snowfall: 'é™é›ªé‡',
            stat_temp: 'æ¸©åº¦',
            stat_wind: 'é£é€Ÿ',
            stat_precip: 'é™æ°´é‡',
            forecast_title: 'ğŸ“… 3å¤©åœè¯¾é¢„æŠ¥',
            breakdown_title: 'ğŸ“Š è¯„åˆ†è¯¦æƒ…',
            bd_snow: 'é™é›ªé‡',
            bd_temp: 'æ¸©åº¦',
            bd_wind: 'é£é€Ÿ',
            bd_ice: 'ç»“å†°/å†»é›¨',
            bd_school: 'å­¦æ ¡ç±»å‹',
            bd_region: 'åœ°åŒºå› ç´ ',
            error_empty: 'è¯·è¾“å…¥é‚®ç¼–æˆ–åŸå¸‚åç§°ã€‚',
            error_not_found: 'æ‰¾ä¸åˆ°è¯¥åœ°ç‚¹ï¼Œè¯·å°è¯•å…¶ä»–é‚®ç¼–æˆ–åŸå¸‚åã€‚',
            error_weather: 'è·å–å¤©æ°”æ•°æ®å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚',
            disclaimer: 'å…è´£å£°æ˜ï¼šæœ¬ç»“æœåŸºäºå¤©æ°”é¢„æŠ¥ä¼°ç®—ï¼Œæœ€ç»ˆåœè¯¾å†³å®šç”±å­¦åŒºåšå‡ºã€‚',
            trust_users: 'ğŸŒ è¶…è¿‡50,000åç”¨æˆ·ä½¿ç”¨',
            trust_rating: 'â­ 4.9/5 è¯„åˆ†',
            trust_privacy: 'ğŸ”’ 100%éšç§ä¿æŠ¤',
            trust_free: 'ğŸš« æ— å¹¿å‘Šã€æ— éœ€æ³¨å†Œ',
            features_title: 'æ ¸å¿ƒåŠŸèƒ½',
            feature1_title: '100%å…è´¹ä¸”ç§å¯†',
            feature1_desc: 'æ— å¹¿å‘Šã€æ— éœ€æ³¨å†Œã€æ— æ°´å°ã€‚å¤©æ°”æ•°æ®ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è·å–ï¼Œæ‚¨çš„ä½ç½®ä¿¡æ¯ä¸ä¼šå­˜å‚¨åœ¨ä»»ä½•æœåŠ¡å™¨ä¸Šã€‚',
            feature2_title: 'å®æ—¶å¤©æ°”æ•°æ®',
            feature2_desc: 'åŸºäºOpen-Meteoæ°”è±¡æœåŠ¡ï¼Œæä¾›æ¯å°æ—¶æ›´æ–°çš„é¢„æŠ¥ã€‚åˆ†æé™é›ªé‡ã€æ¸©åº¦ã€é£é€Ÿå’Œé™æ°´é‡ï¼Œæä¾›ç²¾å‡†é¢„æµ‹ã€‚',
            feature3_title: 'å­¦æ ¡ç±»å‹è°ƒæ•´',
            feature3_desc: 'è€ƒè™‘å­¦æ ¡ç±»å‹å› ç´ â€”â€”å†œæ‘å­¦æ ¡æ›´å®¹æ˜“åœè¯¾ï¼Œå¯„å®¿å­¦æ ¡åˆ™è¾ƒå°‘ã€‚è¿˜è€ƒè™‘åœ°åŒºé™¤é›ªè®¾æ–½é…å¤‡æƒ…å†µã€‚',
            feature4_title: '3å¤©é¢„æŠ¥è§†å›¾',
            feature4_desc: 'è·å–æœªæ¥3å¤©çš„åœè¯¾æ¦‚ç‡ï¼Œé™„å¸¦è¯¦ç»†å¤©æ°”æ•°æ®ã€è¯„åˆ†åˆ†æå’Œæ¦‚ç‡è¶‹åŠ¿ã€‚',
            faq_title: 'å¸¸è§é—®é¢˜',
            faq1_q: 'ä»€ä¹ˆæ˜¯é›ªæ—¥è®¡ç®—å™¨ï¼Ÿå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ',
            faq1_a: 'é›ªæ—¥è®¡ç®—å™¨æ˜¯ä¸€ä¸ªå…è´¹åœ¨çº¿å·¥å…·ï¼Œç”¨äºé¢„æµ‹å› å†¬å­£å¤©æ°”å¯¼è‡´å­¦æ ¡åœè¯¾çš„æ¦‚ç‡ã€‚å®ƒåˆ†æå®æ—¶å¤©æ°”é¢„æŠ¥æ•°æ®ï¼ŒåŒ…æ‹¬é™é›ªç§¯ç´¯ã€æ¸©åº¦ã€é£é€Ÿå’Œç»“å†°çŠ¶å†µï¼Œç„¶åè®¡ç®—å‡ºå­¦æ ¡åœè¯¾çš„ç™¾åˆ†æ¯”æ¦‚ç‡ã€‚æˆ‘ä»¬çš„è®¡ç®—å™¨ä½¿ç”¨Open-Meteoæ°”è±¡æœåŠ¡çš„æ•°æ®ï¼ŒåŒæ—¶è€ƒè™‘åœ°åŒºåŸºç¡€è®¾æ–½å‡†å¤‡æƒ…å†µå’Œå­¦æ ¡ç±»å‹ç­‰å› ç´ ã€‚',
            faq2_q: 'é›ªæ—¥è®¡ç®—å™¨çš„é¢„æµ‹å‡†ç¡®å—ï¼Ÿ',
            faq2_a: '24-48å°æ—¶å†…çš„é›ªæ—¥é¢„æµ‹é€šå¸¸è¾¾åˆ°75-85%çš„å‡†ç¡®ç‡ã€‚è®¡ç®—å™¨ç»¼åˆè€ƒè™‘é™é›ªé‡ã€æ¸©åº¦ã€é£é€Ÿå’Œåœ°åŒºæ¨¡å¼ã€‚ä½†æœ€ç»ˆåœè¯¾å†³å®šå§‹ç»ˆç”±å½“åœ°å­¦åŒºæ ¹æ®å®æ—¶è·¯å†µå’Œå®‰å…¨è¯„ä¼°åšå‡ºï¼Œå› æ­¤è¯·å°†æ¦‚ç‡è§†ä¸ºå‚è€ƒä¼°è®¡ã€‚',
            faq3_q: 'å“ªäº›å› ç´ å½±å“åœè¯¾æ¦‚ç‡ï¼Ÿ',
            faq3_a: 'å…³é”®å› ç´ åŒ…æ‹¬ï¼šé™é›ªç§¯ç´¯é‡ï¼ˆç®—æ³•ä¸­æƒé‡æœ€å¤§ï¼‰ã€æ¸©åº¦å’Œé£å¯’æŒ‡æ•°ã€é£é€Ÿã€ç»“å†°å’Œå†»é›¨æ¡ä»¶ã€å­¦æ ¡ç±»å‹ï¼ˆå†œæ‘å­¦æ ¡æ¯”åŸå¸‚å­¦æ ¡æ›´å®¹æ˜“åœè¯¾ï¼‰ã€åœ°åŒºåŸºç¡€è®¾æ–½ï¼ˆç¾å›½å—éƒ¨å„å·æ¯”é…å¤‡æ›´å¥½é™¤é›ªè®¾å¤‡çš„åŒ—éƒ¨å„å·æ›´å®¹æ˜“åœè¯¾ï¼‰ï¼Œä»¥åŠæš´é£é›ªç›¸å¯¹äºä¸Šå­¦æ—¶é—´çš„æ—¶æœºã€‚',
            faq4_q: 'è¿™ä¸ªè®¡ç®—å™¨å¯¹ç¾å›½ä»¥å¤–çš„åœ°åŒºæœ‰æ•ˆå—ï¼Ÿ',
            faq4_a: 'æ˜¯çš„ï¼è™½ç„¶ä¸»è¦é’ˆå¯¹ç¾å›½é‚®ç¼–è®¾è®¡ï¼Œä½†ä¹Ÿæ”¯æŒå…¨çƒåŸå¸‚åæœç´¢ã€‚å¤©æ°”æ•°æ®æ¥è‡ªOpen-Meteoï¼Œæä¾›å…¨çƒè¦†ç›–ã€‚ä¸è¿‡ï¼Œåœè¯¾ç®—æ³•æ˜¯é’ˆå¯¹ç¾å›½å’ŒåŠ æ‹¿å¤§å­¦åŒºä¼˜åŒ–çš„ã€‚å¯¹äºå›½é™…åœ°ç‚¹ï¼Œé¢„æµ‹æä¾›ä¸¥é‡å†¬å­£å¤©æ°”å¯èƒ½æ€§çš„ä¸€èˆ¬å‚è€ƒã€‚',
            faq5_q: 'ä»€ä¹ˆæ—¶å€™æŸ¥çœ‹è®¡ç®—å™¨æœ€å¥½ï¼Ÿ',
            faq5_a: 'æœ€å¯é çš„æ—¶é—´çª—å£æ˜¯æ½œåœ¨é›ªæ—¥çš„å‰ä¸€å¤©å‚æ™šï¼ˆ6-10 PMï¼‰ï¼Œæ­¤æ—¶å¤©æ°”æ¨¡å‹æœ‰æœ€å‡†ç¡®çš„çŸ­æœŸé¢„æŠ¥æ•°æ®ã€‚ä¹Ÿå¯ä»¥åœ¨æ¸…æ™¨ï¼ˆ5-7 AMï¼‰æŸ¥çœ‹æœ€æ–°æ›´æ–°ã€‚éšç€äº‹ä»¶ä¸´è¿‘ï¼Œé¢„æµ‹ä¼šæ›´å‡†ç¡®ã€‚',
            faq_free_q: 'è¿™ä¸ªå·¥å…·çœŸçš„å…è´¹æ— å¹¿å‘Šå—ï¼Ÿ',
            faq_free_a: 'æ˜¯çš„ï¼Œ100%å…è´¹ï¼Œæ— å¹¿å‘Šã€æ— éœ€æ³¨å†Œã€æ— æ°´å°ã€æ— ä½¿ç”¨é™åˆ¶ã€‚æ‰€æœ‰å¤©æ°”æ•°æ®é€šè¿‡å…è´¹çš„Open-Meteo APIç›´æ¥åœ¨æµè§ˆå™¨ä¸­è·å–ã€‚æ‚¨çš„ä½ç½®æ•°æ®ä¸ä¼šå­˜å‚¨åœ¨ä»»ä½•æœåŠ¡å™¨ä¸Šï¼Œä¸€åˆ‡éƒ½åœ¨æœ¬åœ°æµè§ˆå™¨ä¸­è¿è¡Œã€‚',
            related_title: 'ç›¸å…³å·¥å…·',
            related1_name: 'å•ä½æ¢ç®—å™¨', related1_desc: 'å³æ—¶è½¬æ¢æ¸©åº¦ã€é•¿åº¦ã€é‡é‡ç­‰å•ä½ã€‚',
            related2_name: 'è®¡ç®—å™¨', related2_desc: 'æ”¯æŒé«˜çº§æ•°å­¦å‡½æ•°çš„ç§‘å­¦è®¡ç®—å™¨ã€‚',
            related3_name: 'æ—¶é—´æˆ³è½¬æ¢å™¨', related3_desc: 'æ—¶é—´æˆ³å’Œæ—¶åŒºè½¬æ¢å·¥å…·ã€‚',
            related4_name: 'è°ƒè‰²æ¿', related4_desc: 'HEXã€RGBã€HSLé¢œè‰²è½¬æ¢å’Œè°ƒè‰²æ¿ç”Ÿæˆã€‚'
        },
        fr: {
            tool_name: 'Calculateur Jour de Neige',
            title: 'Calculateur Jour de Neige',
            subtitle: "L'Ã©cole sera-t-elle fermÃ©e demain ? VÃ©rifiez la probabilitÃ© !",
            label_zip: 'Code postal ou ville',
            placeholder_zip: 'ex. 10001 ou New York',
            label_school: "Type d'Ã©cole",
            school_public: 'Ã‰cole publique',
            school_urban: 'Publique urbaine',
            school_rural: 'Publique rurale',
            school_private: 'PrivÃ©e / PrÃ©paratoire',
            school_boarding: 'Internat',
            label_snowdays: 'Jours de neige utilisÃ©s cette annÃ©e',
            placeholder_snowdays: '0',
            btn_calculate: 'â„ï¸ Calculer la probabilitÃ©',
            result_checking: 'Analyse des donnÃ©es mÃ©tÃ©o...',
            result_unlikely: 'Jour de neige peu probable',
            result_possible: 'Jour de neige possible',
            result_likely: 'Jour de neige probable',
            result_very_likely: 'Jour de neige trÃ¨s probable !',
            result_almost_certain: 'Jour de neige quasi certain ! â„ï¸',
            stat_snowfall: 'Chute de neige',
            stat_temp: 'TempÃ©rature',
            stat_wind: 'Vitesse du vent',
            stat_precip: 'PrÃ©cipitations',
            forecast_title: 'ğŸ“… PrÃ©visions sur 3 jours',
            breakdown_title: 'ğŸ“Š DÃ©tail des scores',
            bd_snow: 'Chute de neige',
            bd_temp: 'TempÃ©rature',
            bd_wind: 'Vitesse du vent',
            bd_ice: 'Verglas',
            bd_school: "Type d'Ã©cole",
            bd_region: 'Facteur rÃ©gional',
            error_empty: 'Veuillez entrer un code postal ou un nom de ville.',
            error_not_found: 'Lieu non trouvÃ©. Essayez un autre code postal ou ville.',
            error_weather: 'Ã‰chec de rÃ©cupÃ©ration des donnÃ©es mÃ©tÃ©o. RÃ©essayez.',
            trust_users: 'ğŸŒ Plus de 50 000 utilisateurs',
            trust_rating: 'â­ Note 4.9/5',
            trust_privacy: 'ğŸ”’ 100% PrivÃ©',
            trust_free: 'ğŸš« Sans pub, sans inscription',
            features_title: 'FonctionnalitÃ©s clÃ©s',
            feature1_title: '100% Gratuit et PrivÃ©',
            feature1_desc: "Sans pub, sans inscription, sans filigrane. Les donnÃ©es mÃ©tÃ©o sont rÃ©cupÃ©rÃ©es directement dans votre navigateur.",
            feature2_title: 'DonnÃ©es mÃ©tÃ©o en temps rÃ©el',
            feature2_desc: "AlimentÃ© par Open-Meteo avec mises Ã  jour horaires. Analyse chute de neige, tempÃ©rature, vent et prÃ©cipitations.",
            feature3_title: "Ajustement type d'Ã©cole",
            feature3_desc: "Tient compte du type d'Ã©cole â€” les Ã©coles rurales ferment plus facilement, les internats moins.",
            feature4_title: 'PrÃ©visions sur 3 jours',
            feature4_desc: "Obtenez les probabilitÃ©s de jour de neige pour les 3 prochains jours avec analyse dÃ©taillÃ©e.",
            faq_title: 'Questions frÃ©quentes',
            faq1_q: "Qu'est-ce qu'un calculateur de jour de neige ?",
            faq1_a: "Un calculateur de jour de neige est un outil en ligne gratuit qui prÃ©dit la probabilitÃ© de fermeture d'Ã©cole en raison du temps hivernal. Il analyse les prÃ©visions mÃ©tÃ©o en temps rÃ©el incluant accumulation de neige, tempÃ©rature, vitesse du vent et conditions de verglas.",
            faq2_q: 'Quelle est la prÃ©cision des prÃ©dictions ?',
            faq2_a: "Les prÃ©dictions Ã  24-48 heures atteignent typiquement 75-85% de prÃ©cision. Cependant, les dÃ©cisions finales sont toujours prises par votre district scolaire.",
            faq3_q: 'Quels facteurs influencent la probabilitÃ© ?',
            faq3_a: "Les facteurs clÃ©s incluent : accumulation de neige, tempÃ©rature et refroidissement Ã©olien, vitesse du vent, conditions de verglas, type d'Ã©cole et infrastructure rÃ©gionale.",
            faq4_q: "Fonctionne-t-il hors des Ã‰tats-Unis ?",
            faq4_a: "Oui ! Le calculateur supporte la recherche par nom de ville dans le monde entier via Open-Meteo. L'algorithme est optimisÃ© pour les districts scolaires amÃ©ricains et canadiens.",
            faq5_q: 'Quel est le meilleur moment pour vÃ©rifier ?',
            faq5_a: "La fenÃªtre la plus fiable est la veille au soir (18h-22h). Vous pouvez aussi vÃ©rifier tÃ´t le matin (5h-7h) pour les derniÃ¨res mises Ã  jour.",
            faq_free_q: "Cet outil est-il vraiment gratuit et sans pub ?",
            faq_free_a: "Oui, 100% gratuit sans pub, sans inscription, sans filigrane et sans limites d'utilisation.",
            related_title: 'Outils connexes',
            related1_name: "Convertisseur d'unitÃ©s", related1_desc: 'Convertissez tempÃ©rature, longueur, poids instantanÃ©ment.',
            related2_name: 'Calculatrice', related2_desc: 'Calculatrice scientifique avec fonctions avancÃ©es.',
            related3_name: "Convertisseur d'horodatage", related3_desc: "Convertissez horodatages et fuseaux horaires.",
            related4_name: 'Palette de couleurs', related4_desc: 'Convertisseur HEX, RGB, HSL et gÃ©nÃ©rateur de palette.'
        },
        es: {
            tool_name: 'Calculadora DÃ­a de Nieve',
            title: 'Calculadora DÃ­a de Nieve',
            subtitle: 'Â¿Se cerrarÃ¡ la escuela maÃ±ana? Â¡Consulta la probabilidad!',
            label_zip: 'CÃ³digo postal o ciudad',
            placeholder_zip: 'ej. 10001 o New York',
            label_school: 'Tipo de escuela',
            school_public: 'Escuela pÃºblica',
            school_urban: 'PÃºblica urbana',
            school_rural: 'PÃºblica rural',
            school_private: 'Privada / Preparatoria',
            school_boarding: 'Internado',
            label_snowdays: 'DÃ­as de nieve usados este aÃ±o',
            placeholder_snowdays: '0',
            btn_calculate: 'â„ï¸ Calcular probabilidad',
            result_checking: 'Analizando datos meteorolÃ³gicos...',
            result_unlikely: 'DÃ­a de nieve improbable',
            result_possible: 'DÃ­a de nieve posible',
            result_likely: 'DÃ­a de nieve probable',
            result_very_likely: 'Â¡DÃ­a de nieve muy probable!',
            result_almost_certain: 'Â¡DÃ­a de nieve casi seguro! â„ï¸',
            stat_snowfall: 'Nevada',
            stat_temp: 'Temperatura',
            stat_wind: 'Velocidad del viento',
            stat_precip: 'PrecipitaciÃ³n',
            forecast_title: 'ğŸ“… PronÃ³stico de 3 dÃ­as',
            breakdown_title: 'ğŸ“Š Desglose de puntuaciÃ³n',
            bd_snow: 'Nevada',
            bd_temp: 'Temperatura',
            bd_wind: 'Velocidad del viento',
            bd_ice: 'Hielo / CongelaciÃ³n',
            bd_school: 'Tipo de escuela',
            bd_region: 'Factor regional',
            error_empty: 'Por favor ingrese un cÃ³digo postal o nombre de ciudad.',
            error_not_found: 'UbicaciÃ³n no encontrada. Intente otro cÃ³digo postal o ciudad.',
            error_weather: 'Error al obtener datos meteorolÃ³gicos. Intente de nuevo.',
            trust_users: 'ğŸŒ MÃ¡s de 50,000 usuarios',
            trust_rating: 'â­ CalificaciÃ³n 4.9/5',
            trust_privacy: 'ğŸ”’ 100% Privado',
            trust_free: 'ğŸš« Sin anuncios, sin registro',
            features_title: 'CaracterÃ­sticas principales',
            feature1_title: '100% Gratis y Privado',
            feature1_desc: 'Sin anuncios, sin registro, sin marca de agua. Los datos meteorolÃ³gicos se obtienen directamente en tu navegador.',
            feature2_title: 'Datos meteorolÃ³gicos en tiempo real',
            feature2_desc: 'Impulsado por Open-Meteo con actualizaciones por hora. Analiza nevada, temperatura, viento y precipitaciÃ³n.',
            feature3_title: 'Ajuste por tipo de escuela',
            feature3_desc: 'Considera el tipo de escuela â€” las escuelas rurales cierran mÃ¡s fÃ¡cilmente, los internados menos.',
            feature4_title: 'PronÃ³stico de 3 dÃ­as',
            feature4_desc: 'ObtÃ©n probabilidades de dÃ­a de nieve para los prÃ³ximos 3 dÃ­as con anÃ¡lisis detallado.',
            faq_title: 'Preguntas frecuentes',
            faq1_q: 'Â¿QuÃ© es una calculadora de dÃ­a de nieve?',
            faq1_a: 'Es una herramienta gratuita en lÃ­nea que predice la probabilidad de cierre escolar debido al clima invernal. Analiza pronÃ³sticos meteorolÃ³gicos en tiempo real incluyendo acumulaciÃ³n de nieve, temperatura, velocidad del viento y condiciones de hielo.',
            faq2_q: 'Â¿QuÃ© tan precisa es la predicciÃ³n?',
            faq2_a: 'Las predicciones a 24-48 horas tÃ­picamente logran un 75-85% de precisiÃ³n. Sin embargo, las decisiones finales siempre las toma tu distrito escolar.',
            faq3_q: 'Â¿QuÃ© factores afectan la probabilidad?',
            faq3_a: 'Factores clave incluyen: acumulaciÃ³n de nieve, temperatura y sensaciÃ³n tÃ©rmica, velocidad del viento, condiciones de hielo, tipo de escuela e infraestructura regional.',
            faq4_q: 'Â¿Funciona fuera de Estados Unidos?',
            faq4_a: 'Â¡SÃ­! Soporta bÃºsqueda por nombre de ciudad en todo el mundo. Sin embargo, el algoritmo estÃ¡ optimizado para distritos escolares de EE.UU. y CanadÃ¡.',
            faq5_q: 'Â¿CuÃ¡l es el mejor momento para consultar?',
            faq5_a: 'La ventana mÃ¡s confiable es la noche anterior (6-10 PM). TambiÃ©n puedes consultar temprano en la maÃ±ana (5-7 AM) para las Ãºltimas actualizaciones.',
            faq_free_q: 'Â¿Es realmente gratis y sin anuncios?',
            faq_free_a: 'SÃ­, 100% gratis sin anuncios, sin registro, sin marca de agua y sin lÃ­mites de uso.',
            related_title: 'Herramientas relacionadas',
            related1_name: 'Conversor de unidades', related1_desc: 'Convierte temperatura, longitud, peso al instante.',
            related2_name: 'Calculadora', related2_desc: 'Calculadora cientÃ­fica con funciones avanzadas.',
            related3_name: 'Conversor de marca de tiempo', related3_desc: 'Convierte marcas de tiempo y zonas horarias.',
            related4_name: 'Paleta de colores', related4_desc: 'Conversor HEX, RGB, HSL y generador de paleta.'
        }
    };

    function t(key) {
        var lang = typeof WebToolbox !== 'undefined' ? WebToolbox.getCurrentLang() : 'en';
        return (translations[lang] && translations[lang][key]) || translations.en[key] || key;
    }

    // ========== é›ªèŠ±åŠ¨ç”» ==========
    var canvas = document.getElementById('snowCanvas');
    var ctx = canvas.getContext('2d');
    var snowflakes = [];

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    function createSnowflake() {
        return {
            x: Math.random() * canvas.width,
            y: -10,
            r: Math.random() * 3 + 1,
            speed: Math.random() * 1.5 + 0.5,
            wind: Math.random() * 0.5 - 0.25,
            opacity: Math.random() * 0.6 + 0.3
        };
    }
    for (var i = 0; i < 60; i++) {
        var sf = createSnowflake();
        sf.y = Math.random() * canvas.height;
        snowflakes.push(sf);
    }

    function animateSnow() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (var j = 0; j < snowflakes.length; j++) {
            var s = snowflakes[j];
            ctx.beginPath();
            ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
            ctx.fillStyle = 'rgba(255,255,255,' + s.opacity + ')';
            ctx.fill();
            s.y += s.speed;
            s.x += s.wind + Math.sin(s.y * 0.01) * 0.3;
            if (s.y > canvas.height + 10) {
                snowflakes[j] = createSnowflake();
            }
        }
        requestAnimationFrame(animateSnow);
    }
    animateSnow();

    // ========== åœ°ç†ç¼–ç  ==========
    function geocode(query) {
        var url = 'https://geocoding-api.open-meteo.com/v1/search?name=' + encodeURIComponent(query) + '&count=5&language=en&format=json';
        return fetch(url).then(function(r) { return r.json(); }).then(function(data) {
            if (!data.results || data.results.length === 0) return null;
            // ä¼˜å…ˆåŒ¹é…é‚®ç¼–ï¼ˆå¦‚æœè¾“å…¥æ˜¯æ•°å­—ï¼‰
            var result = data.results[0];
            return {
                lat: result.latitude,
                lon: result.longitude,
                name: result.name,
                admin1: result.admin1 || '',
                country: result.country_code || '',
                timezone: result.timezone || 'auto'
            };
        });
    }

    // ========== å¤©æ°”æ•°æ® ==========
    function fetchWeather(lat, lon, timezone) {
        var url = 'https://api.open-meteo.com/v1/forecast?latitude=' + lat + '&longitude=' + lon +
            '&daily=snowfall_sum,temperature_2m_max,temperature_2m_min,windspeed_10m_max,precipitation_sum,rain_sum,weathercode' +
            '&hourly=snowfall,temperature_2m,windspeed_10m,precipitation' +
            '&timezone=' + encodeURIComponent(timezone || 'auto') +
            '&forecast_days=3';
        return fetch(url).then(function(r) { return r.json(); });
    }

    // ========== æ¦‚ç‡è®¡ç®—ç®—æ³• ==========
    // ç¾å›½å„å·åœ°åŒºç³»æ•°ï¼ˆå—æ–¹æ›´æ•æ„Ÿï¼ŒåŒ—æ–¹æ›´è€é›ªï¼‰
    var stateRegionMap = {
        'Alabama': 1.5, 'Alaska': 0.6, 'Arizona': 1.4, 'Arkansas': 1.4, 'California': 1.3,
        'Colorado': 0.8, 'Connecticut': 0.95, 'Delaware': 1.1, 'Florida': 1.8, 'Georgia': 1.5,
        'Hawaii': 2.0, 'Idaho': 0.8, 'Illinois': 0.9, 'Indiana': 0.9, 'Iowa': 0.8,
        'Kansas': 0.9, 'Kentucky': 1.2, 'Louisiana': 1.6, 'Maine': 0.7, 'Maryland': 1.1,
        'Massachusetts': 0.85, 'Michigan': 0.8, 'Minnesota': 0.7, 'Mississippi': 1.5,
        'Missouri': 1.0, 'Montana': 0.75, 'Nebraska': 0.85, 'Nevada': 1.1, 'New Hampshire': 0.75,
        'New Jersey': 1.0, 'New Mexico': 1.2, 'New York': 0.9, 'North Carolina': 1.3,
        'North Dakota': 0.7, 'Ohio': 0.9, 'Oklahoma': 1.2, 'Oregon': 1.1, 'Pennsylvania': 0.95,
        'Rhode Island': 0.9, 'South Carolina': 1.4, 'South Dakota': 0.8, 'Tennessee': 1.3,
        'Texas': 1.5, 'Utah': 0.8, 'Vermont': 0.7, 'Virginia': 1.15, 'Washington': 1.0,
        'West Virginia': 1.1, 'Wisconsin': 0.75, 'Wyoming': 0.75
    };

    var schoolMultiplier = {
        'public': 1.0, 'urban': 0.9, 'rural': 1.15, 'private': 1.1, 'boarding': 0.7
    };

    function calcDayScore(dayData, regionMult, schoolMult, snowDaysUsed) {
        var snow = dayData.snowfall || 0; // cm
        var tempMin = dayData.tempMin;
        var tempMax = dayData.tempMax;
        var wind = dayData.wind || 0; // km/h
        var precip = dayData.precip || 0; // mm
        var rain = dayData.rain || 0;

        // é™é›ªè¯„åˆ† (0-40) â€” ä¸»è¦é©±åŠ¨å› ç´ 
        var snowScore = 0;
        if (snow >= 30) snowScore = 40;
        else if (snow >= 20) snowScore = 37;
        else if (snow >= 15) snowScore = 34;
        else if (snow >= 10) snowScore = 30;
        else if (snow >= 7) snowScore = 25;
        else if (snow >= 5) snowScore = 20;
        else if (snow >= 3) snowScore = 14;
        else if (snow >= 1) snowScore = 8;
        else if (snow >= 0.3) snowScore = 3;

        // æ¸©åº¦è¯„åˆ† (0-25)
        var avgTemp = (tempMin + tempMax) / 2;
        var tempScore = 0;
        if (avgTemp <= -20) tempScore = 25;
        else if (avgTemp <= -15) tempScore = 22;
        else if (avgTemp <= -10) tempScore = 18;
        else if (avgTemp <= -5) tempScore = 14;
        else if (avgTemp <= 0) tempScore = 10;
        else if (avgTemp <= 2) tempScore = 6;
        else if (avgTemp <= 5) tempScore = 2;

        // é£é€Ÿè¯„åˆ† (0-20)
        var windScore = 0;
        if (wind >= 80) windScore = 20;
        else if (wind >= 60) windScore = 16;
        else if (wind >= 45) windScore = 12;
        else if (wind >= 30) windScore = 8;
        else if (wind >= 20) windScore = 4;

        // ç»“å†°è¯„åˆ† (0-20)
        var iceScore = 0;
        var freezingRain = (precip > 0 && rain > 0 && avgTemp <= 2 && avgTemp >= -5);
        if (freezingRain) {
            iceScore = Math.min(20, Math.round(precip * 3));
        } else if (avgTemp <= 0 && precip > 0 && snow < 1) {
            iceScore = Math.min(15, Math.round(precip * 2));
        }

        // æš´é£é›ªç»„åˆåŠ æˆ (0-15)ï¼šå¤šå› ç´ åŒæ—¶ä¸¥é‡æ—¶é¢å¤–åŠ åˆ†
        var comboBonus = 0;
        if (snow >= 5 && avgTemp <= 0 && wind >= 25) comboBonus += 8;
        if (snow >= 10 && wind >= 35) comboBonus += 5;
        if (snow >= 15 && avgTemp <= -5) comboBonus += 2;
        comboBonus = Math.min(15, comboBonus);

        // åŸºç¡€å¾—åˆ†
        var baseScore = snowScore + tempScore + windScore + iceScore + comboBonus;

        // åº”ç”¨ä¹˜æ•°
        var adjusted = baseScore * regionMult * schoolMult;

        // é›ªæ—¥ä½¿ç”¨ä¿®æ­£ï¼ˆç”¨çš„è¶Šå¤šï¼Œå­¦åŒºè¶Šå€¾å‘ä¿ç•™ï¼‰
        if (snowDaysUsed > 3) adjusted *= 0.93;
        if (snowDaysUsed > 6) adjusted *= 0.90;

        // é™åˆ¶åœ¨0-99èŒƒå›´
        var probability = Math.min(99, Math.max(0, Math.round(adjusted)));

        return {
            probability: probability,
            snowScore: snowScore,
            tempScore: tempScore,
            windScore: windScore,
            iceScore: iceScore,
            regionMult: regionMult,
            schoolMult: schoolMult
        };
    }

    // ========== UI æ›´æ–° ==========
    function getGaugeColor(pct) {
        if (pct < 20) return '#4caf50';
        if (pct < 40) return '#8bc34a';
        if (pct < 60) return '#ffeb3b';
        if (pct < 80) return '#ff9800';
        return '#f44336';
    }

    function getResultLabel(pct) {
        if (pct < 20) return t('result_unlikely');
        if (pct < 40) return t('result_possible');
        if (pct < 60) return t('result_likely');
        if (pct < 80) return t('result_very_likely');
        return t('result_almost_certain');
    }

    function getWeatherEmoji(code) {
        if (code >= 71 && code <= 77) return 'ğŸŒ¨ï¸';
        if (code >= 85) return 'â„ï¸';
        if (code >= 61 && code <= 67) return 'ğŸŒ§ï¸';
        if (code >= 51 && code <= 57) return 'ğŸŒ¦ï¸';
        if (code >= 80 && code <= 84) return 'ğŸŒ§ï¸';
        if (code >= 95) return 'â›ˆï¸';
        if (code >= 45 && code <= 48) return 'ğŸŒ«ï¸';
        if (code >= 1 && code <= 3) return 'â›…';
        return 'â˜€ï¸';
    }

    function getDayName(dateStr, idx) {
        if (idx === 0) return 'Today';
        if (idx === 1) return 'Tomorrow';
        var d = new Date(dateStr);
        return d.toLocaleDateString('en-US', { weekday: 'short' });
    }

    function animateGauge(targetPct) {
        var fill = document.getElementById('gaugeFill');
        var valueEl = document.getElementById('gaugeValue');
        var color = getGaugeColor(targetPct);
        fill.style.borderTopColor = color;
        fill.style.borderRightColor = color;
        // ä»ªè¡¨ç›˜è§’åº¦ï¼š0% = 225deg (èµ·ç‚¹), 100% = 225deg + 270deg = 495deg
        var angle = 225 + (targetPct / 100) * 270;
        fill.style.transform = 'rotate(' + angle + 'deg)';

        // æ•°å­—åŠ¨ç”»
        var current = 0;
        var step = Math.max(1, Math.round(targetPct / 40));
        var timer = setInterval(function() {
            current += step;
            if (current >= targetPct) {
                current = targetPct;
                clearInterval(timer);
            }
            valueEl.textContent = current;
            valueEl.style.color = getGaugeColor(current);
        }, 30);
    }

    function showResults(location, weatherData, schoolType, snowDaysUsed) {
        var daily = weatherData.daily;
        var regionMult = 1.0;
        if (location.admin1 && stateRegionMap[location.admin1]) {
            regionMult = stateRegionMap[location.admin1];
        }
        var schoolMult = schoolMultiplier[schoolType] || 1.0;

        // è®¡ç®—3å¤©æ•°æ®
        var days = [];
        for (var i = 0; i < 3; i++) {
            var dayData = {
                date: daily.time[i],
                snowfall: daily.snowfall_sum[i] || 0,
                tempMin: daily.temperature_2m_min[i],
                tempMax: daily.temperature_2m_max[i],
                wind: daily.windspeed_10m_max[i] || 0,
                precip: daily.precipitation_sum[i] || 0,
                rain: daily.rain_sum[i] || 0,
                weathercode: daily.weathercode[i]
            };
            var score = calcDayScore(dayData, regionMult, schoolMult, snowDaysUsed);
            days.push({ data: dayData, score: score });
        }

        // æ˜¾ç¤ºç»“æœ
        var rs = document.getElementById('resultSection');
        rs.classList.add('visible');

        // ä»Šæ—¥æ¦‚ç‡
        var todayScore = days[0].score;
        var todayData = days[0].data;

        document.getElementById('gaugeLabel').textContent = getResultLabel(todayScore.probability);
        document.getElementById('gaugeSublabel').textContent = t('disclaimer');
        document.getElementById('locationInfo').textContent = 'ğŸ“ ' + location.name + (location.admin1 ? ', ' + location.admin1 : '') + (location.country ? ' (' + location.country + ')' : '');

        animateGauge(todayScore.probability);

        // å¤©æ°”è¯¦æƒ…
        document.getElementById('statSnow').textContent = todayData.snowfall.toFixed(1) + ' cm';
        document.getElementById('statTemp').textContent = todayData.tempMin.toFixed(0) + 'Â°/' + todayData.tempMax.toFixed(0) + 'Â°C';
        document.getElementById('statWind').textContent = todayData.wind.toFixed(0) + ' km/h';
        document.getElementById('statPrecip').textContent = todayData.precip.toFixed(1) + ' mm';

        // 3å¤©é¢„æŠ¥
        var forecastHTML = '';
        for (var d = 0; d < days.length; d++) {
            var day = days[d];
            var pct = day.score.probability;
            var barColor = getGaugeColor(pct);
            forecastHTML += '<div class="forecast-day">' +
                '<div class="day-name">' + getDayName(day.data.date, d) + '</div>' +
                '<div class="day-weather">' + getWeatherEmoji(day.data.weathercode) + '</div>' +
                '<div class="day-bar-wrap"><div class="day-bar" style="width:' + pct + '%;background:' + barColor + '"></div></div>' +
                '<div class="day-pct" style="color:' + barColor + '">' + pct + '%</div>' +
                '</div>';
        }
        document.getElementById('forecastDays').innerHTML = forecastHTML;

        // è¯„åˆ†åˆ†è§£
        var s = todayScore;
        var breakdowns = [
            { label: t('bd_snow'), pts: s.snowScore, max: 35, color: '#64b5f6' },
            { label: t('bd_temp'), pts: s.tempScore, max: 25, color: '#4dd0e1' },
            { label: t('bd_wind'), pts: s.windScore, max: 20, color: '#81c784' },
            { label: t('bd_ice'), pts: s.iceScore, max: 20, color: '#ffb74d' },
            { label: t('bd_school'), pts: Math.round((s.schoolMult - 0.7) / 0.8 * 10), max: 10, color: '#ce93d8' },
            { label: t('bd_region'), pts: Math.round((s.regionMult - 0.6) / 1.4 * 10), max: 10, color: '#ef9a9a' }
        ];
        var bdHTML = '';
        for (var b = 0; b < breakdowns.length; b++) {
            var bd = breakdowns[b];
            var w = Math.round((bd.pts / bd.max) * 100);
            bdHTML += '<div class="breakdown-item">' +
                '<div class="bd-label">' + bd.label + '</div>' +
                '<div class="bd-bar-wrap"><div class="bd-bar" style="width:' + w + '%;background:' + bd.color + '"></div></div>' +
                '<div class="bd-pts">' + bd.pts + '/' + bd.max + '</div>' +
                '</div>';
        }
        document.getElementById('breakdownItems').innerHTML = bdHTML;

        // æ»šåŠ¨åˆ°ç»“æœ
        rs.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // ========== äº‹ä»¶ç»‘å®š ==========
    var calcBtn = document.getElementById('calcBtn');
    var zipInput = document.getElementById('zipInput');
    var errorMsg = document.getElementById('errorMsg');

    function showError(msg) {
        errorMsg.textContent = msg;
        errorMsg.classList.add('visible');
    }
    function hideError() {
        errorMsg.classList.remove('visible');
    }

    function doCalculate() {
        hideError();
        var query = zipInput.value.trim();
        if (!query) {
            showError(t('error_empty'));
            return;
        }

        calcBtn.classList.add('loading');
        calcBtn.querySelector('span').textContent = t('result_checking');

        geocode(query).then(function(loc) {
            if (!loc) {
                showError(t('error_not_found'));
                calcBtn.classList.remove('loading');
                calcBtn.querySelector('span').textContent = t('btn_calculate');
                return;
            }

            return fetchWeather(loc.lat, loc.lon, loc.timezone).then(function(weather) {
                if (!weather || !weather.daily) {
                    showError(t('error_weather'));
                    return;
                }
                var schoolType = document.getElementById('schoolType').value;
                var snowDaysUsed = parseInt(document.getElementById('snowDaysUsed').value) || 0;
                showResults(loc, weather, schoolType, snowDaysUsed);
            });
        }).catch(function() {
            showError(t('error_weather'));
        }).then(function() {
            calcBtn.classList.remove('loading');
            calcBtn.querySelector('span').textContent = t('btn_calculate');
        });
    }

    calcBtn.addEventListener('click', doCalculate);
    zipInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') doCalculate();
    });

    // æš´éœ²ç¿»è¯‘
    window._translations = translations;
})();
</script>
<script src="common/common.js"
    data-tool-id="snow-day-calculator"
    data-tool-name="Snow Day Calculator"
    data-show-theme-toggle="true"
    data-category="utility"></script>
<script>WebToolbox.init(window._translations);</script>
</body>
</html>
