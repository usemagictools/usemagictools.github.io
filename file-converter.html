<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CT8E5N460D"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-CT8E5N460D');</script>
  <title>File Converter - Free Online Cross-Media Format Bridge | No Ads, No Signup</title>
  <meta name="description" content="Free online file converter: Video to GIF, Video to Audio (WAV), SVG to PNG/JPG, Image to Base64. âœ… No ads âœ… No signup âœ… No limits. 100% browser-based.">
  <meta name="keywords" content="file converter,video to gif,video to audio,svg to png,image to base64,gif maker,extract audio from video,è·¨åª’ä½“è½¬æ¢,æ ¼å¼è½¬æ¢,no ads,no signup,no login,no watermark,free unlimited,browser-based,no installation,local processing,no upload">
  <meta name="author" content="UseMagicTools">
  <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
  <meta name="googlebot" content="index, follow">
  <meta name="bingbot" content="index, follow">
  <meta name="revisit-after" content="7 days">
  <meta name="rating" content="general">
  <meta name="distribution" content="global">
  <meta name="language" content="en">
  <link rel="canonical" href="https://www.usemagictools.com/file-converter.html">
  <link rel="alternate" hreflang="en" href="https://www.usemagictools.com/file-converter.html">
  <link rel="alternate" hreflang="zh-CN" href="https://www.usemagictools.com/file-converter.html">
  <link rel="alternate" hreflang="fr" href="https://www.usemagictools.com/file-converter.html">
  <link rel="alternate" hreflang="es" href="https://www.usemagictools.com/file-converter.html">
  <link rel="alternate" hreflang="x-default" href="https://www.usemagictools.com/file-converter.html">

  <meta property="og:type" content="website">
  <meta property="og:url" content="https://www.usemagictools.com/file-converter.html">
  <meta property="og:title" content="File Converter - Free Cross-Media Format Bridge | No Ads, No Signup">
  <meta property="og:description" content="Convert Video to GIF, extract audio from video, SVG to PNG/JPG, Image to Base64 â€” all in browser.">
  <meta property="og:image" content="https://www.usemagictools.com/screenshots/file-converter-v1.webp">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:locale" content="en_US">
  <meta property="og:locale:alternate" content="zh_CN">
  <meta property="og:site_name" content="Web Toolbox">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@usemagictools">
  <meta name="twitter:creator" content="@usemagictools">
  <meta name="twitter:title" content="File Converter - Free Cross-Media Format Bridge | No Ads, No Signup">
  <meta name="twitter:description" content="Video to GIF, Video to Audio, SVG to PNG/JPG, Image to Base64 in browser.">
  <meta name="twitter:image" content="https://www.usemagictools.com/screenshots/file-converter-v1.webp">

  <!-- JSON-LD: WebApplication -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"File Converter",
    "alternateName":["è·¨åª’ä½“æ ¼å¼è½¬æ¢","Cross-Media Format Bridge","Video to GIF Converter","SVG to PNG Converter"],
    "url":"https://www.usemagictools.com/file-converter.html",
    "description":"Free online cross-media file converter: Video to GIF, Video to Audio, SVG to PNG/JPG, and Image to Base64 conversion.",
    "inLanguage":["en","zh-CN","fr","es"],
    "applicationCategory":"UtilitiesApplication",
    "operatingSystem":"Web Browser",
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},
    "author":{"@type":"Person","name":"UseMagicTools"},
    "publisher":{"@type":"Organization","name":"Web Toolbox","url":"https://www.usemagictools.com/"},
    "featureList":["Video to GIF with frame rate and quality control","Extract audio track from video as WAV","SVG to PNG/JPG with scale options","Image to Base64 bidirectional conversion","No ads","No signup required","No watermark","No upload required","100% browser-based","Free unlimited usage"],
    "screenshot":"https://www.usemagictools.com/screenshots/file-converter-v1.webp"
  }
  </script>

  <!-- JSON-LD: BreadcrumbList -->
  <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
        {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://www.usemagictools.com/"
        },
        {
            "@type": "ListItem",
            "position": 2,
            "name": "File Converter",
            "item": "https://www.usemagictools.com/file-converter.html"
        }
    ]
}
    </script>

  <!-- JSON-LD: HowTo -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"HowTo",
    "name":"How to Convert Files Online",
    "totalTime":"PT2M",
    "step":[
      {"@type":"HowToStep","position":1,"name":"Choose conversion mode","text":"Select one of four tabs: Video to GIF, Video to Audio, SVG to PNG/JPG, or Image to Base64."},
      {"@type":"HowToStep","position":2,"name":"Upload and configure","text":"Upload your source file and adjust conversion parameters like frame rate, quality, or scale."},
      {"@type":"HowToStep","position":3,"name":"Convert and download","text":"Click Convert and download the result file instantly. All processing happens in your browser."}
    ]
  }
  </script>

  <!-- JSON-LD: FAQPage -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"What is a cross-media file converter and what formats does it support?","acceptedAnswer":{"@type":"Answer","text":"A cross-media file converter bridges different media types: it can turn video clips into animated GIFs, extract audio tracks from video files as WAV, convert vector SVG graphics to raster PNG or JPG images, and encode images to Base64 data URIs. This tool supports all four conversions entirely in the browser with no server upload required."}},
      {"@type":"Question","name":"How does Video to GIF conversion work in the browser?","acceptedAnswer":{"@type":"Answer","text":"The Video to GIF feature uses Canvas API to capture video frames at your chosen frame rate, then encodes them into an animated GIF using the gif.js library. You can control start/end time, output width, frame rate (5-20 fps), and quality level. The entire process runs locally in your browser without uploading video to any server."}},
      {"@type":"Question","name":"Can I extract audio from video without installing software?","acceptedAnswer":{"@type":"Answer","text":"Yes. The Video to Audio tab uses the Web Audio API to decode the video file and extract its audio track, then exports it as a WAV file. This works entirely in the browser with no FFmpeg or server-side processing needed. For MP3 conversion, you can use our Audio Cutter tool afterwards."}},
      {"@type":"Question","name":"How do I convert SVG to PNG or JPG with high resolution?","acceptedAnswer":{"@type":"Answer","text":"Upload your SVG file and choose PNG or JPG output format. Use the scale multiplier (1x to 4x) to control output resolution â€” 2x doubles the dimensions for crisp retina displays. For JPG output, you can also set a background color since JPG does not support transparency."}},
      {"@type":"Question","name":"What is Base64 encoding for images and when should I use it?","acceptedAnswer":{"@type":"Answer","text":"Base64 encoding converts an image file into a text string (data URI) that can be embedded directly in HTML or CSS. This eliminates extra HTTP requests and is useful for small icons, email templates, and inline assets. Our tool supports bidirectional conversion: image to Base64 and Base64 back to image."}},
      {"@type":"Question","name":"Is this tool really free with no ads?","acceptedAnswer":{"@type":"Answer","text":"Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All processing happens locally in your browser â€” your files are never uploaded to any server. Your privacy is fully protected."}}
    ]
  }
  </script>

  <style>
    :root{--bg:#020617;--card:#0f172a;--muted:#94a3b8;--text:#e2e8f0;--border:rgba(148,163,184,.15);--primary:#3b82f6;--primary2:#2563eb;--green:#10b981;--radius:16px}
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:"Inter","SF Pro Text",-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:var(--bg);color:var(--text);min-height:100vh;padding:24px 16px 60px;overflow-x:hidden}

    /* æµ®åŠ¨èƒŒæ™¯å…‰çƒ */
    .orb{position:fixed;border-radius:50%;filter:blur(90px);pointer-events:none;z-index:0;animation:bgFloat 22s ease-in-out infinite}
    .orb-1{width:420px;height:420px;top:-120px;left:-80px;background:rgba(59,130,246,.22)}
    .orb-2{width:360px;height:360px;bottom:-80px;right:-60px;background:rgba(139,92,246,.18);animation-delay:-8s}
    .orb-3{width:280px;height:280px;top:45%;left:55%;background:rgba(16,185,129,.14);animation-delay:-15s}
    @keyframes bgFloat{0%,100%{transform:translate(0,0) scale(1)}33%{transform:translate(30px,-25px) scale(1.06)}66%{transform:translate(-25px,18px) scale(.94)}}

    .anim{opacity:0;animation:fadeInUp .55s ease forwards}
    .anim-d1{animation-delay:.05s}.anim-d2{animation-delay:.12s}.anim-d3{animation-delay:.2s}.anim-d4{animation-delay:.28s}.anim-d5{animation-delay:.36s}.anim-d6{animation-delay:.44s}.anim-d7{animation-delay:.52s}

    .container{max-width: 1200px;margin:0 auto;padding:40px 40px;position:relative;z-index:1}

    /* æ ‡é¢˜ */
    h1{text-align:center;font-size:2.2rem;font-weight:700;letter-spacing:-.03em;margin-bottom:8px;background:linear-gradient(135deg,#e2e8f0,#94a3b8);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .subtitle{text-align:center;color:var(--muted);margin-bottom:20px;font-size:15px}

    /* æ­¥éª¤æŒ‡ç¤ºå™¨ */
    .steps{display:flex;align-items:center;justify-content:center;gap:0;margin-bottom:22px}
    .step{display:flex;align-items:center;gap:7px;padding:6px 12px;font-size:13px;color:var(--muted);font-weight:500;transition:color .3s}
    .step-num{width:26px;height:26px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;border:2px solid var(--border);background:transparent;transition:all .3s}
    .step.active{color:var(--primary)}.step.active .step-num{border-color:var(--primary);background:var(--primary);color:#fff}
    .step.done{color:var(--green)}.step.done .step-num{border-color:var(--green);background:var(--green);color:#fff}
    .step-line{width:36px;height:2px;background:var(--border);transition:background .3s}
    .step-line.done{background:var(--green)}

    /* æ¯›ç»ç’ƒä¸»å¡ç‰‡ */
    .glass-card{background:rgba(15,23,42,.55);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid var(--border);border-radius:var(--radius);transition:border-color .4s,box-shadow .4s;overflow:hidden}
    .glass-card.state-done{border-color:rgba(16,185,129,.4);box-shadow:0 0 40px rgba(16,185,129,.12)}

    /* Tab æ  */
    .tab-bar{display:flex;border-bottom:1px solid var(--border);overflow-x:auto}
    .tab{flex:1;padding:14px 10px;text-align:center;font-size:14px;font-weight:500;color:var(--muted);cursor:pointer;border:none;background:transparent;position:relative;transition:color .2s;white-space:nowrap}
    .tab:hover{color:var(--text)}
    .tab.active{color:#fff}
    .tab.active::after{content:'';position:absolute;bottom:0;left:10%;right:10%;height:2px;background:linear-gradient(90deg,var(--primary),#818cf8);border-radius:2px}

    /* é¢æ¿åŒºåŸŸ */
    .panels{padding:20px}
    .panel{display:none}
    .panel.active{display:block}

    /* ä¸Šä¼ æ‹–æ‹½åŒº */
    .drop-zone{border:2px dashed rgba(148,163,184,.2);border-radius:14px;padding:40px 20px;text-align:center;cursor:pointer;transition:all .3s;position:relative;overflow:hidden}
    .drop-zone:hover,.drop-zone.dragover{border-color:rgba(59,130,246,.5);background:rgba(59,130,246,.05)}
    .drop-zone.dragover{animation:dropPulse 1.5s ease-in-out infinite}
    @keyframes dropPulse{0%,100%{box-shadow:inset 0 0 0 0 rgba(59,130,246,0)}50%{box-shadow:inset 0 0 30px rgba(59,130,246,.1)}}
    .drop-icon{font-size:48px;opacity:.4;margin-bottom:12px}
    .drop-text{color:var(--muted);font-size:15px;margin-bottom:4px}
    .drop-hint{color:var(--muted);font-size:12px;opacity:.7}
    .file-loaded{display:none;align-items:center;gap:12px;padding:12px 16px;border:1px solid var(--border);border-radius:12px;background:rgba(2,6,23,.4);margin-top:14px}
    .file-loaded.show{display:flex}
    .file-loaded-icon{font-size:22px}.file-loaded-name{flex:1;font-size:14px;font-weight:500;word-break:break-all}.file-loaded-size{font-size:12px;color:var(--muted)}.file-loaded-remove{background:none;border:none;color:var(--muted);cursor:pointer;font-size:16px;padding:4px 8px;border-radius:6px;transition:color .2s}.file-loaded-remove:hover{color:#ef4444}

    /* å‚æ•°é¢æ¿ */
    .params{margin-top:16px;display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px}
    .param-group{display:flex;flex-direction:column;gap:6px}
    .param-label{font-size:13px;color:var(--muted);font-weight:500}
    .param-control select,.param-control input[type="number"],.param-control input[type="text"]{width:100%;background:rgba(2,6,23,.6);border:1px solid var(--border);color:var(--text);border-radius:8px;padding:8px 12px;font-size:13px;outline:none;transition:border-color .2s}
    .param-control select:focus,.param-control input:focus{border-color:var(--primary)}
    .param-control input[type="color"]{-webkit-appearance:none;appearance:none;width:100%;height:36px;border:1px solid var(--border);border-radius:8px;background:transparent;cursor:pointer;padding:2px}
    .param-control input[type="color"]::-webkit-color-swatch-wrapper{padding:0}
    .param-control input[type="color"]::-webkit-color-swatch{border:none;border-radius:5px}

    /* è§†é¢‘/SVG/å›¾ç‰‡é¢„è§ˆ */
    .preview-area{margin-top:14px;border-radius:12px;overflow:hidden;border:1px solid var(--border);background:rgba(2,6,23,.5);display:none}
    .preview-area.show{display:block}
    .preview-area video,.preview-area img{width:100%;max-height:360px;display:block;object-fit:contain}

    /* æç¤ºæ–‡å­— */
    .info-box{margin-top:12px;padding:12px 14px;border-radius:10px;background:rgba(59,130,246,.08);border:1px solid rgba(59,130,246,.2);font-size:13px;color:#93c5fd;line-height:1.6}

    /* è½¬æ¢æŒ‰é’® */
    .convert-btn{display:flex;align-items:center;justify-content:center;gap:10px;width:100%;margin-top:18px;padding:14px 28px;border:none;border-radius:14px;background:linear-gradient(135deg,var(--primary),var(--primary2));color:#fff;font-size:16px;font-weight:600;cursor:pointer;transition:all .25s;box-shadow:0 4px 24px rgba(59,130,246,.3)}
    .convert-btn:hover{transform:translateY(-2px);box-shadow:0 8px 32px rgba(59,130,246,.45)}
    .convert-btn:disabled{opacity:.4;cursor:not-allowed;transform:none;box-shadow:none}

    /* è¿›åº¦æ¡ */
    .progress-wrap{margin-top:16px;display:none}
    .progress-wrap.show{display:block}
    .progress-bar{height:8px;border-radius:4px;background:rgba(148,163,184,.1);overflow:hidden}
    .progress-fill{height:100%;width:0;border-radius:4px;background:linear-gradient(90deg,var(--primary),#818cf8);transition:width .3s}
    .progress-text{text-align:center;font-size:13px;color:var(--muted);margin-top:6px}

    /* ç»“æœåŒº */
    .result-area{margin-top:18px;display:none}
    .result-area.show{display:block}
    .result-preview{border-radius:12px;overflow:hidden;border:1px solid rgba(16,185,129,.3);background:rgba(2,6,23,.5);max-height:360px;display:flex;align-items:center;justify-content:center}
    .result-preview img{max-width:100%;max-height:360px;display:block;object-fit:contain}
    .result-info{display:flex;align-items:center;justify-content:space-between;gap:14px;flex-wrap:wrap;margin-top:12px;padding:14px 16px;border:1px solid var(--border);border-radius:12px;background:rgba(2,6,23,.4)}
    .result-meta{font-size:14px;color:var(--text)}.result-size{font-size:12px;color:var(--muted)}
    .download-btn{display:flex;align-items:center;gap:8px;padding:11px 26px;border:none;border-radius:12px;background:linear-gradient(135deg,#10b981,#059669);color:#fff;font-size:15px;font-weight:600;cursor:pointer;transition:all .25s;animation:glowPulse 2.2s ease-in-out infinite}
    .download-btn:hover{transform:translateY(-2px);box-shadow:0 8px 28px rgba(16,185,129,.5)}
    @keyframes glowPulse{0%,100%{box-shadow:0 0 14px rgba(16,185,129,.25)}50%{box-shadow:0 0 32px rgba(16,185,129,.5)}}

    /* Base64 ç‰¹æ®Š - æ–‡æœ¬åŒºåŸŸ */
    .b64-textarea{width:100%;min-height:160px;background:rgba(2,6,23,.6);border:1px solid var(--border);color:var(--text);border-radius:10px;padding:12px;font-size:13px;font-family:"JetBrains Mono","SF Mono",Consolas,monospace;resize:vertical;outline:none;transition:border-color .2s}
    .b64-textarea:focus{border-color:var(--primary)}
    .b64-textarea::placeholder{color:var(--muted);opacity:.6}
    .copy-btn{padding:10px 20px;border:1px solid var(--border);border-radius:10px;background:rgba(15,23,42,.7);color:var(--text);font-size:14px;cursor:pointer;transition:all .2s}
    .copy-btn:hover{border-color:#64748b;background:rgba(30,41,59,.7)}
    .copy-btn.copied{border-color:rgba(16,185,129,.4);color:#6ee7b7}

    /* æ¨¡å¼åˆ‡æ¢æŒ‰é’®ç»„ */
    .mode-toggle{display:flex;border:1px solid var(--border);border-radius:10px;overflow:hidden;margin-bottom:16px}
    .mode-btn{flex:1;padding:10px 16px;background:transparent;border:none;color:var(--muted);font-size:14px;font-weight:500;cursor:pointer;transition:all .2s}
    .mode-btn.active{background:rgba(59,130,246,.15);color:var(--primary)}

    /* çŠ¶æ€è¡Œ */
    .status-line{padding:10px 20px;font-size:13px;color:#93c5fd;min-height:38px;border-top:1px solid var(--border)}

    /* Trust Bar + SEO åŒºå— */
    .features-section,.faq-section,.related-tools{margin-top:30px}
    .features-section h2,.faq-section h2,.related-tools h3{margin:0 0 16px;font-size:1.2rem}
    .features-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
    .related-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px}
    .feature,.related-card{border:1px solid var(--border);border-radius:12px;padding:14px;background:rgba(2,6,23,.45);transition:border-color .2s,transform .2s}.feature:hover,.related-card:hover{border-color:rgba(148,163,184,.3);transform:translateY(-2px)}.feature h4,.related-card h4{margin:8px 0 6px;font-size:14px}.feature p,.related-card p{color:var(--muted);font-size:13px;line-height:1.6}
    .related-card{text-decoration:none;color:inherit;display:block}
    .faq-item{border:1px solid var(--border);border-radius:12px;margin-bottom:8px;overflow:hidden;background:rgba(2,6,23,.4);transition:border-color .2s}.faq-item:hover{border-color:rgba(148,163,184,.25)}.faq-question{width:100%;text-align:left;background:transparent;border:0;color:var(--text);padding:14px 16px;cursor:pointer;font-size:14px;font-weight:500;display:flex;justify-content:space-between;align-items:center}.faq-question::after{content:'+';font-size:18px;color:var(--muted);transition:transform .2s}.faq-item.active .faq-question::after{transform:rotate(45deg)}.faq-answer{display:none;padding:0 16px 14px;color:var(--muted);font-size:13px;line-height:1.65}.faq-item.active .faq-answer{display:block}

    @media(max-width:960px){.features-grid{grid-template-columns:repeat(2,1fr)}.params{grid-template-columns:1fr 1fr}}
    @media(max-width:640px){h1{font-size:1.7rem}.features-grid{grid-template-columns:1fr}.steps{gap:0}.step span:not(.step-num){display:none}.tab{font-size:13px;padding:12px 6px}.params{grid-template-columns:1fr}.result-info{flex-direction:column;align-items:stretch}.result-info .download-btn{justify-content:center}.container{padding:20px}}
  </style>
    <link rel="stylesheet" href="common/common.css">
</head>
<body>
<!-- èƒŒæ™¯å…‰çƒ -->
<div class="orb orb-1"></div>
<div class="orb orb-2"></div>
<div class="orb orb-3"></div>

<div class="container">
  <!-- æ ‡é¢˜ -->
  <h1 class="anim anim-d2" data-i18n="title">File Converter</h1>
  <p class="subtitle anim anim-d2" data-i18n="subtitle">Cross-media format bridge â€” Video, Image, SVG & Base64</p>

  <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
  <div class="steps anim anim-d3">
    <div class="step active" id="step1"><span class="step-num">1</span><span data-i18n="step_upload">Upload</span></div>
    <div class="step-line" id="stepLine1"></div>
    <div class="step" id="step2"><span class="step-num">2</span><span data-i18n="step_convert">Convert</span></div>
    <div class="step-line" id="stepLine2"></div>
    <div class="step" id="step3"><span class="step-num">3</span><span data-i18n="step_download">Download</span></div>
  </div>

  <!-- ä¸»å¡ç‰‡ -->
  <div class="glass-card anim anim-d4" id="mainCard">
    <!-- Tab æ  -->
    <div class="tab-bar">
      <button class="tab active" data-tab="video-gif" data-i18n="tab_vgif">Video â†’ GIF</button>
      <button class="tab" data-tab="video-audio" data-i18n="tab_vaudio">Video â†’ Audio</button>
      <button class="tab" data-tab="svg-img" data-i18n="tab_svg">SVG â†’ PNG/JPG</button>
      <button class="tab" data-tab="img-b64" data-i18n="tab_b64">Image â†” Base64</button>
    </div>

    <!-- ===== Panel: Video â†’ GIF ===== -->
    <div class="panels">
      <div class="panel active" id="panel-video-gif">
        <div class="drop-zone" id="dropGif">
          <div class="drop-icon">ğŸ¬</div>
          <div class="drop-text" data-i18n="drop_video">Drop video file here or click to browse</div>
          <div class="drop-hint" data-i18n="drop_video_hint">MP4, WebM, MOV supported</div>
          <input type="file" accept="video/*" style="display:none" id="inputGif">
        </div>
        <div class="file-loaded" id="fileGif"><span class="file-loaded-icon">ğŸ¬</span><span class="file-loaded-name" id="fileGifName"></span><span class="file-loaded-size" id="fileGifSize"></span><button class="file-loaded-remove" id="removeGif">âœ•</button></div>
        <div class="preview-area" id="previewGif"><video id="videoGif" controls muted></video></div>
        <div class="params" id="paramsGif">
          <div class="param-group"><div class="param-label" data-i18n="p_start">Start time (s)</div><div class="param-control"><input type="number" id="gifStart" min="0" step="0.1" value="0"></div></div>
          <div class="param-group"><div class="param-label" data-i18n="p_end">End time (s)</div><div class="param-control"><input type="number" id="gifEnd" min="0" step="0.1" value="3"></div></div>
          <div class="param-group"><div class="param-label" data-i18n="p_fps">Frame rate (fps)</div><div class="param-control"><select id="gifFps"><option value="5">5 fps</option><option value="10" selected>10 fps</option><option value="15">15 fps</option><option value="20">20 fps</option></select></div></div>
          <div class="param-group"><div class="param-label" data-i18n="p_width">Output width</div><div class="param-control"><select id="gifWidth"><option value="0" data-i18n="p_original">Original</option><option value="480">480px</option><option value="320" selected>320px</option></select></div></div>
          <div class="param-group"><div class="param-label" data-i18n="p_quality">Quality</div><div class="param-control"><select id="gifQuality"><option value="1" data-i18n="p_q_high">High</option><option value="5" selected data-i18n="p_q_medium">Medium</option><option value="10" data-i18n="p_q_low">Low</option></select></div></div>
        </div>
        <button class="convert-btn" id="btnConvertGif" disabled data-i18n="btn_convert">Convert to GIF</button>
        <div class="progress-wrap" id="progressGif"><div class="progress-bar"><div class="progress-fill" id="progressGifFill"></div></div><div class="progress-text" id="progressGifText">0%</div></div>
        <div class="result-area" id="resultGif"><div class="result-preview"><img id="resultGifImg" alt="GIF result"></div><div class="result-info"><div><div class="result-meta" id="resultGifMeta"></div><div class="result-size" id="resultGifSize"></div></div><button class="download-btn" id="dlGif">â¬‡ <span data-i18n="btn_download">Download</span></button></div></div>
      </div>

      <!-- ===== Panel: Video â†’ Audio ===== -->
      <div class="panel" id="panel-video-audio">
        <div class="drop-zone" id="dropAudio">
          <div class="drop-icon">ğŸµ</div>
          <div class="drop-text" data-i18n="drop_video_audio">Drop video file here or click to browse</div>
          <div class="drop-hint" data-i18n="drop_audio_hint">Extract audio track as WAV</div>
          <input type="file" accept="video/*,audio/*" style="display:none" id="inputAudio">
        </div>
        <div class="file-loaded" id="fileAudio"><span class="file-loaded-icon">ğŸµ</span><span class="file-loaded-name" id="fileAudioName"></span><span class="file-loaded-size" id="fileAudioSize"></span><button class="file-loaded-remove" id="removeAudio">âœ•</button></div>
        <div class="info-box" data-i18n="audio_info">Output format: WAV (uncompressed). For MP3 conversion, use our Audio Cutter tool after extraction.</div>
        <button class="convert-btn" id="btnConvertAudio" disabled data-i18n="btn_extract">Extract Audio</button>
        <div class="progress-wrap" id="progressAudio"><div class="progress-bar"><div class="progress-fill" id="progressAudioFill"></div></div><div class="progress-text" id="progressAudioText">0%</div></div>
        <div class="result-area" id="resultAudio"><div class="result-info"><div><div class="result-meta" id="resultAudioMeta"></div><div class="result-size" id="resultAudioSize"></div></div><button class="download-btn" id="dlAudio">â¬‡ <span data-i18n="btn_download">Download</span></button></div></div>
      </div>

      <!-- ===== Panel: SVG â†’ PNG/JPG ===== -->
      <div class="panel" id="panel-svg-img">
        <div class="drop-zone" id="dropSvg">
          <div class="drop-icon">ğŸ–¼ï¸</div>
          <div class="drop-text" data-i18n="drop_svg">Drop SVG file here or click to browse</div>
          <div class="drop-hint">.svg</div>
          <input type="file" accept=".svg,image/svg+xml" style="display:none" id="inputSvg">
        </div>
        <div class="file-loaded" id="fileSvg"><span class="file-loaded-icon">ğŸ–¼ï¸</span><span class="file-loaded-name" id="fileSvgName"></span><span class="file-loaded-size" id="fileSvgSize"></span><button class="file-loaded-remove" id="removeSvg">âœ•</button></div>
        <div class="preview-area" id="previewSvg"><img id="svgPreviewImg" alt="SVG preview"></div>
        <div class="params" id="paramsSvg">
          <div class="param-group"><div class="param-label" data-i18n="p_format">Output format</div><div class="param-control"><select id="svgFormat"><option value="image/png">PNG</option><option value="image/jpeg">JPG</option></select></div></div>
          <div class="param-group"><div class="param-label" data-i18n="p_scale">Scale multiplier</div><div class="param-control"><select id="svgScale"><option value="1">1x</option><option value="2" selected>2x</option><option value="3">3x</option><option value="4">4x</option></select></div></div>
          <div class="param-group" id="svgBgGroup"><div class="param-label" data-i18n="p_bg_color">Background color (JPG)</div><div class="param-control"><input type="color" id="svgBgColor" value="#ffffff"></div></div>
        </div>
        <button class="convert-btn" id="btnConvertSvg" disabled data-i18n="btn_convert_svg">Convert SVG</button>
        <div class="result-area" id="resultSvg"><div class="result-preview"><img id="resultSvgImg" alt="Converted image"></div><div class="result-info"><div><div class="result-meta" id="resultSvgMeta"></div><div class="result-size" id="resultSvgSize"></div></div><button class="download-btn" id="dlSvg">â¬‡ <span data-i18n="btn_download">Download</span></button></div></div>
      </div>

      <!-- ===== Panel: Image â†” Base64 ===== -->
      <div class="panel" id="panel-img-b64">
        <div class="mode-toggle">
          <button class="mode-btn active" id="modeImgTo" data-i18n="mode_img_to_b64">Image â†’ Base64</button>
          <button class="mode-btn" id="modeB64To" data-i18n="mode_b64_to_img">Base64 â†’ Image</button>
        </div>

        <!-- Image â†’ Base64 -->
        <div id="imgToB64Section">
          <div class="drop-zone" id="dropB64">
            <div class="drop-icon">ğŸ”¤</div>
            <div class="drop-text" data-i18n="drop_image">Drop image file here or click to browse</div>
            <div class="drop-hint">PNG, JPG, WebP, GIF, SVG</div>
            <input type="file" accept="image/*" style="display:none" id="inputB64">
          </div>
          <div class="file-loaded" id="fileB64"><span class="file-loaded-icon">ğŸ–¼ï¸</span><span class="file-loaded-name" id="fileB64Name"></span><span class="file-loaded-size" id="fileB64Size"></span><button class="file-loaded-remove" id="removeB64">âœ•</button></div>
          <div class="preview-area" id="previewB64"><img id="b64PreviewImg" alt="Image preview"></div>
          <div style="margin-top:14px"><div class="param-label" style="margin-bottom:6px" data-i18n="b64_output">Base64 output</div><textarea class="b64-textarea" id="b64Output" readonly data-i18n-placeholder="b64_placeholder" placeholder="Base64 data URI will appear here..."></textarea></div>
          <div style="display:flex;gap:10px;margin-top:10px"><button class="copy-btn" id="copyB64" data-i18n="btn_copy">Copy to Clipboard</button></div>
        </div>

        <!-- Base64 â†’ Image -->
        <div id="b64ToImgSection" style="display:none">
          <div><div class="param-label" style="margin-bottom:6px" data-i18n="b64_input">Paste Base64 data URI</div><textarea class="b64-textarea" id="b64Input" data-i18n-placeholder="b64_input_placeholder" placeholder="Paste data:image/... string here..."></textarea></div>
          <button class="convert-btn" id="btnDecodeB64" style="margin-top:12px" data-i18n="btn_decode">Decode to Image</button>
          <div class="result-area" id="resultB64"><div class="result-preview"><img id="resultB64Img" alt="Decoded image"></div><div class="result-info"><div><div class="result-meta" id="resultB64Meta"></div></div><button class="download-btn" id="dlB64">â¬‡ <span data-i18n="btn_download">Download</span></button></div></div>
        </div>
      </div>
    </div>

    <!-- çŠ¶æ€è¡Œ -->
    <div class="status-line" id="statusLine"></div>
  </div>

  <!-- Trust Bar -->
  <div class="trust-bar anim anim-d5">
    <span class="trust-item" data-i18n="trust_users">ğŸŒ Used by 50,000+ users</span>
    <span class="trust-item" data-i18n="trust_rating">â­ 4.9/5 rating</span>
    <span class="trust-item" data-i18n="trust_privacy">ğŸ”’ 100% Private</span>
    <span class="trust-item" data-i18n="trust_free">ğŸš« No Ads, No Signup</span>
  </div>

  <!-- Features -->
  <section class="features-section anim anim-d6">
    <h2 data-i18n="features_title">Key Features</h2>
    <div class="features-grid">
      <article class="feature"><div>ğŸ”’</div><h4 data-i18n="f1_t">100% Free & Private</h4><p data-i18n="f1_d">No ads, no signup, no watermark, no upload. All conversion runs locally in your browser. Your files never leave your device.</p></article>
      <article class="feature"><div>ğŸ¬</div><h4 data-i18n="f2_t">Video to GIF Maker</h4><p data-i18n="f2_d">Turn video clips into animated GIFs with customizable frame rate, output width, time range, and quality settings.</p></article>
      <article class="feature"><div>ğŸ”Š</div><h4 data-i18n="f3_t">Audio Extraction</h4><p data-i18n="f3_d">Extract audio tracks from video files using Web Audio API. Output as WAV for maximum compatibility and quality.</p></article>
      <article class="feature"><div>ğŸ–¼ï¸</div><h4 data-i18n="f4_t">SVG & Base64 Tools</h4><p data-i18n="f4_d">Convert vector SVG to raster PNG/JPG with scale control, or encode images to Base64 data URIs for embedding.</p></article>
    </div>
  </section>

  <!-- FAQ -->
  <section class="faq-section anim anim-d7">
    <h2 data-i18n="faq_title">Frequently Asked Questions</h2>
    <div class="faq-item"><button class="faq-question" data-i18n="faq1_q">What is a cross-media file converter and what formats does it support?</button><div class="faq-answer" data-i18n="faq1_a">A cross-media file converter bridges different media types: it can turn video clips into animated GIFs, extract audio tracks from video files as WAV, convert vector SVG graphics to raster PNG or JPG images, and encode images to Base64 data URIs. This tool supports all four conversions entirely in the browser with no server upload required.</div></div>
    <div class="faq-item"><button class="faq-question" data-i18n="faq2_q">How does Video to GIF conversion work in the browser?</button><div class="faq-answer" data-i18n="faq2_a">The Video to GIF feature uses Canvas API to capture video frames at your chosen frame rate, then encodes them into an animated GIF using the gif.js library. You can control start/end time, output width, frame rate (5-20 fps), and quality level. The entire process runs locally in your browser without uploading video to any server.</div></div>
    <div class="faq-item"><button class="faq-question" data-i18n="faq3_q">Can I extract audio from video without installing software?</button><div class="faq-answer" data-i18n="faq3_a">Yes. The Video to Audio tab uses the Web Audio API to decode the video file and extract its audio track, then exports it as a WAV file. This works entirely in the browser with no FFmpeg or server-side processing needed. For MP3 conversion, you can use our Audio Cutter tool afterwards.</div></div>
    <div class="faq-item"><button class="faq-question" data-i18n="faq4_q">How do I convert SVG to PNG or JPG with high resolution?</button><div class="faq-answer" data-i18n="faq4_a">Upload your SVG file and choose PNG or JPG output format. Use the scale multiplier (1x to 4x) to control output resolution â€” 2x doubles the dimensions for crisp retina displays. For JPG output, you can also set a background color since JPG does not support transparency.</div></div>
    <div class="faq-item"><button class="faq-question" data-i18n="faq5_q">What is Base64 encoding for images and when should I use it?</button><div class="faq-answer" data-i18n="faq5_a">Base64 encoding converts an image file into a text string (data URI) that can be embedded directly in HTML or CSS. This eliminates extra HTTP requests and is useful for small icons, email templates, and inline assets. Our tool supports bidirectional conversion: image to Base64 and Base64 back to image.</div></div>
    <div class="faq-item"><button class="faq-question" data-i18n="faq_free_q">Is this tool really free with no ads?</button><div class="faq-answer" data-i18n="faq_free_a">Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All processing happens locally in your browser â€” your files are never uploaded to any server. Your privacy is fully protected.</div></div>
  </section>

  <!-- Related Tools -->
  <section class="related-tools anim anim-d7">
    <h3 data-i18n="related_title">Related Tools</h3>
    <div class="related-grid">
      <a class="related-card" href="image-converter.html"><div>ğŸ–¼ï¸</div><h4 data-i18n="r1_t">Image Converter</h4><p data-i18n="r1_d">Convert between PNG, JPG, WebP with quality control.</p></a>
      <a class="related-card" href="audio-cutter.html"><div>ğŸ§</div><h4 data-i18n="r2_t">Audio Cutter</h4><p data-i18n="r2_d">Trim audio files and convert WAV to MP3.</p></a>
      <a class="related-card" href="screen-recorder.html"><div>ğŸ“¹</div><h4 data-i18n="r3_t">Screen Recorder</h4><p data-i18n="r3_d">Record screen in browser and export HD MP4.</p></a>
      <a class="related-card" href="base64-tool.html"><div>ğŸ”¤</div><h4 data-i18n="r4_t">Base64 Tool</h4><p data-i18n="r4_d">Encode and decode text with Base64.</p></a>
    </div>
  </section>
</div>

<script>
(function(){
'use strict';

/* ========== å¤šè¯­è¨€ç³»ç»Ÿ ========== */
const i18n = {
en:{
  back:'Back to Toolbox',tool_name:'File Converter',title:'File Converter',subtitle:'Cross-media format bridge â€” Video, Image, SVG & Base64',
  step_upload:'Upload',step_convert:'Convert',step_download:'Download',
  tab_vgif:'Video â†’ GIF',tab_vaudio:'Video â†’ Audio',tab_svg:'SVG â†’ PNG/JPG',tab_b64:'Image â†” Base64',
  drop_video:'Drop video file here or click to browse',drop_video_hint:'MP4, WebM, MOV supported',
  drop_video_audio:'Drop video file here or click to browse',drop_audio_hint:'Extract audio track as WAV',
  drop_svg:'Drop SVG file here or click to browse',drop_image:'Drop image file here or click to browse',
  p_start:'Start time (s)',p_end:'End time (s)',p_fps:'Frame rate (fps)',p_width:'Output width',p_quality:'Quality',
  p_original:'Original',p_q_high:'High',p_q_medium:'Medium',p_q_low:'Low',
  p_format:'Output format',p_scale:'Scale multiplier',p_bg_color:'Background color (JPG)',
  audio_info:'Output format: WAV (uncompressed). For MP3 conversion, use our Audio Cutter tool after extraction.',
  btn_convert:'Convert to GIF',btn_extract:'Extract Audio',btn_convert_svg:'Convert SVG',btn_download:'Download',
  btn_copy:'Copy to Clipboard',btn_decode:'Decode to Image',
  mode_img_to_b64:'Image â†’ Base64',mode_b64_to_img:'Base64 â†’ Image',
  b64_output:'Base64 output',b64_placeholder:'Base64 data URI will appear here...',
  b64_input:'Paste Base64 data URI',b64_input_placeholder:'Paste data:image/... string here...',
  msg_no_file:'Please select a file first',msg_processing:'Processing...',msg_done:'Conversion complete!',
  msg_copied:'Copied!',msg_invalid_b64:'Invalid Base64 data URI',msg_gif_loading:'Loading gif.js library...',
  msg_gif_frames:'Capturing frames...',msg_gif_encoding:'Encoding GIF...',msg_decoding:'Decoding audio...',
  trust_users:'ğŸŒ Used by 50,000+ users',trust_rating:'â­ 4.9/5 rating',trust_privacy:'ğŸ”’ 100% Private',trust_free:'ğŸš« No Ads, No Signup',
  features_title:'Key Features',
  f1_t:'100% Free & Private',f1_d:'No ads, no signup, no watermark, no upload. All conversion runs locally in your browser. Your files never leave your device.',
  f2_t:'Video to GIF Maker',f2_d:'Turn video clips into animated GIFs with customizable frame rate, output width, time range, and quality settings.',
  f3_t:'Audio Extraction',f3_d:'Extract audio tracks from video files using Web Audio API. Output as WAV for maximum compatibility and quality.',
  f4_t:'SVG & Base64 Tools',f4_d:'Convert vector SVG to raster PNG/JPG with scale control, or encode images to Base64 data URIs for embedding.',
  faq_title:'Frequently Asked Questions',
  faq1_q:'What is a cross-media file converter and what formats does it support?',faq1_a:'A cross-media file converter bridges different media types: it can turn video clips into animated GIFs, extract audio tracks from video files as WAV, convert vector SVG graphics to raster PNG or JPG images, and encode images to Base64 data URIs. This tool supports all four conversions entirely in the browser with no server upload required.',
  faq2_q:'How does Video to GIF conversion work in the browser?',faq2_a:'The Video to GIF feature uses Canvas API to capture video frames at your chosen frame rate, then encodes them into an animated GIF using the gif.js library. You can control start/end time, output width, frame rate (5-20 fps), and quality level. The entire process runs locally in your browser without uploading video to any server.',
  faq3_q:'Can I extract audio from video without installing software?',faq3_a:'Yes. The Video to Audio tab uses the Web Audio API to decode the video file and extract its audio track, then exports it as a WAV file. This works entirely in the browser with no FFmpeg or server-side processing needed. For MP3 conversion, you can use our Audio Cutter tool afterwards.',
  faq4_q:'How do I convert SVG to PNG or JPG with high resolution?',faq4_a:'Upload your SVG file and choose PNG or JPG output format. Use the scale multiplier (1x to 4x) to control output resolution â€” 2x doubles the dimensions for crisp retina displays. For JPG output, you can also set a background color since JPG does not support transparency.',
  faq5_q:'What is Base64 encoding for images and when should I use it?',faq5_a:'Base64 encoding converts an image file into a text string (data URI) that can be embedded directly in HTML or CSS. This eliminates extra HTTP requests and is useful for small icons, email templates, and inline assets. Our tool supports bidirectional conversion: image to Base64 and Base64 back to image.',
  faq_free_q:'Is this tool really free with no ads?',faq_free_a:'Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All processing happens locally in your browser â€” your files are never uploaded to any server. Your privacy is fully protected.',
  related_title:'Related Tools',
  r1_t:'Image Converter',r1_d:'Convert between PNG, JPG, WebP with quality control.',
  r2_t:'Audio Cutter',r2_d:'Trim audio files and convert WAV to MP3.',
  r3_t:'Screen Recorder',r3_d:'Record screen in browser and export HD MP4.',
  r4_t:'Base64 Tool',r4_d:'Encode and decode text with Base64.'
},
'zh-CN':{
  back:'è¿”å›å·¥å…·ç®±',tool_name:'æ–‡ä»¶æ ¼å¼è½¬æ¢',title:'æ–‡ä»¶æ ¼å¼è½¬æ¢',subtitle:'è·¨åª’ä½“æ ¼å¼æ¡¥æ¢ â€” è§†é¢‘ã€å›¾ç‰‡ã€SVG ä¸ Base64',
  step_upload:'ä¸Šä¼ ',step_convert:'è½¬æ¢',step_download:'ä¸‹è½½',
  tab_vgif:'è§†é¢‘ â†’ GIF',tab_vaudio:'è§†é¢‘ â†’ éŸ³é¢‘',tab_svg:'SVG â†’ PNG/JPG',tab_b64:'å›¾ç‰‡ â†” Base64',
  drop_video:'å°†è§†é¢‘æ–‡ä»¶æ‹–æ”¾åˆ°æ­¤å¤„ï¼Œæˆ–ç‚¹å‡»æµè§ˆ',drop_video_hint:'æ”¯æŒ MP4ã€WebMã€MOV',
  drop_video_audio:'å°†è§†é¢‘æ–‡ä»¶æ‹–æ”¾åˆ°æ­¤å¤„ï¼Œæˆ–ç‚¹å‡»æµè§ˆ',drop_audio_hint:'æå–éŸ³é¢‘è½¨é“ä¸º WAV',
  drop_svg:'å°† SVG æ–‡ä»¶æ‹–æ”¾åˆ°æ­¤å¤„ï¼Œæˆ–ç‚¹å‡»æµè§ˆ',drop_image:'å°†å›¾ç‰‡æ–‡ä»¶æ‹–æ”¾åˆ°æ­¤å¤„ï¼Œæˆ–ç‚¹å‡»æµè§ˆ',
  p_start:'èµ·å§‹æ—¶é—´ï¼ˆç§’ï¼‰',p_end:'ç»“æŸæ—¶é—´ï¼ˆç§’ï¼‰',p_fps:'å¸§ç‡ï¼ˆfpsï¼‰',p_width:'è¾“å‡ºå®½åº¦',p_quality:'è´¨é‡',
  p_original:'åŸå§‹å°ºå¯¸',p_q_high:'é«˜',p_q_medium:'ä¸­',p_q_low:'ä½',
  p_format:'è¾“å‡ºæ ¼å¼',p_scale:'ç¼©æ”¾å€æ•°',p_bg_color:'èƒŒæ™¯è‰²ï¼ˆJPGï¼‰',
  audio_info:'è¾“å‡ºæ ¼å¼ï¼šWAVï¼ˆæ— æŸï¼‰ã€‚å¦‚éœ€è½¬ MP3ï¼Œæå–åå¯ä½¿ç”¨ã€ŒéŸ³é¢‘å‰ªè¾‘ã€å·¥å…·ã€‚',
  btn_convert:'è½¬æ¢ä¸º GIF',btn_extract:'æå–éŸ³é¢‘',btn_convert_svg:'è½¬æ¢ SVG',btn_download:'ä¸‹è½½',
  btn_copy:'å¤åˆ¶åˆ°å‰ªè´´æ¿',btn_decode:'è§£ç ä¸ºå›¾ç‰‡',
  mode_img_to_b64:'å›¾ç‰‡ â†’ Base64',mode_b64_to_img:'Base64 â†’ å›¾ç‰‡',
  b64_output:'Base64 è¾“å‡º',b64_placeholder:'Base64 data URI å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...',
  b64_input:'ç²˜è´´ Base64 data URI',b64_input_placeholder:'åœ¨æ­¤ç²˜è´´ data:image/... å­—ç¬¦ä¸²...',
  msg_no_file:'è¯·å…ˆé€‰æ‹©æ–‡ä»¶',msg_processing:'å¤„ç†ä¸­...',msg_done:'è½¬æ¢å®Œæˆï¼',
  msg_copied:'å·²å¤åˆ¶ï¼',msg_invalid_b64:'æ— æ•ˆçš„ Base64 æ•°æ® URI',msg_gif_loading:'åŠ è½½ gif.js åº“...',
  msg_gif_frames:'æ­£åœ¨æŠ“å–å¸§...',msg_gif_encoding:'æ­£åœ¨ç¼–ç  GIF...',msg_decoding:'æ­£åœ¨è§£ç éŸ³é¢‘...',
  trust_users:'ğŸŒ è¶…è¿‡ 50,000 ç”¨æˆ·ä½¿ç”¨',trust_rating:'â­ 4.9/5 å¥½è¯„',trust_privacy:'ğŸ”’ 100% éšç§å®‰å…¨',trust_free:'ğŸš« æ— å¹¿å‘Šã€æ— éœ€æ³¨å†Œ',
  features_title:'åŠŸèƒ½ç‰¹ç‚¹',
  f1_t:'100% å…è´¹ä¸”å®‰å…¨',f1_d:'æ— å¹¿å‘Šã€æ— éœ€æ³¨å†Œã€æ— æ°´å°ã€æ— éœ€ä¸Šä¼ ã€‚æ‰€æœ‰è½¬æ¢åœ¨æµè§ˆå™¨æœ¬åœ°æ‰§è¡Œï¼Œæ–‡ä»¶ä¸ä¼šç¦»å¼€ä½ çš„è®¾å¤‡ã€‚',
  f2_t:'è§†é¢‘è½¬ GIF',f2_d:'å°†è§†é¢‘ç‰‡æ®µè½¬ä¸ºåŠ¨å›¾ï¼Œå¯è‡ªå®šä¹‰å¸§ç‡ã€è¾“å‡ºå®½åº¦ã€æ—¶é—´èŒƒå›´å’Œè´¨é‡ã€‚',
  f3_t:'éŸ³é¢‘æå–',f3_d:'ä½¿ç”¨ Web Audio API ä»è§†é¢‘ä¸­æå–éŸ³è½¨ï¼Œè¾“å‡ºä¸º WAV æ ¼å¼ä»¥ä¿è¯æœ€å¤§å…¼å®¹æ€§å’Œè´¨é‡ã€‚',
  f4_t:'SVG ä¸ Base64 å·¥å…·',f4_d:'å°†çŸ¢é‡ SVG è½¬æ¢ä¸º PNG/JPG ä½å›¾å¹¶æ”¯æŒç¼©æ”¾æ§åˆ¶ï¼Œæˆ–å°†å›¾ç‰‡ç¼–ç ä¸º Base64 åµŒå…¥ä»£ç ã€‚',
  faq_title:'å¸¸è§é—®é¢˜',
  faq1_q:'ä»€ä¹ˆæ˜¯è·¨åª’ä½“æ–‡ä»¶è½¬æ¢å™¨ï¼Ÿæ”¯æŒå“ªäº›æ ¼å¼ï¼Ÿ',faq1_a:'è·¨åª’ä½“æ–‡ä»¶è½¬æ¢å™¨æ˜¯è¿æ¥ä¸åŒåª’ä½“ç±»å‹çš„æ¡¥æ¢ï¼šå¯ä»¥å°†è§†é¢‘ç‰‡æ®µè½¬æ¢ä¸ºåŠ¨ç”» GIFï¼Œä»è§†é¢‘ä¸­æå–éŸ³é¢‘è½¨é“ä¸º WAVï¼Œå°†çŸ¢é‡ SVG è½¬æ¢ä¸º PNG æˆ– JPG ä½å›¾ï¼Œä»¥åŠå°†å›¾ç‰‡ç¼–ç ä¸º Base64 æ•°æ® URIã€‚æœ¬å·¥å…·å®Œå…¨åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œæ— éœ€ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨ã€‚',
  faq2_q:'æµè§ˆå™¨ä¸­è§†é¢‘è½¬ GIF æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ',faq2_a:'è§†é¢‘è½¬ GIF åŠŸèƒ½ä½¿ç”¨ Canvas API æŒ‰ç…§ä½ é€‰æ‹©çš„å¸§ç‡æŠ“å–è§†é¢‘å¸§ï¼Œç„¶åé€šè¿‡ gif.js åº“ç¼–ç ä¸ºåŠ¨ç”» GIFã€‚ä½ å¯ä»¥æ§åˆ¶èµ·æ­¢æ—¶é—´ã€è¾“å‡ºå®½åº¦ã€å¸§ç‡ï¼ˆ5-20 fpsï¼‰å’Œè´¨é‡çº§åˆ«ã€‚æ•´ä¸ªè¿‡ç¨‹åœ¨æµè§ˆå™¨æœ¬åœ°è¿è¡Œï¼Œä¸ä¼šå°†è§†é¢‘ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚',
  faq3_q:'ä¸å®‰è£…è½¯ä»¶å¯ä»¥ä»è§†é¢‘ä¸­æå–éŸ³é¢‘å—ï¼Ÿ',faq3_a:'å¯ä»¥ã€‚è§†é¢‘è½¬éŸ³é¢‘åŠŸèƒ½ä½¿ç”¨ Web Audio API è§£ç è§†é¢‘æ–‡ä»¶å¹¶æå–éŸ³è½¨ï¼Œç„¶åå¯¼å‡ºä¸º WAV æ–‡ä»¶ã€‚å®Œå…¨åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œæ— éœ€ FFmpeg æˆ–æœåŠ¡å™¨å¤„ç†ã€‚å¦‚éœ€è½¬ MP3ï¼Œå¯ä»¥åç»­ä½¿ç”¨æˆ‘ä»¬çš„éŸ³é¢‘å‰ªè¾‘å·¥å…·ã€‚',
  faq4_q:'å¦‚ä½•å°† SVG è½¬æ¢ä¸ºé«˜åˆ†è¾¨ç‡çš„ PNG æˆ– JPGï¼Ÿ',faq4_a:'ä¸Šä¼  SVG æ–‡ä»¶åé€‰æ‹© PNG æˆ– JPG è¾“å‡ºæ ¼å¼ã€‚ä½¿ç”¨ç¼©æ”¾å€æ•°ï¼ˆ1x åˆ° 4xï¼‰æ§åˆ¶è¾“å‡ºåˆ†è¾¨ç‡â€”â€”2x å¯å°†å°ºå¯¸ç¿»å€ä»¥è·å¾—æ¸…æ™°çš„è§†ç½‘è†œæ˜¾ç¤ºæ•ˆæœã€‚å¯¹äº JPG è¾“å‡ºï¼Œè¿˜å¯ä»¥è®¾ç½®èƒŒæ™¯è‰²ï¼Œå› ä¸º JPG ä¸æ”¯æŒé€æ˜åº¦ã€‚',
  faq5_q:'ä»€ä¹ˆæ˜¯å›¾ç‰‡ Base64 ç¼–ç ï¼Ÿä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨å®ƒï¼Ÿ',faq5_a:'Base64 ç¼–ç å°†å›¾ç‰‡æ–‡ä»¶è½¬æ¢ä¸ºæ–‡æœ¬å­—ç¬¦ä¸²ï¼ˆdata URIï¼‰ï¼Œå¯ä»¥ç›´æ¥åµŒå…¥åˆ° HTML æˆ– CSS ä¸­ã€‚è¿™æ¶ˆé™¤äº†é¢å¤–çš„ HTTP è¯·æ±‚ï¼Œé€‚ç”¨äºå°å›¾æ ‡ã€é‚®ä»¶æ¨¡æ¿å’Œå†…è”èµ„æºã€‚æœ¬å·¥å…·æ”¯æŒåŒå‘è½¬æ¢ï¼šå›¾ç‰‡è½¬ Base64 å’Œ Base64 è½¬å›¾ç‰‡ã€‚',
  faq_free_q:'è¿™ä¸ªå·¥å…·çœŸçš„å…è´¹ä¸”æ— å¹¿å‘Šå—ï¼Ÿ',faq_free_a:'æ˜¯çš„ï¼Œ100% å…è´¹ï¼Œæ— å¹¿å‘Šã€æ— éœ€æ³¨å†Œã€æ— æ°´å°ã€æ— é™åˆ¶ã€‚æ‰€æœ‰å¤„ç†éƒ½åœ¨æµè§ˆå™¨æœ¬åœ°å®Œæˆï¼Œä½ çš„æ–‡ä»¶ä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨ã€‚ä½ çš„éšç§å¾—åˆ°å®Œå…¨ä¿æŠ¤ã€‚',
  related_title:'ç›¸å…³å·¥å…·',
  r1_t:'å›¾ç‰‡è½¬æ¢å™¨',r1_d:'PNGã€JPGã€WebP äº’è½¬ï¼Œæ”¯æŒè´¨é‡æ§åˆ¶ã€‚',
  r2_t:'éŸ³é¢‘å‰ªè¾‘',r2_d:'è£å‰ªéŸ³é¢‘æ–‡ä»¶ï¼ŒWAV è½¬ MP3ã€‚',
  r3_t:'åœ¨çº¿å½•å±',r3_d:'æµè§ˆå™¨å½•å±å¹¶å¯¼å‡ºé«˜æ¸… MP4ã€‚',
  r4_t:'Base64 å·¥å…·',r4_d:'æ–‡æœ¬ Base64 ç¼–ç ä¸è§£ç ã€‚'
},
fr:{
  back:'Retour Ã  la boÃ®te Ã  outils',tool_name:'Convertisseur de fichiers',title:'Convertisseur de fichiers',subtitle:'Pont de formats cross-mÃ©dia â€” VidÃ©o, Image, SVG & Base64',
  step_upload:'TÃ©lÃ©verser',step_convert:'Convertir',step_download:'TÃ©lÃ©charger',
  tab_vgif:'VidÃ©o â†’ GIF',tab_vaudio:'VidÃ©o â†’ Audio',tab_svg:'SVG â†’ PNG/JPG',tab_b64:'Image â†” Base64',
  drop_video:'DÃ©posez le fichier vidÃ©o ici ou cliquez pour parcourir',drop_video_hint:'MP4, WebM, MOV supportÃ©s',
  drop_video_audio:'DÃ©posez le fichier vidÃ©o ici ou cliquez pour parcourir',drop_audio_hint:'Extraire la piste audio en WAV',
  drop_svg:'DÃ©posez le fichier SVG ici ou cliquez pour parcourir',drop_image:'DÃ©posez le fichier image ici ou cliquez pour parcourir',
  p_start:'DÃ©but (s)',p_end:'Fin (s)',p_fps:'Images/sec (fps)',p_width:'Largeur sortie',p_quality:'QualitÃ©',
  p_original:'Originale',p_q_high:'Haute',p_q_medium:'Moyenne',p_q_low:'Basse',
  p_format:'Format de sortie',p_scale:'Facteur d\'Ã©chelle',p_bg_color:'Couleur de fond (JPG)',
  audio_info:'Format de sortie : WAV (non compressÃ©). Pour convertir en MP3, utilisez notre outil Ã‰diteur Audio aprÃ¨s extraction.',
  btn_convert:'Convertir en GIF',btn_extract:'Extraire l\'audio',btn_convert_svg:'Convertir SVG',btn_download:'TÃ©lÃ©charger',
  btn_copy:'Copier dans le presse-papier',btn_decode:'DÃ©coder en image',
  mode_img_to_b64:'Image â†’ Base64',mode_b64_to_img:'Base64 â†’ Image',
  b64_output:'Sortie Base64',b64_placeholder:'L\'URI de donnÃ©es Base64 apparaÃ®tra ici...',
  b64_input:'Collez l\'URI de donnÃ©es Base64',b64_input_placeholder:'Collez la chaÃ®ne data:image/... ici...',
  msg_no_file:'Veuillez sÃ©lectionner un fichier',msg_processing:'Traitement...',msg_done:'Conversion terminÃ©e !',
  msg_copied:'CopiÃ© !',msg_invalid_b64:'URI de donnÃ©es Base64 invalide',msg_gif_loading:'Chargement de la bibliothÃ¨que gif.js...',
  msg_gif_frames:'Capture des images...',msg_gif_encoding:'Encodage du GIF...',msg_decoding:'DÃ©codage audio...',
  trust_users:'ğŸŒ UtilisÃ© par 50 000+ utilisateurs',trust_rating:'â­ Note 4.9/5',trust_privacy:'ğŸ”’ 100% PrivÃ©',trust_free:'ğŸš« Sans pub, sans inscription',
  features_title:'CaractÃ©ristiques',
  f1_t:'100% Gratuit et PrivÃ©',f1_d:'Sans pub, sans inscription, sans filigrane, sans tÃ©lÃ©versement. Toute conversion s\'exÃ©cute localement dans votre navigateur.',
  f2_t:'VidÃ©o vers GIF',f2_d:'Transformez des clips vidÃ©o en GIF animÃ©s avec contrÃ´le de frÃ©quence d\'images, largeur, durÃ©e et qualitÃ©.',
  f3_t:'Extraction audio',f3_d:'Extrayez les pistes audio des fichiers vidÃ©o via Web Audio API. Sortie en WAV pour une compatibilitÃ© maximale.',
  f4_t:'Outils SVG & Base64',f4_d:'Convertissez SVG vectoriel en PNG/JPG avec contrÃ´le d\'Ã©chelle, ou encodez des images en URI Base64.',
  faq_title:'Questions frÃ©quentes',
  faq1_q:'Qu\'est-ce qu\'un convertisseur cross-mÃ©dia et quels formats supporte-t-il ?',faq1_a:'Un convertisseur cross-mÃ©dia fait le pont entre diffÃ©rents types de mÃ©dias : il transforme des clips vidÃ©o en GIF animÃ©s, extrait des pistes audio en WAV, convertit des SVG vectoriels en PNG ou JPG, et encode des images en URI Base64. Cet outil fonctionne entiÃ¨rement dans le navigateur sans tÃ©lÃ©versement.',
  faq2_q:'Comment fonctionne la conversion VidÃ©o vers GIF dans le navigateur ?',faq2_a:'La fonctionnalitÃ© utilise l\'API Canvas pour capturer les images vidÃ©o puis les encode en GIF animÃ© via la bibliothÃ¨que gif.js. Vous contrÃ´lez le temps, la largeur, la frÃ©quence (5-20 fps) et la qualitÃ©. Tout se passe localement dans votre navigateur.',
  faq3_q:'Puis-je extraire l\'audio d\'une vidÃ©o sans installer de logiciel ?',faq3_a:'Oui. L\'onglet VidÃ©o vers Audio utilise Web Audio API pour dÃ©coder et exporter la piste audio en WAV. Aucun FFmpeg ni traitement serveur nÃ©cessaire. Utilisez ensuite notre Ã‰diteur Audio pour convertir en MP3.',
  faq4_q:'Comment convertir un SVG en PNG ou JPG haute rÃ©solution ?',faq4_a:'TÃ©lÃ©versez votre SVG et choisissez le format. Le multiplicateur d\'Ã©chelle (1x Ã  4x) contrÃ´le la rÃ©solution â€” 2x double les dimensions pour les Ã©crans Retina. Pour JPG, dÃ©finissez une couleur de fond car JPG ne supporte pas la transparence.',
  faq5_q:'Qu\'est-ce que l\'encodage Base64 des images et quand l\'utiliser ?',faq5_a:'L\'encodage Base64 convertit une image en chaÃ®ne de texte (data URI) intÃ©grable dans HTML ou CSS. Utile pour les petites icÃ´nes, modÃ¨les d\'email et assets inline. Notre outil supporte la conversion bidirectionnelle.',
  faq_free_q:'Cet outil est-il vraiment gratuit et sans pub ?',faq_free_a:'Oui, 100% gratuit, sans publicitÃ©, sans inscription, sans filigrane et sans limites. Tout est traitÃ© localement dans votre navigateur â€” vos fichiers ne sont jamais tÃ©lÃ©versÃ©s.',
  related_title:'Outils associÃ©s',
  r1_t:'Convertisseur d\'images',r1_d:'Convertir PNG, JPG, WebP avec contrÃ´le qualitÃ©.',
  r2_t:'Ã‰diteur audio',r2_d:'DÃ©couper les fichiers audio, convertir WAV en MP3.',
  r3_t:'Enregistreur d\'Ã©cran',r3_d:'Enregistrer l\'Ã©cran et exporter en MP4 HD.',
  r4_t:'Outil Base64',r4_d:'Encoder et dÃ©coder du texte en Base64.'
},
es:{
  back:'Volver a la caja de herramientas',tool_name:'Convertidor de archivos',title:'Convertidor de archivos',subtitle:'Puente de formatos multimedia â€” Video, Imagen, SVG y Base64',
  step_upload:'Subir',step_convert:'Convertir',step_download:'Descargar',
  tab_vgif:'Video â†’ GIF',tab_vaudio:'Video â†’ Audio',tab_svg:'SVG â†’ PNG/JPG',tab_b64:'Imagen â†” Base64',
  drop_video:'Arrastra el archivo de video aquÃ­ o haz clic para explorar',drop_video_hint:'MP4, WebM, MOV compatibles',
  drop_video_audio:'Arrastra el archivo de video aquÃ­ o haz clic para explorar',drop_audio_hint:'Extraer pista de audio como WAV',
  drop_svg:'Arrastra el archivo SVG aquÃ­ o haz clic para explorar',drop_image:'Arrastra el archivo de imagen aquÃ­ o haz clic para explorar',
  p_start:'Tiempo inicio (s)',p_end:'Tiempo fin (s)',p_fps:'Fotogramas/seg (fps)',p_width:'Ancho de salida',p_quality:'Calidad',
  p_original:'Original',p_q_high:'Alta',p_q_medium:'Media',p_q_low:'Baja',
  p_format:'Formato de salida',p_scale:'Multiplicador de escala',p_bg_color:'Color de fondo (JPG)',
  audio_info:'Formato de salida: WAV (sin comprimir). Para convertir a MP3, usa nuestra herramienta Editor de Audio despuÃ©s de la extracciÃ³n.',
  btn_convert:'Convertir a GIF',btn_extract:'Extraer audio',btn_convert_svg:'Convertir SVG',btn_download:'Descargar',
  btn_copy:'Copiar al portapapeles',btn_decode:'Decodificar a imagen',
  mode_img_to_b64:'Imagen â†’ Base64',mode_b64_to_img:'Base64 â†’ Imagen',
  b64_output:'Salida Base64',b64_placeholder:'El URI de datos Base64 aparecerÃ¡ aquÃ­...',
  b64_input:'Pegar URI de datos Base64',b64_input_placeholder:'Pega la cadena data:image/... aquÃ­...',
  msg_no_file:'Por favor selecciona un archivo primero',msg_processing:'Procesando...',msg_done:'Â¡ConversiÃ³n completada!',
  msg_copied:'Â¡Copiado!',msg_invalid_b64:'URI de datos Base64 invÃ¡lido',msg_gif_loading:'Cargando biblioteca gif.js...',
  msg_gif_frames:'Capturando fotogramas...',msg_gif_encoding:'Codificando GIF...',msg_decoding:'Decodificando audio...',
  trust_users:'ğŸŒ Usado por mÃ¡s de 50,000 usuarios',trust_rating:'â­ CalificaciÃ³n 4.9/5',trust_privacy:'ğŸ”’ 100% Privado',trust_free:'ğŸš« Sin anuncios, sin registro',
  features_title:'CaracterÃ­sticas',
  f1_t:'100% Gratis y Privado',f1_d:'Sin anuncios, sin registro, sin marca de agua, sin subir archivos. Toda la conversiÃ³n se ejecuta localmente en tu navegador.',
  f2_t:'Video a GIF',f2_d:'Convierte clips de video en GIFs animados con control de fotogramas, ancho, rango de tiempo y calidad.',
  f3_t:'ExtracciÃ³n de audio',f3_d:'Extrae pistas de audio de archivos de video usando Web Audio API. Salida en WAV para mÃ¡xima compatibilidad.',
  f4_t:'Herramientas SVG y Base64',f4_d:'Convierte SVG vectorial a PNG/JPG con control de escala, o codifica imÃ¡genes a URI Base64 para incrustar.',
  faq_title:'Preguntas frecuentes',
  faq1_q:'Â¿QuÃ© es un convertidor de archivos multimedia y quÃ© formatos soporta?',faq1_a:'Un convertidor multimedia conecta diferentes tipos de medios: convierte clips de video en GIFs animados, extrae pistas de audio en WAV, convierte SVG vectoriales a PNG o JPG, y codifica imÃ¡genes a URI Base64. Esta herramienta funciona completamente en el navegador sin subir archivos.',
  faq2_q:'Â¿CÃ³mo funciona la conversiÃ³n de Video a GIF en el navegador?',faq2_a:'La funciÃ³n usa Canvas API para capturar fotogramas de video y los codifica en GIF animado con gif.js. Puedes controlar tiempo, ancho, fotogramas (5-20 fps) y calidad. Todo se procesa localmente en tu navegador.',
  faq3_q:'Â¿Puedo extraer audio de video sin instalar software?',faq3_a:'SÃ­. La pestaÃ±a Video a Audio usa Web Audio API para decodificar y exportar la pista de audio como WAV. Funciona en el navegador sin FFmpeg ni procesamiento en servidor. Luego usa nuestro Editor de Audio para convertir a MP3.',
  faq4_q:'Â¿CÃ³mo convierto SVG a PNG o JPG en alta resoluciÃ³n?',faq4_a:'Sube tu archivo SVG y elige el formato. El multiplicador de escala (1x a 4x) controla la resoluciÃ³n â€” 2x duplica las dimensiones para pantallas Retina. Para JPG, tambiÃ©n puedes configurar un color de fondo ya que JPG no soporta transparencia.',
  faq5_q:'Â¿QuÃ© es la codificaciÃ³n Base64 de imÃ¡genes y cuÃ¡ndo debo usarla?',faq5_a:'La codificaciÃ³n Base64 convierte un archivo de imagen en una cadena de texto (data URI) que puede incrustarse directamente en HTML o CSS. Elimina solicitudes HTTP adicionales y es Ãºtil para iconos pequeÃ±os, plantillas de correo y recursos inline. Nuestra herramienta soporta conversiÃ³n bidireccional.',
  faq_free_q:'Â¿Esta herramienta es realmente gratis y sin anuncios?',faq_free_a:'SÃ­, 100% gratis, sin anuncios, sin registro, sin marca de agua y sin lÃ­mites. Todo el procesamiento ocurre localmente en tu navegador â€” tus archivos nunca se suben a ningÃºn servidor.',
  related_title:'Herramientas relacionadas',
  r1_t:'Convertidor de imÃ¡genes',r1_d:'Convertir PNG, JPG, WebP con control de calidad.',
  r2_t:'Editor de audio',r2_d:'Recortar archivos de audio, convertir WAV a MP3.',
  r3_t:'Grabador de pantalla',r3_d:'Grabar pantalla y exportar MP4 HD.',
  r4_t:'Herramienta Base64',r4_d:'Codificar y decodificar texto en Base64.'
}
};
const $ = (id) => document.getElementById(id);

function t(k) { var lang = (typeof WebToolbox !== 'undefined') ? WebToolbox.getCurrentLang() : 'en'; return (i18n[lang] || i18n.en)[k] || i18n.en[k] || k; }

function setStatus(msg) { $('statusLine').textContent = msg || ''; }


function formatSize(bytes) {
  if (bytes < 1024) return bytes + ' B';
  if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
  return (bytes / (1024 * 1024)).toFixed(2) + ' MB';
}

/* ========== æ­¥éª¤æŒ‡ç¤ºå™¨ ========== */
function setStep(n) {
  ['step1','step2','step3'].forEach((id, i) => {
    const el = $(id);
    el.className = 'step' + (i + 1 === n ? ' active' : (i + 1 < n ? ' done' : ''));
  });
  $('stepLine1').className = 'step-line' + (n > 1 ? ' done' : '');
  $('stepLine2').className = 'step-line' + (n > 2 ? ' done' : '');
  $('mainCard').classList.toggle('state-done', n === 3);
}

/* ========== Tab åˆ‡æ¢ ========== */
const tabs = document.querySelectorAll('.tab');
const panels = document.querySelectorAll('.panel');
tabs.forEach(tab => {
  tab.addEventListener('click', () => {
    tabs.forEach(t => t.classList.remove('active'));
    panels.forEach(p => p.classList.remove('active'));
    tab.classList.add('active');
    $('panel-' + tab.dataset.tab).classList.add('active');
    setStep(1);
    setStatus('');
  });
});

/* ========== æ‹–æ‹½ä¸Šä¼ é€šç”¨é€»è¾‘ ========== */
function setupDropZone(dropId, inputId, fileInfoId, nameId, sizeId, removeId, accept, onFile) {
  const drop = $(dropId), input = $(inputId), info = $(fileInfoId);
  const nameEl = $(nameId), sizeEl = $(sizeId), removeBtn = $(removeId);

  drop.addEventListener('click', () => input.click());
  drop.addEventListener('dragover', e => { e.preventDefault(); drop.classList.add('dragover'); });
  drop.addEventListener('dragleave', () => drop.classList.remove('dragover'));
  drop.addEventListener('drop', e => {
    e.preventDefault(); drop.classList.remove('dragover');
    const file = e.dataTransfer.files[0];
    if (file) handleFile(file);
  });
  input.addEventListener('change', e => {
    if (e.target.files[0]) handleFile(e.target.files[0]);
  });
  removeBtn.addEventListener('click', () => {
    info.classList.remove('show');
    drop.style.display = '';
    input.value = '';
    onFile(null);
    setStep(1);
    setStatus('');
  });

  function handleFile(file) {
    nameEl.textContent = file.name;
    sizeEl.textContent = formatSize(file.size);
    info.classList.add('show');
    drop.style.display = 'none';
    setStep(2);
    onFile(file);
  }
}

/* ========== 1. Video â†’ GIF ========== */
let gifFile = null;
setupDropZone('dropGif','inputGif','fileGif','fileGifName','fileGifSize','removeGif','video/*', file => {
  gifFile = file;
  $('btnConvertGif').disabled = !file;
  const preview = $('previewGif');
  if (file) {
    const url = URL.createObjectURL(file);
    $('videoGif').src = url;
    preview.classList.add('show');
    $('videoGif').onloadedmetadata = () => {
      $('gifEnd').value = Math.min(3, $('videoGif').duration).toFixed(1);
      $('gifEnd').max = $('videoGif').duration;
    };
  } else {
    preview.classList.remove('show');
    $('videoGif').src = '';
    $('resultGif').classList.remove('show');
    $('progressGif').classList.remove('show');
  }
});

let gifWorkerUrl = null;

$('btnConvertGif').addEventListener('click', async () => {
  if (!gifFile) return setStatus(t('msg_no_file'));
  $('btnConvertGif').disabled = true;
  $('progressGif').classList.add('show');
  $('resultGif').classList.remove('show');
  setStatus(t('msg_gif_loading'));

  try {
    // åŠ è½½ gif.jsï¼ˆé€šè¿‡ Blob URL è§„é¿ CORS Worker é™åˆ¶ï¼‰
    if (!window.GIF) {
      const script = document.createElement('script');
      script.src = 'https://cdn.jsdelivr.net/npm/gif.js@0.2.0/dist/gif.js';
      await new Promise((resolve, reject) => { script.onload = resolve; script.onerror = reject; document.head.appendChild(script); });
    }
    if (!gifWorkerUrl) {
      const workerBlob = await fetch('https://cdn.jsdelivr.net/npm/gif.js@0.2.0/dist/gif.worker.js').then(r => r.blob());
      gifWorkerUrl = URL.createObjectURL(workerBlob);
    }

    setStatus(t('msg_gif_frames'));
    const video = $('videoGif');
    const start = parseFloat($('gifStart').value) || 0;
    const end = parseFloat($('gifEnd').value) || 3;
    const fps = parseInt($('gifFps').value) || 10;
    const targetWidth = parseInt($('gifWidth').value) || 0;
    const quality = parseInt($('gifQuality').value) || 5;
    const duration = end - start;
    const totalFrames = Math.floor(duration * fps);
    const delay = 1000 / fps;

    const w = targetWidth || video.videoWidth;
    const h = targetWidth ? Math.round(video.videoHeight * (targetWidth / video.videoWidth)) : video.videoHeight;

    const canvas = document.createElement('canvas');
    canvas.width = w; canvas.height = h;
    const ctx = canvas.getContext('2d');

    const gif = new GIF({ workers: 2, quality: quality, width: w, height: h, workerScript: gifWorkerUrl });

    // é€å¸§æŠ“å–
    for (let i = 0; i < totalFrames; i++) {
      const time = start + i / fps;
      video.currentTime = time;
      await new Promise(r => { video.onseeked = r; });
      ctx.drawImage(video, 0, 0, w, h);
      gif.addFrame(ctx, { copy: true, delay: delay });
      const pct = Math.round(((i + 1) / totalFrames) * 60);
      $('progressGifFill').style.width = pct + '%';
      $('progressGifText').textContent = pct + '%';
    }

    setStatus(t('msg_gif_encoding'));
    const blob = await new Promise((resolve, reject) => {
      gif.on('finished', resolve);
      gif.on('progress', p => {
        const pct = 60 + Math.round(p * 40);
        $('progressGifFill').style.width = pct + '%';
        $('progressGifText').textContent = pct + '%';
      });
      gif.render();
    });

    const url = URL.createObjectURL(blob);
    $('resultGifImg').src = url;
    $('resultGifMeta').textContent = w + ' Ã— ' + h + ' px, ' + totalFrames + ' frames';
    $('resultGifSize').textContent = formatSize(blob.size);
    $('resultGif').classList.add('show');
    $('progressGifFill').style.width = '100%';
    $('progressGifText').textContent = '100%';
    setStep(3);
    setStatus(t('msg_done'));

    $('dlGif').onclick = () => {
      const a = document.createElement('a');
      a.href = url;
      a.download = gifFile.name.replace(/\.[^.]+$/, '') + '.gif';
      a.click();
    };
  } catch (err) {
    setStatus('Error: ' + err.message);
  }
  $('btnConvertGif').disabled = false;
});

/* ========== 2. Video â†’ Audio (WAV) ========== */
let audioFile = null;
setupDropZone('dropAudio','inputAudio','fileAudio','fileAudioName','fileAudioSize','removeAudio','video/*,audio/*', file => {
  audioFile = file;
  $('btnConvertAudio').disabled = !file;
  $('resultAudio').classList.remove('show');
  $('progressAudio').classList.remove('show');
});

$('btnConvertAudio').addEventListener('click', async () => {
  if (!audioFile) return setStatus(t('msg_no_file'));
  $('btnConvertAudio').disabled = true;
  $('progressAudio').classList.add('show');
  $('resultAudio').classList.remove('show');
  setStatus(t('msg_decoding'));
  $('progressAudioFill').style.width = '30%';
  $('progressAudioText').textContent = '30%';

  try {
    const arrayBuffer = await audioFile.arrayBuffer();
    $('progressAudioFill').style.width = '50%';
    $('progressAudioText').textContent = '50%';

    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const audioBuffer = await audioCtx.decodeAudioData(arrayBuffer);
    $('progressAudioFill').style.width = '70%';
    $('progressAudioText').textContent = '70%';

    // ç¼–ç ä¸º WAV
    const numChannels = audioBuffer.numberOfChannels;
    const sampleRate = audioBuffer.sampleRate;
    const length = audioBuffer.length;
    const wavBuffer = new ArrayBuffer(44 + length * numChannels * 2);
    const view = new DataView(wavBuffer);

    function writeString(offset, str) {
      for (let i = 0; i < str.length; i++) view.setUint8(offset + i, str.charCodeAt(i));
    }

    writeString(0, 'RIFF');
    view.setUint32(4, 36 + length * numChannels * 2, true);
    writeString(8, 'WAVE');
    writeString(12, 'fmt ');
    view.setUint32(16, 16, true);
    view.setUint16(20, 1, true);
    view.setUint16(22, numChannels, true);
    view.setUint32(24, sampleRate, true);
    view.setUint32(28, sampleRate * numChannels * 2, true);
    view.setUint16(32, numChannels * 2, true);
    view.setUint16(34, 16, true);
    writeString(36, 'data');
    view.setUint32(40, length * numChannels * 2, true);

    // äº¤é”™å£°é“æ•°æ®
    const channels = [];
    for (let ch = 0; ch < numChannels; ch++) {
      channels.push(audioBuffer.getChannelData(ch));
    }
    let offset = 44;
    for (let i = 0; i < length; i++) {
      for (let ch = 0; ch < numChannels; ch++) {
        let sample = Math.max(-1, Math.min(1, channels[ch][i]));
        view.setInt16(offset, sample < 0 ? sample * 0x8000 : sample * 0x7FFF, true);
        offset += 2;
      }
    }

    $('progressAudioFill').style.width = '100%';
    $('progressAudioText').textContent = '100%';

    const blob = new Blob([wavBuffer], { type: 'audio/wav' });
    const url = URL.createObjectURL(blob);
    const durationStr = (audioBuffer.duration).toFixed(1) + 's';
    $('resultAudioMeta').textContent = numChannels + 'ch, ' + sampleRate + ' Hz, ' + durationStr;
    $('resultAudioSize').textContent = formatSize(blob.size);
    $('resultAudio').classList.add('show');
    setStep(3);
    setStatus(t('msg_done'));

    $('dlAudio').onclick = () => {
      const a = document.createElement('a');
      a.href = url;
      a.download = audioFile.name.replace(/\.[^.]+$/, '') + '.wav';
      a.click();
    };
    audioCtx.close();
  } catch (err) {
    setStatus('Error: ' + err.message);
  }
  $('btnConvertAudio').disabled = false;
});

/* ========== 3. SVG â†’ PNG/JPG ========== */
let svgFile = null;
setupDropZone('dropSvg','inputSvg','fileSvg','fileSvgName','fileSvgSize','removeSvg','.svg', file => {
  svgFile = file;
  $('btnConvertSvg').disabled = !file;
  const preview = $('previewSvg');
  if (file) {
    const url = URL.createObjectURL(file);
    $('svgPreviewImg').src = url;
    preview.classList.add('show');
  } else {
    preview.classList.remove('show');
    $('svgPreviewImg').src = '';
    $('resultSvg').classList.remove('show');
  }
});

// æ ¹æ®æ ¼å¼æ˜¾éšèƒŒæ™¯è‰²é€‰æ‹©
$('svgFormat').addEventListener('change', () => {
  $('svgBgGroup').style.display = $('svgFormat').value === 'image/jpeg' ? '' : 'none';
});
$('svgBgGroup').style.display = 'none';

$('btnConvertSvg').addEventListener('click', async () => {
  if (!svgFile) return setStatus(t('msg_no_file'));
  $('btnConvertSvg').disabled = true;
  setStatus(t('msg_processing'));
  $('resultSvg').classList.remove('show');

  try {
    const svgText = await svgFile.text();
    const format = $('svgFormat').value;
    const scale = parseInt($('svgScale').value) || 2;
    const bgColor = $('svgBgColor').value;

    // è§£æ SVG å°ºå¯¸
    const parser = new DOMParser();
    const svgDoc = parser.parseFromString(svgText, 'image/svg+xml');
    const svgEl = svgDoc.documentElement;
    let w = parseFloat(svgEl.getAttribute('width')) || 300;
    let h = parseFloat(svgEl.getAttribute('height')) || 150;
    const viewBox = svgEl.getAttribute('viewBox');
    if (viewBox) {
      const parts = viewBox.split(/[\s,]+/).map(Number);
      if (parts.length === 4) { w = parts[2]; h = parts[3]; }
    }

    const canvas = document.createElement('canvas');
    canvas.width = w * scale;
    canvas.height = h * scale;
    const ctx = canvas.getContext('2d');

    if (format === 'image/jpeg') {
      ctx.fillStyle = bgColor;
      ctx.fillRect(0, 0, canvas.width, canvas.height);
    }

    const img = new Image();
    const svgBlob = new Blob([svgText], { type: 'image/svg+xml;charset=utf-8' });
    const svgUrl = URL.createObjectURL(svgBlob);

    await new Promise((resolve, reject) => {
      img.onload = resolve;
      img.onerror = reject;
      img.src = svgUrl;
    });

    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    URL.revokeObjectURL(svgUrl);

    const blob = await new Promise(r => canvas.toBlob(r, format, 0.92));
    const url = URL.createObjectURL(blob);
    $('resultSvgImg').src = url;
    $('resultSvgMeta').textContent = canvas.width + ' Ã— ' + canvas.height + ' px (' + (format === 'image/png' ? 'PNG' : 'JPG') + ')';
    $('resultSvgSize').textContent = formatSize(blob.size);
    $('resultSvg').classList.add('show');
    setStep(3);
    setStatus(t('msg_done'));

    const ext = format === 'image/png' ? 'png' : 'jpg';
    $('dlSvg').onclick = () => {
      const a = document.createElement('a');
      a.href = url;
      a.download = svgFile.name.replace(/\.svg$/i, '') + '.' + ext;
      a.click();
    };
  } catch (err) {
    setStatus('Error: ' + err.message);
  }
  $('btnConvertSvg').disabled = false;
});

/* ========== 4. Image â†” Base64 ========== */
// æ¨¡å¼åˆ‡æ¢
$('modeImgTo').addEventListener('click', () => {
  $('modeImgTo').classList.add('active');
  $('modeB64To').classList.remove('active');
  $('imgToB64Section').style.display = '';
  $('b64ToImgSection').style.display = 'none';
});
$('modeB64To').addEventListener('click', () => {
  $('modeB64To').classList.add('active');
  $('modeImgTo').classList.remove('active');
  $('b64ToImgSection').style.display = '';
  $('imgToB64Section').style.display = 'none';
});

// Image â†’ Base64
let b64File = null;
setupDropZone('dropB64','inputB64','fileB64','fileB64Name','fileB64Size','removeB64','image/*', file => {
  b64File = file;
  const preview = $('previewB64');
  if (file) {
    const reader = new FileReader();
    reader.onload = () => {
      $('b64PreviewImg').src = reader.result;
      preview.classList.add('show');
      $('b64Output').value = reader.result;
      setStep(3);
      setStatus(t('msg_done'));
    };
    reader.readAsDataURL(file);
  } else {
    preview.classList.remove('show');
    $('b64PreviewImg').src = '';
    $('b64Output').value = '';
  }
});

$('copyB64').addEventListener('click', () => {
  const text = $('b64Output').value;
  if (!text) return;
  navigator.clipboard.writeText(text).then(() => {
    $('copyB64').textContent = t('msg_copied');
    $('copyB64').classList.add('copied');
    setTimeout(() => {
      $('copyB64').textContent = t('btn_copy');
      $('copyB64').classList.remove('copied');
    }, 2000);
  });
});

// Base64 â†’ Image
$('btnDecodeB64').addEventListener('click', () => {
  const data = $('b64Input').value.trim();
  if (!data || !data.startsWith('data:image')) {
    setStatus(t('msg_invalid_b64'));
    return;
  }
  $('resultB64Img').src = data;
  // æå– MIME ç±»å‹
  const mimeMatch = data.match(/^data:(image\/\w+)/);
  const mime = mimeMatch ? mimeMatch[1] : 'image/png';
  const ext = mime.split('/')[1] === 'jpeg' ? 'jpg' : mime.split('/')[1];
  $('resultB64Meta').textContent = mime.toUpperCase();
  $('resultB64').classList.add('show');
  setStep(3);
  setStatus(t('msg_done'));

  $('dlB64').onclick = () => {
    const a = document.createElement('a');
    a.href = data;
    a.download = 'decoded-image.' + ext;
    a.click();
  };
});

/* ========== åˆå§‹åŒ– ========== */
setStep(1);

// æš´éœ²ç¿»è¯‘ç»™ common.js
window._fileConverterI18n = i18n;

})();
</script>
    <script src="common/common.js" data-tool-id="file-converter" data-tool-name="File Converter" data-category="media"></script>
    <script>WebToolbox.init(window._fileConverterI18n);</script>

</body>
</html>
