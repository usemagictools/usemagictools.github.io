<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CT8E5N460D"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-CT8E5N460D');</script>
    <title>Paint Board - Free Online Drawing Tool | No Ads, No Signup</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Free online paint board with brush, eraser, fill, rectangle, circle, line, arrow, text tools. Customize colors and opacity, undo/redo support, export to PNG/JPG. ‚úÖ No ads ‚úÖ No signup ‚úÖ No watermark. Runs entirely in your browser.">
    <meta name="keywords" content="online paint board,drawing tool,free drawing,paint tool,canvas drawing,web paint,online doodle,image editor, no ads, no signup, no watermark, no login, free unlimited, browser-based, no installation, local processing">
    <meta name="author" content="UseMagicTools">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">
    <meta name="revisit-after" content="7 days">
    <meta name="rating" content="general">
    <meta name="distribution" content="global">
    <meta name="language" content="en">
    <link rel="canonical" href="https://www.usemagictools.com/paint-board.html">
    <link rel="alternate" hreflang="en" href="https://www.usemagictools.com/paint-board.html">
    <link rel="alternate" hreflang="zh-CN" href="https://www.usemagictools.com/paint-board.html">
    <link rel="alternate" hreflang="fr" href="https://www.usemagictools.com/paint-board.html">
    <link rel="alternate" hreflang="es" href="https://www.usemagictools.com/paint-board.html">
    <link rel="alternate" hreflang="x-default" href="https://www.usemagictools.com/paint-board.html">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.usemagictools.com/paint-board.html">
    <meta property="og:title" content="Paint Board - Free Online Drawing Tool | No Ads, No Signup">
    <meta property="og:description" content="Free online paint board with brush, shapes, text tools. Export to PNG/JPG format.">
    <meta property="og:image" content="https://www.usemagictools.com/screenshots/paint-board-v1.webp">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Web Toolbox">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@usemagictools">
    <meta name="twitter:creator" content="@usemagictools">
    <meta name="twitter:title" content="Paint Board - Free Online Drawing Tool | No Ads, No Signup">
    <meta name="twitter:description" content="Free online paint board with brush, shapes, text tools.">
    <meta name="twitter:image" content="https://www.usemagictools.com/screenshots/paint-board-v1.webp">

    <!-- JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Online Paint Board",
        "alternateName": ["Âú®Á∫øÁîªÊùø", "Drawing Board", "Online Whiteboard"],
        "url": "https://www.usemagictools.com/paint-board.html",
        "description": "Online paint board with brush, shapes, text and various drawing tools",
        "applicationCategory": "DesignApplication",
        "operatingSystem": "Web Browser",
        "offers": {"@type": "Offer", "price": "0", "priceCurrency": "USD"},
        "featureList": ["No ads", "No signup required", "No watermark", "100% browser-based", "Unlimited usage", "Local processing"],
        "author": {"@type": "Person", "name": "UseMagicTools"},
        "publisher": {"@type": "Organization", "name": "Web Toolbox", "url": "https://www.usemagictools.com/"},
        "screenshot": "https://www.usemagictools.com/screenshots/paint-board-v1.webp",
        "inLanguage": ["en", "zh-CN", "fr", "es"]
    }
    </script>

    <!-- FAQPage JSON-LD -->
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
        {
            "@type": "Question",
            "name": "What drawing tools are supported?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "This free online paint board includes a comprehensive set of drawing tools: pencil, brush with pressure sensitivity, straight line, rectangle, circle/ellipse, eraser, and color fill. Each tool supports customizable colors and sizes. Whether you are sketching, annotating, or creating digital art, these tools cover a wide range of creative needs. No signup, no ads, and completely browser-based."
            }
        },
        {
            "@type": "Question",
            "name": "Can I adjust the brush size?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes, the brush size is fully adjustable from 1 pixel (for fine detail work) up to 50 pixels (for broad strokes and fills). Use the size slider to find the perfect width for your current drawing task. Size adjustment applies to pencil, brush, and eraser tools alike. This free browser-based paint tool requires no signup, no ads, and no software installation."
            }
        },
        {
            "@type": "Question",
            "name": "How to save artwork?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Click the export button to download your artwork as a high-quality PNG image file. PNG format preserves transparent backgrounds and crisp edges, making it suitable for further editing, sharing on social media, or printing. The export happens instantly with no watermarks added. This free online drawing tool requires no signup, and your artwork is never uploaded to any server."
            }
        },
        {
            "@type": "Question",
            "name": "Does it support touch screen drawing?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes, this tool is fully optimized for touch screen devices including tablets, iPads, and smartphones. You can draw smoothly with your finger or a stylus pen with responsive pressure detection. Touch gestures like pinch-to-zoom may also be available depending on your device. This free browser-based canvas tool requires no app installation, no signup, and works on all modern browsers."
            }
        },
        {
            "@type": "Question",
            "name": "Can I open existing images for editing?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes. You can import existing images as a canvas background layer, then draw on top of them using any available tool. This is perfect for image annotation, adding handwritten notes, creating memes, marking up screenshots, and secondary creative work. The imported image stays local in your browser. This free tool requires no signup, no ads, and no server upload."
            }
        },
        {
            "@type": "Question",
            "name": "Is this tool really free with no ads?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All processing happens locally in your browser ‚Äî your data is never uploaded to any server."
            }
        }
    ]
}
</script>
    <!-- JSON-LD: BreadcrumbList -->
    <script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Home", "item": "https://www.usemagictools.com/"}, {"@type": "ListItem", "position": 2, "name": "Paint Board", "item": "https://www.usemagictools.com/paint-board.html"}]}</script>
    <!-- JSON-LD: HowTo -->
    <script type="application/ld+json">{"@context": "https://schema.org", "@type": "HowTo", "name": "How to Use Paint Board", "totalTime": "PT1M", "step": [{"@type": "HowToStep", "position": 1, "name": "Select Drawing Tool", "text": "Choose from brush, eraser, shapes (rectangle, circle, line, arrow), fill, or text tools."}, {"@type": "HowToStep", "position": 2, "name": "Customize and Draw", "text": "Adjust color, brush size, and opacity. Draw freely on the canvas using your mouse or touch screen."}, {"@type": "HowToStep", "position": 3, "name": "Save Your Work", "text": "Export your drawing as PNG or JPG format. Use undo/redo to refine your artwork."}]}</script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e4e4e7;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
        }

        .paint-app {
            display: flex;
            flex-direction: column;
            height: calc(100vh - 150px);
            min-height: 500px;
            margin-top: 15px;
        }

        /* È°∂ÈÉ®Â∑•ÂÖ∑Ê†è */
        .toolbar {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            position: relative;
            z-index: 10;
        }

        .toolbar-section {
            display: flex;
            align-items: center;
            gap: 8px;
            padding-right: 15px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .toolbar-section:last-child {
            border-right: none;
        }
        /* Â∑•ÂÖ∑ÊåâÈíÆ */
        .tool-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #e4e4e7;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.2s ease;
            position: relative;
        }

        .tool-btn:hover {
            background: rgba(124, 58, 237, 0.3);
            transform: translateY(-2px);
        }

        .tool-btn.active {
            background: linear-gradient(135deg, #7c3aed, #6366f1);
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.4);
        }

        /* Tooltip */
        .tool-btn::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: -35px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            z-index: 100;
        }

        .tool-btn:hover::after {
            opacity: 1;
            visibility: visible;
            bottom: -40px;
        }

        /* È¢úËâ≤ÈÄâÊã©Âô® */
        .color-picker-wrapper {
            position: relative;
        }

        .color-btn {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .color-btn:hover {
            transform: scale(1.1);
            border-color: rgba(255, 255, 255, 0.6);
        }

        .color-input {
            position: absolute;
            width: 40px;
            height: 40px;
            opacity: 0;
            cursor: pointer;
        }

        /* È¢ÑËÆæÈ¢úËâ≤ */
        .color-presets {
            display: flex;
            gap: 5px;
        }

        .color-preset {
            width: 28px;
            height: 28px;
            border: 2px solid transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .color-preset:hover {
            transform: scale(1.15);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .color-preset.active {
            border-color: #fff;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        /* ÊªëÂùó */
        .slider-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .slider-group label {
            font-size: 0.8rem;
            color: #a1a1aa;
            min-width: 50px;
        }

        .slider-group input[type="range"] {
            width: 100px;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        .slider-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: #7c3aed;
            border-radius: 50%;
            cursor: pointer;
        }

        .slider-value {
            font-size: 0.8rem;
            color: #e4e4e7;
            min-width: 30px;
            text-align: center;
        }

        /* ÁîªÂ∏ÉÂå∫Âüü */
        .canvas-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .canvas-wrapper {
            position: relative;
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        #canvas, #previewCanvas {
            border-radius: 8px;
            cursor: crosshair;
        }

        #canvas {
            background: #fff;
        }

        #previewCanvas {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
        }

        #textLayer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        #textLayer .text-object {
            pointer-events: auto;
        }

        /* Â∫ïÈÉ®Áä∂ÊÄÅÊ†è */
        .status-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            margin-top: 15px;
            font-size: 0.85rem;
            color: #a1a1aa;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Âä®‰ΩúÊåâÈíÆ */
        .action-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .action-btn-primary {
            background: linear-gradient(135deg, #7c3aed, #6366f1);
            color: #fff;
        }

        .action-btn-primary:hover {
            background: linear-gradient(135deg, #8b5cf6, #818cf8);
            transform: translateY(-2px);
        }

        .action-btn-success {
            background: linear-gradient(135deg, #059669, #10b981);
            color: #fff;
        }

        .action-btn-success:hover {
            background: linear-gradient(135deg, #10b981, #34d399);
        }

        .action-btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e4e4e7;
        }

        .action-btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Toast ÊèêÁ§∫ */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 24px;
            background: rgba(34, 197, 94, 0.9);
            color: #fff;
            border-radius: 8px;
            font-size: 0.9rem;
            z-index: 1000;
            animation: toastIn 0.3s ease;
        }

        .toast.error {
            background: rgba(239, 68, 68, 0.9);
        }

        @keyframes toastIn {
            from { transform: translateX(-50%) translateY(20px); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }

        /* ÁîªÂ∏ÉÂ∞∫ÂØ∏ÈÄâÊã©Ê®°ÊÄÅÊ°Ü */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 30px;
            min-width: 350px;
            transform: scale(0.9);
            transition: all 0.3s ease;
        }

        .modal-overlay.active .modal {
            transform: scale(1);
        }

        .modal h3 {
            margin-bottom: 20px;
            font-size: 1.2rem;
            color: #fff;
        }

        .modal-input-group {
            margin-bottom: 15px;
        }

        .modal-input-group label {
            display: block;
            margin-bottom: 5px;
            color: #a1a1aa;
            font-size: 0.85rem;
        }

        .modal-input-group input {
            width: 100%;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 6px;
            color: #e4e4e7;
            font-size: 0.95rem;
        }

        .modal-input-group input:focus {
            outline: none;
            border-color: #7c3aed;
        }

        .modal-presets {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .modal-preset {
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: #a1a1aa;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .modal-preset:hover {
            background: rgba(124, 58, 237, 0.3);
            border-color: #7c3aed;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        /* Â°´ÂÖÖÊ®°ÂºèÂàáÊç¢ */
        .fill-toggle {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.8rem;
            color: #a1a1aa;
        }

        .fill-toggle input {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        /* ÊñáÊú¨ÁºñËæëÈù¢Êùø */
        .text-panel {
            position: absolute;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 15px;
            min-width: 280px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            pointer-events: auto;
        }

        .text-panel.active {
            display: block;
        }

        .text-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .text-panel-header h4 {
            margin: 0;
            font-size: 0.9rem;
            color: #fff;
        }

        .text-panel-close {
            background: none;
            border: none;
            color: #a1a1aa;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0;
            line-height: 1;
        }

        .text-panel-close:hover {
            color: #ef4444;
        }

        .text-panel-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .text-panel-row label {
            font-size: 0.8rem;
            color: #a1a1aa;
            min-width: 45px;
        }

        .text-panel-row input[type="text"],
        .text-panel-row textarea {
            flex: 1;
            padding: 8px 10px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 6px;
            color: #e4e4e7;
            font-size: 0.9rem;
            resize: none;
        }

        .text-panel-row textarea {
            height: 60px;
            font-family: inherit;
        }

        .text-panel-row input:focus,
        .text-panel-row textarea:focus {
            outline: none;
            border-color: #7c3aed;
        }

        .text-panel-row select {
            flex: 1;
            padding: 8px 10px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 6px;
            color: #e4e4e7;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .text-panel-row select:focus {
            outline: none;
            border-color: #7c3aed;
        }

        .text-panel-row input[type="number"] {
            width: 70px;
            padding: 8px 10px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 6px;
            color: #e4e4e7;
            font-size: 0.9rem;
        }

        .text-panel-row input[type="color"] {
            width: 40px;
            height: 32px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background: none;
        }

        .text-panel-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .text-panel-actions button {
            flex: 1;
        }

        /* ÊñáÊú¨ÂØπË±°Ê†∑ÂºèÔºàÁî®‰∫éÁßªÂä®ÂíåÁºñËæëÔºâ */
        .text-object {
            position: absolute;
            cursor: move;
            padding: 4px 8px;
            border: 2px dashed transparent;
            border-radius: 4px;
            white-space: pre-wrap;
            user-select: none;
        }

        .text-object:hover {
            border-color: rgba(124, 58, 237, 0.5);
        }

        .text-object.selected {
            border-color: #7c3aed;
        }

        .text-object.editing {
            border-color: #22c55e;
        }

        /* ÂìçÂ∫îÂºè */
        @media (max-width: 768px) {
            .container {
                padding: 16px;
            }
            .paint-app {
                height: auto;
                min-height: 400px;
            }
            .toolbar {
                gap: 10px;
                padding: 10px 15px;
            }

            .toolbar-section {
                padding-right: 10px;
            }

            .slider-group input[type="range"] {
                width: 80px;
            }

            .tool-btn {
                width: 36px;
                height: 36px;
                font-size: 1rem;
            }
        }

        /* ÂäüËÉΩÁâπÁÇπÂå∫Âùó */
        .features-section {
            max-width: 1200px;
            margin: 0 auto 20px;
            padding: 0 15px;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .feature-card {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            background: rgba(124, 58, 237, 0.15);
            border-color: rgba(124, 58, 237, 0.3);
            transform: translateY(-2px);
        }

        .feature-icon {
            font-size: 1.5rem;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(124, 58, 237, 0.2);
            border-radius: 10px;
            flex-shrink: 0;
        }

        .feature-content h4 {
            color: #e4e4e7;
            font-size: 0.95rem;
            margin-bottom: 4px;
        }

        .feature-content p {
            color: #a1a1aa;
            font-size: 0.8rem;
            line-height: 1.4;
        }

        /* FAQ Âå∫Âùó */
        .faq-section {
            max-width: 900px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .faq-section h3 {
            color: #e6edf3;
            font-size: 18px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #30363d;
        }

        .faq-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .faq-item {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 8px;
            overflow: hidden;
        }

        .faq-question {
            padding: 16px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #e6edf3;
            font-weight: 500;
            transition: background 0.2s;
        }

        .faq-question:hover {
            background: rgba(124, 58, 237, 0.1);
        }

        .faq-question::after {
            content: '+';
            font-size: 1.2rem;
            color: #7c3aed;
            transition: transform 0.3s;
        }

        .faq-item.active .faq-question::after {
            transform: rotate(45deg);
        }

        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .faq-item.active .faq-answer {
            max-height: 200px;
        }

        .faq-answer p {
            padding: 0 20px 16px;
            color: #8b949e;
            line-height: 1.6;
        }
        </style>
    <link rel="stylesheet" href="common/common.css">
</head>
<body>
<div class="container">
<div class="paint-app">
<!-- È°∂ÈÉ®Â∑•ÂÖ∑Ê†è -->
        <div class="toolbar">
            
<div class="toolbar-section">
                <button class="tool-btn active" data-tool="brush" data-tooltip="Brush (B)" data-i18n-tooltip="tooltip.brush">üñåÔ∏è</button>
                <button class="tool-btn" data-tool="eraser" data-tooltip="Eraser (E)" data-i18n-tooltip="tooltip.eraser">üßπ</button>
                <button class="tool-btn" data-tool="fill" data-tooltip="Fill (G)" data-i18n-tooltip="tooltip.fill">ü™£</button>
                <button class="tool-btn" data-tool="text" data-tooltip="Text (X)" data-i18n-tooltip="tooltip.text">üìù</button>
            </div>

            <div class="toolbar-section">
                <button class="tool-btn" data-tool="line" data-tooltip="Line (L)" data-i18n-tooltip="tooltip.line">üìè</button>
                <button class="tool-btn" data-tool="arrowRight" data-tooltip="Right Arrow (A)" data-i18n-tooltip="tooltip.arrowRight">‚Üí</button>
                <button class="tool-btn" data-tool="arrowLeft" data-tooltip="Left Arrow (S)" data-i18n-tooltip="tooltip.arrowLeft">‚Üê</button>
                <button class="tool-btn" data-tool="rect" data-tooltip="Rectangle (R)" data-i18n-tooltip="tooltip.rect">‚¨ú</button>
                <button class="tool-btn" data-tool="circle" data-tooltip="Circle (C)" data-i18n-tooltip="tooltip.circle">‚≠ï</button>
                <button class="tool-btn" data-tool="triangle" data-tooltip="Triangle (T)" data-i18n-tooltip="tooltip.triangle">üî∫</button>
                <label class="fill-toggle" data-tooltip="Fill Shape">
                    <input type="checkbox" id="fillShape">
                    <span data-i18n="fill">Fill</span>
                </label>
            </div>

            <div class="toolbar-section">
                <div class="color-picker-wrapper">
                    <input type="color" id="colorPicker" class="color-input" value="#000000">
                    <div class="color-btn" id="colorBtn" style="background: #000000;" data-tooltip="Choose Color" data-i18n-tooltip="tooltip.chooseColor"></div>
                </div>
                <div class="color-presets">
                    <div class="color-preset active" style="background: #000000;" data-color="#000000"></div>
                    <div class="color-preset" style="background: #ef4444;" data-color="#ef4444"></div>
                    <div class="color-preset" style="background: #f97316;" data-color="#f97316"></div>
                    <div class="color-preset" style="background: #eab308;" data-color="#eab308"></div>
                    <div class="color-preset" style="background: #22c55e;" data-color="#22c55e"></div>
                    <div class="color-preset" style="background: #3b82f6;" data-color="#3b82f6"></div>
                    <div class="color-preset" style="background: #8b5cf6;" data-color="#8b5cf6"></div>
                    <div class="color-preset" style="background: #ec4899;" data-color="#ec4899"></div>
                </div>
            </div>

            <div class="toolbar-section">
                <div class="slider-group">
                    <label data-i18n="size">Size</label>
                    <input type="range" id="brushSize" min="1" max="50" value="5">
                    <span class="slider-value" id="brushSizeValue">5</span>
                </div>
            </div>

            <div class="toolbar-section">
                <div class="slider-group">
                    <label data-i18n="opacity">Opacity</label>
                    <input type="range" id="opacity" min="10" max="100" value="100">
                    <span class="slider-value" id="opacityValue">100%</span>
                </div>
            </div>

            <div class="toolbar-section">
                <button class="tool-btn" data-tooltip="Undo (Ctrl+Z)" data-i18n-tooltip="tooltip.undo" onclick="undo()">‚Ü©Ô∏è</button>
                <button class="tool-btn" data-tooltip="Redo (Ctrl+Y)" data-i18n-tooltip="tooltip.redo" onclick="redo()">‚Ü™Ô∏è</button>
            </div>

            <div class="toolbar-section">
                <button class="tool-btn" data-tooltip="New Canvas" data-i18n-tooltip="tooltip.newCanvas" onclick="showNewCanvasModal()">üìÑ</button>
                <button class="tool-btn" data-tooltip="Clear Canvas" data-i18n-tooltip="tooltip.clearCanvas" onclick="clearCanvas()">üóëÔ∏è</button>
            </div>
        </div>

        <!-- ÁîªÂ∏ÉÂå∫Âüü -->
        <div class="canvas-container">
            <div class="canvas-wrapper" id="canvasWrapper">
                <canvas id="canvas" width="1000" height="600"></canvas>
                <canvas id="previewCanvas" width="1000" height="600"></canvas>
                <!-- ÊñáÊú¨ÂØπË±°ÂÆπÂô® -->
                <div id="textLayer"></div>
                <!-- ÊñáÊú¨ÁºñËæëÈù¢Êùø -->
                <div class="text-panel" id="textPanel" onmousedown="event.stopPropagation()">
                    <div class="text-panel-header">
                        <h4 data-i18n="textPanel.title">üìù Add Text</h4>
                        <button class="text-panel-close" onclick="hideTextPanel()">√ó</button>
                    </div>
                    <div class="text-panel-row">
                        <label data-i18n="textPanel.content">Content</label>
                        <textarea id="textContent" placeholder="Enter text content..." data-i18n-placeholder="textPanel.placeholder"></textarea>
                    </div>
                    <div class="text-panel-row">
                        <label data-i18n="textPanel.font">Font</label>
                        <select id="textFont">
                            <option value="Arial">Arial</option>
                            <option value="Microsoft YaHei">Microsoft YaHei</option>
                            <option value="SimSun">SimSun</option>
                            <option value="SimHei">SimHei</option>
                            <option value="KaiTi">KaiTi</option>
                            <option value="FangSong">FangSong</option>
                            <option value="Georgia">Georgia</option>
                            <option value="Times New Roman">Times New Roman</option>
                            <option value="Courier New">Courier New</option>
                            <option value="Comic Sans MS">Comic Sans MS</option>
                        </select>
                    </div>
                    <div class="text-panel-row">
                        <label data-i18n="textPanel.size">Size</label>
                        <input type="number" id="textSize" value="24" min="8" max="200">
                        <label style="min-width: auto;" data-i18n="textPanel.color">Color</label>
                        <input type="color" id="textColor" value="#000000">
                    </div>
                    <div class="text-panel-row">
                        <label data-i18n="textPanel.style">Style</label>
                        <label style="min-width: auto; display: flex; align-items: center; gap: 4px;">
                            <input type="checkbox" id="textBold"> <span data-i18n="textPanel.bold">Bold</span>
                        </label>
                        <label style="min-width: auto; display: flex; align-items: center; gap: 4px;">
                            <input type="checkbox" id="textItalic"> <span data-i18n="textPanel.italic">Italic</span>
                        </label>
                    </div>
                    <div class="text-panel-actions">
                        <button class="action-btn action-btn-secondary" onmousedown="event.stopPropagation()" onclick="hideTextPanel()" data-i18n="cancel">Cancel</button>
                        <button class="action-btn action-btn-primary" onmousedown="event.stopPropagation()" onclick="confirmText()" data-i18n="confirm">Confirm</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Â∫ïÈÉ®Áä∂ÊÄÅÊ†è -->
        <div class="status-bar">
            <div class="status-item">
                <span data-i18n="status.canvasSize">Canvas Size:</span>
                <span id="canvasSize">1000 √ó 600</span>
            </div>
            <div class="status-item">
                <span data-i18n="status.mousePos">Mouse Position:</span>
                <span id="mousePos">0, 0</span>
            </div>
            <div class="status-item">
                <span data-i18n="status.currentTool">Current Tool:</span>
                <span id="currentTool" data-i18n="tool.brush">Brush</span>
            </div>
            <div class="status-item">
                <span data-i18n="status.tip">üí° Tip: Scroll wheel adjusts size</span>
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="action-btn action-btn-success" onclick="saveImage('png')" data-i18n="savePng">üíæ Save PNG</button>
                <button class="action-btn action-btn-primary" onclick="saveImage('jpg')" data-i18n="saveJpg">üíæ Save JPG</button>
            </div>
        </div>
</div><!-- /.paint-app -->

        <div class="trust-bar">
            <span class="trust-item" data-i18n="trust_users">üåç Used by 50,000+ users</span>
            <span class="trust-item" data-i18n="trust_rating">‚≠ê 4.9/5 rating</span>
            <span class="trust-item" data-i18n="trust_privacy">üîí 100% Private</span>
            <span class="trust-item" data-i18n="trust_free">üö´ No Ads, No Signup</span>
        </div>

        <!-- ÂäüËÉΩÁâπÁÇπ -->
        <section class="features-section">
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">üîí</div>
                    <div class="feature-content">
                        <h4 data-i18n="feature.brushes">100% Free & Private</h4>
                        <p data-i18n="feature.brushesDesc">No ads, no signup, no watermark. Everything runs locally in your browser. Your data never leaves your device.</p>
                    </div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üé®</div>
                    <div class="feature-content">
                        <h4 data-i18n="feature.colors">Rich Colors</h4>
                        <p data-i18n="feature.colorsDesc">Free color selection with opacity adjustment</p>
                    </div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">‚Ü©Ô∏è</div>
                    <div class="feature-content">
                        <h4 data-i18n="feature.undoRedo">Undo/Redo</h4>
                        <p data-i18n="feature.undoRedoDesc">Support undo and redo for easy editing</p>
                    </div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üíæ</div>
                    <div class="feature-content">
                        <h4 data-i18n="feature.export">Export & Save</h4>
                        <p data-i18n="feature.exportDesc">Export artwork as PNG image</p>
                    </div>
                </div>
            </div>
        </section>

    <!-- FAQ ÈóÆÁ≠îÂå∫Âùó -->
    <section class="faq-section">
        <h3 data-i18n="faq_title">FAQ</h3>
        <div class="faq-list">
            <div class="faq-item">
                <div class="faq-question" data-i18n="faq1Q">What drawing tools are supported?</div>
                <div class="faq-answer">
                    <p data-i18n="faq1A">Supports pencil, brush, line, rectangle, circle, eraser and other tools to meet various drawing needs. Each tool can adjust size and opacity.</p>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" data-i18n="faq2Q">Can I adjust the brush size?</div>
                <div class="faq-answer">
                    <p data-i18n="faq2A">Yes, supports brush size adjustment from 1px to 50px. You can adjust via slider or use mouse scroll wheel for quick adjustment.</p>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" data-i18n="faq3Q">How to save artwork?</div>
                <div class="faq-answer">
                    <p data-i18n="faq3A">Click "Save PNG" or "Save JPG" button at the bottom to export your artwork as an image file, which will be automatically downloaded to your device.</p>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" data-i18n="faq4Q">Does it support touch screen drawing?</div>
                <div class="faq-answer">
                    <p data-i18n="faq4A">Yes, you can draw with finger or stylus on tablets or touch screens with smooth operation, suitable for mobile devices.</p>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" data-i18n="faq5Q">Can I open existing images for editing?</div>
                <div class="faq-answer">
                    <p data-i18n="faq5A">You can import images as background and draw on them, convenient for image annotation and secondary creation. Use "New Canvas" to set appropriate canvas size.</p>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" data-i18n="faq_free_q">Is this tool really free with no ads?</div>
                <div class="faq-answer">
                    <p data-i18n="faq_free_a">Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All processing happens locally in your browser ‚Äî your data is never uploaded to any server.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Related Tools -->
    <section class="related-tools">
        <h3 data-i18n="related_title">üîó Related Tools</h3>
        <div class="related-grid">
            <a href="color-palette.html" class="related-card">
                <div class="related-icon">üé®</div>
                <h4 data-i18n="related_1">Color Palette</h4>
                <p data-i18n="related_1_desc">Color selection and conversion</p>
            </a>
            <a href="image-editor.html" class="related-card">
                <div class="related-icon">üñºÔ∏è</div>
                <h4 data-i18n="related_2">Image Editor</h4>
                <p data-i18n="related_2_desc">Crop, rotate, filters</p>
            </a>
            <a href="image-converter.html" class="related-card">
                <div class="related-icon">üîÑ</div>
                <h4 data-i18n="related_3">Image Converter</h4>
                <p data-i18n="related_3_desc">PNG/JPG/WebP conversion</p>
            </a>
            <a href="ico-maker.html" class="related-card">
                <div class="related-icon">üè∑Ô∏è</div>
                <h4 data-i18n="related_4">ICO Maker</h4>
                <p data-i18n="related_4_desc">Generate website icons</p>
            </a>
        </div>
    </section>
    </div>

    <!-- Êñ∞Âª∫ÁîªÂ∏ÉÊ®°ÊÄÅÊ°Ü -->
    <div class="modal-overlay" id="newCanvasModal">
        <div class="modal">
            <h3 data-i18n="modal.newCanvas">üìÑ New Canvas</h3>
            <div class="modal-presets">
                <span class="modal-preset" onclick="setCanvasSize(800, 600)">800√ó600</span>
                <span class="modal-preset" onclick="setCanvasSize(1024, 768)">1024√ó768</span>
                <span class="modal-preset" onclick="setCanvasSize(1280, 720)">1280√ó720</span>
                <span class="modal-preset" onclick="setCanvasSize(1920, 1080)">1920√ó1080</span>
                <span class="modal-preset" onclick="setCanvasSize(500, 500)">500√ó500</span>
                <span class="modal-preset" onclick="setCanvasSize(1000, 1000)">1000√ó1000</span>
            </div>
            <div class="modal-input-group">
                <label data-i18n="modal.width">Width (px)</label>
                <input type="number" id="canvasWidth" value="1000" min="100" max="3000">
            </div>
            <div class="modal-input-group">
                <label data-i18n="modal.height">Height (px)</label>
                <input type="number" id="canvasHeight" value="600" min="100" max="3000">
            </div>
            <div class="modal-actions">
                <button class="action-btn action-btn-secondary" onclick="hideNewCanvasModal()" data-i18n="cancel">Cancel</button>
                <button class="action-btn action-btn-primary" onclick="createNewCanvas()" data-i18n="modal.create">Create</button>
            </div>
        </div>
    </div>

    <script>
        // ==================== ÂõΩÈôÖÂåñ i18n ====================
        const i18n = {
            'en': {
                tool_name: 'Paint Board',
                back: '‚Üê Back',
                fill: 'Fill',
                size: 'Size',
                opacity: 'Opacity',
                cancel: 'Cancel',
                confirm: 'Confirm',
                savePng: 'üíæ Save PNG',
                saveJpg: 'üíæ Save JPG',
                tooltip: {
                    brush: 'Brush (B)',
                    eraser: 'Eraser (E)',
                    fill: 'Fill (G)',
                    text: 'Text (X)',
                    line: 'Line (L)',
                    arrowRight: 'Right Arrow (A)',
                    arrowLeft: 'Left Arrow (S)',
                    rect: 'Rectangle (R)',
                    circle: 'Circle (C)',
                    triangle: 'Triangle (T)',
                    chooseColor: 'Choose Color',
                    undo: 'Undo (Ctrl+Z)',
                    redo: 'Redo (Ctrl+Y)',
                    newCanvas: 'New Canvas',
                    clearCanvas: 'Clear Canvas'
                },
                feature: {
                    brushes: '100% Free & Private',
                    brushesDesc: 'No ads, no signup, no watermark. Everything runs locally in your browser. Your data never leaves your device.',
                    colors: 'Rich Colors',
                    colorsDesc: 'Free color selection with opacity adjustment',
                    undoRedo: 'Undo/Redo',
                    undoRedoDesc: 'Support undo and redo for easy editing',
                    export: 'Export & Save',
                    exportDesc: 'Export artwork as PNG image'
                },
                textPanel: {
                    title: 'üìù Add Text',
                    content: 'Content',
                    placeholder: 'Enter text content...',
                    font: 'Font',
                    size: 'Size',
                    color: 'Color',
                    style: 'Style',
                    bold: 'Bold',
                    italic: 'Italic'
                },
                status: {
                    canvasSize: 'Canvas Size:',
                    mousePos: 'Mouse Position:',
                    currentTool: 'Current Tool:',
                    tip: 'üí° Tip: Scroll wheel adjusts size'
                },
                tool: {
                    brush: 'Brush',
                    eraser: 'Eraser',
                    fill: 'Fill',
                    text: 'Text',
                    line: 'Line',
                    arrowRight: 'Right Arrow',
                    arrowLeft: 'Left Arrow',
                    rect: 'Rectangle',
                    circle: 'Circle',
                    triangle: 'Triangle'
                },
                modal: {
                    newCanvas: 'üìÑ New Canvas',
                    width: 'Width (px)',
                    height: 'Height (px)',
                    create: 'Create'
                },
                faq_title: 'FAQ',
                faq1Q: 'What drawing tools are supported?',
                faq1A: 'Supports pencil, brush, line, rectangle, circle, eraser and other tools to meet various drawing needs. Each tool can adjust size and opacity.',
                faq2Q: 'Can I adjust the brush size?',
                faq2A: 'Yes, supports brush size adjustment from 1px to 50px. You can adjust via slider or use mouse scroll wheel for quick adjustment.',
                faq3Q: 'How to save artwork?',
                faq3A: 'Click "Save PNG" or "Save JPG" button at the bottom to export your artwork as an image file, which will be automatically downloaded to your device.',
                faq4Q: 'Does it support touch screen drawing?',
                faq4A: 'Yes, you can draw with finger or stylus on tablets or touch screens with smooth operation, suitable for mobile devices.',
                faq5Q: 'Can I open existing images for editing?',
                faq5A: 'You can import images as background and draw on them, convenient for image annotation and secondary creation. Use "New Canvas" to set appropriate canvas size.',
                faq_free_q: 'Is this tool really free with no ads?',
                faq_free_a: 'Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All processing happens locally in your browser ‚Äî your data is never uploaded to any server.',
                related_title: 'üîó Related Tools',
                related_1: 'Color Palette',
                related_1_desc: 'Color selection and conversion',
                related_2: 'Image Editor',
                related_2_desc: 'Crop, rotate, filters',
                related_3: 'Image Converter',
                related_3_desc: 'PNG/JPG/WebP conversion',
                related_4: 'ICO Maker',
                related_4_desc: 'Generate website icons',
                toast: {
                    undoSuccess: 'Undo successful',
                    redoSuccess: 'Redo successful',
                    canvasCleared: 'Canvas cleared',
                    newCanvasCreated: 'New canvas created',
                    sizeRange: 'Canvas size should be between 100-3000',
                    imageSaved: 'Image saved as',
                    textAdded: 'Text added, drag to move',
                    textDeleted: 'Text deleted',
                    enterText: 'Please enter text content',
                    confirmClear: 'Are you sure you want to clear the canvas?',
                    confirmClearWithText: 'Are you sure you want to clear the canvas? (including all text)'
                },
                langName: 'üåê English',
                trust_users: 'üåç Used by 50,000+ users',
                trust_rating: '‚≠ê 4.9/5 rating',
                trust_privacy: 'üîí 100% Private',
                trust_free: 'üö´ No Ads, No Signup'
            },
            'zh-CN': {
                tool_name: 'Âú®Á∫øÁîªÊùø',
                back: '‚Üê ËøîÂõû',
                fill: 'Â°´ÂÖÖ',
                size: 'Á≤óÁªÜ',
                opacity: 'ÈÄèÊòéÂ∫¶',
                cancel: 'ÂèñÊ∂à',
                confirm: 'Á°ÆÂÆö',
                savePng: 'üíæ ‰øùÂ≠ò PNG',
                saveJpg: 'üíæ ‰øùÂ≠ò JPG',
                tooltip: {
                    brush: 'ÁîªÁ¨î (B)',
                    eraser: 'Ê©°ÁöÆÊì¶ (E)',
                    fill: 'Â°´ÂÖÖ (G)',
                    text: 'ÊñáÂ≠ó (X)',
                    line: 'Áõ¥Á∫ø (L)',
                    arrowRight: 'Âè≥ÁÆ≠Â§¥ (A)',
                    arrowLeft: 'Â∑¶ÁÆ≠Â§¥ (S)',
                    rect: 'Áü©ÂΩ¢ (R)',
                    circle: 'ÂúÜÂΩ¢ (C)',
                    triangle: '‰∏âËßíÂΩ¢ (T)',
                    chooseColor: 'ÈÄâÊã©È¢úËâ≤',
                    undo: 'Êí§ÈîÄ (Ctrl+Z)',
                    redo: 'ÈáçÂÅö (Ctrl+Y)',
                    newCanvas: 'Êñ∞Âª∫ÁîªÂ∏É',
                    clearCanvas: 'Ê∏ÖÁ©∫ÁîªÂ∏É'
                },
                feature: {
                    brushes: '100% ÂÖçË¥π‰∏îÂÆâÂÖ®',
                    brushesDesc: 'Êó†ÂπøÂëä„ÄÅÊó†ÈúÄÊ≥®ÂÜå„ÄÅÊó†Ê∞¥Âç∞„ÄÇÊâÄÊúâÂ§ÑÁêÜÈÉΩÂú®ÊµèËßàÂô®Êú¨Âú∞ÂÆåÊàêÔºåÊï∞ÊçÆ‰∏ç‰ºö‰∏ä‰º†Âà∞‰ªª‰ΩïÊúçÂä°Âô®„ÄÇ',
                    colors: '‰∏∞ÂØåÈ¢úËâ≤',
                    colorsDesc: 'Ëá™Áî±ÈÄâÊã©ÁîªÁ¨îÈ¢úËâ≤ÔºåÊîØÊåÅÈÄèÊòéÂ∫¶Ë∞ÉËäÇ',
                    undoRedo: 'Êí§ÈîÄÈáçÂÅö',
                    undoRedoDesc: 'ÊîØÊåÅÊí§ÈîÄÂíåÈáçÂÅöÊìç‰ΩúÔºåÊñπ‰æø‰øÆÊîπ',
                    export: 'ÂØºÂá∫‰øùÂ≠ò',
                    exportDesc: 'ÂèØÂ∞ÜÁîª‰ΩúÂØºÂá∫‰∏∫ PNG ÂõæÁâá‰øùÂ≠ò'
                },
                textPanel: {
                    title: 'üìù Ê∑ªÂä†ÊñáÂ≠ó',
                    content: 'ÂÜÖÂÆπ',
                    placeholder: 'ËæìÂÖ•ÊñáÂ≠óÂÜÖÂÆπ...',
                    font: 'Â≠ó‰Ωì',
                    size: 'Â§ßÂ∞è',
                    color: 'È¢úËâ≤',
                    style: 'Ê†∑Âºè',
                    bold: 'Á≤ó‰Ωì',
                    italic: 'Êñú‰Ωì'
                },
                status: {
                    canvasSize: 'ÁîªÂ∏ÉÂ∞∫ÂØ∏:',
                    mousePos: 'Èº†Ê†á‰ΩçÁΩÆ:',
                    currentTool: 'ÂΩìÂâçÂ∑•ÂÖ∑:',
                    tip: 'üí° ÊèêÁ§∫: ÊªöËΩÆË∞ÉÊï¥Á≤óÁªÜ'
                },
                tool: {
                    brush: 'ÁîªÁ¨î',
                    eraser: 'Ê©°ÁöÆÊì¶',
                    fill: 'Â°´ÂÖÖ',
                    text: 'ÊñáÂ≠ó',
                    line: 'Áõ¥Á∫ø',
                    arrowRight: 'Âè≥ÁÆ≠Â§¥',
                    arrowLeft: 'Â∑¶ÁÆ≠Â§¥',
                    rect: 'Áü©ÂΩ¢',
                    circle: 'ÂúÜÂΩ¢',
                    triangle: '‰∏âËßíÂΩ¢'
                },
                modal: {
                    newCanvas: 'üìÑ Êñ∞Âª∫ÁîªÂ∏É',
                    width: 'ÂÆΩÂ∫¶ (px)',
                    height: 'È´òÂ∫¶ (px)',
                    create: 'ÂàõÂª∫'
                },
                faq_title: 'Â∏∏ËßÅÈóÆÈ¢ò',
                faq1Q: 'ÊîØÊåÅÂì™‰∫õÁªòÂõæÂ∑•ÂÖ∑Ôºü',
                faq1A: 'ÊîØÊåÅÈìÖÁ¨î„ÄÅÊØõÁ¨î„ÄÅÁõ¥Á∫ø„ÄÅÁü©ÂΩ¢„ÄÅÂúÜÂΩ¢„ÄÅÊ©°ÁöÆÊì¶Á≠âÂ∑•ÂÖ∑ÔºåÂèØ‰ª•Êª°Ë∂≥ÂêÑÁßçÁªòÂõæÈúÄÊ±Ç„ÄÇÊØèÁßçÂ∑•ÂÖ∑ÈÉΩÂèØ‰ª•Ë∞ÉÊï¥Á≤óÁªÜÂíåÈÄèÊòéÂ∫¶„ÄÇ',
                faq2Q: 'ÂèØ‰ª•Ë∞ÉÊï¥ÁîªÁ¨îÁ≤óÁªÜÂêóÔºü',
                faq2A: 'ÂèØ‰ª•ÔºåÊîØÊåÅ‰ªé 1px Âà∞ 50px ÁöÑÁîªÁ¨îÁ≤óÁªÜË∞ÉËäÇ„ÄÇÊÇ®ÂèØ‰ª•ÈÄöËøáÊªëÂùóË∞ÉÊï¥Ôºå‰πüÂèØ‰ª•‰ΩøÁî®Èº†Ê†áÊªöËΩÆÂø´ÈÄüË∞ÉËäÇÁ≤óÁªÜ„ÄÇ',
                faq3Q: 'Â¶Ç‰Ωï‰øùÂ≠òÁîª‰ΩúÔºü',
                faq3A: 'ÁÇπÂáªÂ∫ïÈÉ®ÁöÑ"‰øùÂ≠ò PNG"Êàñ"‰øùÂ≠ò JPG"ÊåâÈíÆÔºåÂç≥ÂèØÂ∞ÜÁîª‰ΩúÂØºÂá∫‰∏∫Áõ∏Â∫îÊ†ºÂºèÁöÑÂõæÁâáÊñá‰ª∂ÔºåËá™Âä®‰∏ãËΩΩÂà∞ÊÇ®ÁöÑËÆæÂ§á„ÄÇ',
                faq4Q: 'ÊîØÊåÅËß¶Êë∏Â±èÁªòÂõæÂêóÔºü',
                faq4A: 'ÊîØÊåÅÔºåÂèØÂú®Âπ≥ÊùøÁîµËÑëÊàñËß¶Êë∏Â±è‰∏ä‰ΩøÁî®ÊâãÊåáÊàñËß¶ÊéßÁ¨îÁªòÂõæÔºåÊìç‰ΩúÊµÅÁïÖËá™ÁÑ∂ÔºåÈÄÇÂêàÁßªÂä®ËÆæÂ§á‰ΩøÁî®„ÄÇ',
                faq5Q: 'ÂèØ‰ª•ÊâìÂºÄÂ∑≤ÊúâÂõæÁâáÁºñËæëÂêóÔºü',
                faq5A: 'ÂèØ‰ª•ÂØºÂÖ•ÂõæÁâá‰Ωú‰∏∫ËÉåÊôØÔºåÂú®ÂÖ∂‰∏äËøõË°åÁªòÂà∂ÔºåÊñπ‰æøËøõË°åÂõæÁâáÊ†áÊ≥®Âíå‰∫åÊ¨°Âàõ‰Ωú„ÄÇ‰ΩøÁî®"Êñ∞Âª∫ÁîªÂ∏É"ÂäüËÉΩÂèØ‰ª•ËÆæÁΩÆÂêàÈÄÇÁöÑÁîªÂ∏ÉÂ∞∫ÂØ∏„ÄÇ',
                faq_free_q: 'Ëøô‰∏™Â∑•ÂÖ∑ÁúüÁöÑÂÆåÂÖ®ÂÖçË¥πÊó†ÂπøÂëäÂêóÔºü',
                faq_free_a: 'ÊòØÁöÑÔºå100% ÂÖçË¥πÔºåÊó†ÂπøÂëä„ÄÅÊó†ÈúÄÊ≥®ÂÜå„ÄÅÊó†Ê∞¥Âç∞„ÄÅÊó†‰ΩøÁî®ÈôêÂà∂„ÄÇÊâÄÊúâÂ§ÑÁêÜÈÉΩÂú®ÊµèËßàÂô®Êú¨Âú∞ÂÆåÊàê„ÄÇ',
                related_title: 'üîó Áõ∏ÂÖ≥Â∑•ÂÖ∑Êé®Ëçê',
                related_1: 'Ë∞ÉËâ≤Êùø',
                related_1_desc: 'È¢úËâ≤ÈÄâÊã©‰∏éËΩ¨Êç¢',
                related_2: 'ÂõæÁâáÁºñËæëÂô®',
                related_2_desc: 'Ë£ÅÂâ™„ÄÅÊóãËΩ¨„ÄÅÊª§Èïú',
                related_3: 'ÂõæÁâáÊ†ºÂºèËΩ¨Êç¢',
                related_3_desc: 'PNG/JPG/WebP ‰∫íËΩ¨',
                related_4: 'ICO ÂõæÊ†áÂà∂‰Ωú',
                related_4_desc: 'ÁîüÊàêÁΩëÁ´ôÂõæÊ†á',
                toast: {
                    undoSuccess: 'Êí§ÈîÄÊàêÂäü',
                    redoSuccess: 'ÈáçÂÅöÊàêÂäü',
                    canvasCleared: 'ÁîªÂ∏ÉÂ∑≤Ê∏ÖÁ©∫',
                    newCanvasCreated: 'Êñ∞ÁîªÂ∏ÉÂ∑≤ÂàõÂª∫',
                    sizeRange: 'ÁîªÂ∏ÉÂ∞∫ÂØ∏Â∫îÂú® 100-3000 ‰πãÈó¥',
                    imageSaved: 'ÂõæÁâáÂ∑≤‰øùÂ≠ò‰∏∫',
                    textAdded: 'ÊñáÂ≠óÂ∑≤Ê∑ªÂä†ÔºåÊãñÂä®ÂèØÁßªÂä®‰ΩçÁΩÆ',
                    textDeleted: 'ÊñáÂ≠óÂ∑≤Âà†Èô§',
                    enterText: 'ËØ∑ËæìÂÖ•ÊñáÂ≠óÂÜÖÂÆπ',
                    confirmClear: 'Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÁîªÂ∏ÉÂêóÔºü',
                    confirmClearWithText: 'Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÁîªÂ∏ÉÂêóÔºüÔºàÂåÖÊã¨ÊâÄÊúâÊñáÂ≠óÔºâ'
                },
                langName: 'üåê ‰∏≠Êñá',
                trust_users: 'üåç Ë∂ÖËøá 50,000 Áî®Êà∑‰ΩøÁî®',
                trust_rating: '‚≠ê 4.9/5 Â•ΩËØÑ',
                trust_privacy: 'üîí 100% ÈöêÁßÅÂÆâÂÖ®',
                trust_free: 'üö´ Êó†ÂπøÂëä„ÄÅÊó†ÈúÄÊ≥®ÂÜå'
            },
            'fr': {
                tool_name: 'Tableau de peinture',
                back: '‚Üê Retour',
                fill: 'Remplir',
                size: 'Taille',
                opacity: 'Opacit√©',
                cancel: 'Annuler',
                confirm: 'Confirmer',
                savePng: 'üíæ Sauver PNG',
                saveJpg: 'üíæ Sauver JPG',
                tooltip: {
                    brush: 'Pinceau (B)',
                    eraser: 'Gomme (E)',
                    fill: 'Remplir (G)',
                    text: 'Texte (X)',
                    line: 'Ligne (L)',
                    arrowRight: 'Fl√®che droite (A)',
                    arrowLeft: 'Fl√®che gauche (S)',
                    rect: 'Rectangle (R)',
                    circle: 'Cercle (C)',
                    triangle: 'Triangle (T)',
                    chooseColor: 'Choisir la couleur',
                    undo: 'Annuler (Ctrl+Z)',
                    redo: 'Refaire (Ctrl+Y)',
                    newCanvas: 'Nouveau canevas',
                    clearCanvas: 'Effacer le canevas'
                },
                feature: {
                    brushes: '100% Gratuit et Priv√©',
                    brushesDesc: 'Sans publicit√©, sans inscription, sans filigrane. Tout est trait√© localement dans votre navigateur.',
                    colors: 'Couleurs riches',
                    colorsDesc: 'S√©lection libre des couleurs avec opacit√©',
                    undoRedo: 'Annuler/Refaire',
                    undoRedoDesc: 'Annuler et refaire pour faciliter l\'√©dition',
                    export: 'Exporter & Sauver',
                    exportDesc: 'Exporter l\'≈ìuvre en image PNG'
                },
                textPanel: {
                    title: 'üìù Ajouter du texte',
                    content: 'Contenu',
                    placeholder: 'Entrez le texte...',
                    font: 'Police',
                    size: 'Taille',
                    color: 'Couleur',
                    style: 'Style',
                    bold: 'Gras',
                    italic: 'Italique'
                },
                status: {
                    canvasSize: 'Taille du canevas:',
                    mousePos: 'Position souris:',
                    currentTool: 'Outil actuel:',
                    tip: 'üí° Astuce: Molette ajuste la taille'
                },
                tool: {
                    brush: 'Pinceau',
                    eraser: 'Gomme',
                    fill: 'Remplir',
                    text: 'Texte',
                    line: 'Ligne',
                    arrowRight: 'Fl√®che droite',
                    arrowLeft: 'Fl√®che gauche',
                    rect: 'Rectangle',
                    circle: 'Cercle',
                    triangle: 'Triangle'
                },
                modal: {
                    newCanvas: 'üìÑ Nouveau canevas',
                    width: 'Largeur (px)',
                    height: 'Hauteur (px)',
                    create: 'Cr√©er'
                },
                faq_title: 'FAQ',
                faq1Q: 'Quels outils de dessin sont support√©s?',
                faq1A: 'Supporte crayon, pinceau, ligne, rectangle, cercle, gomme et autres outils. Chaque outil peut ajuster la taille et l\'opacit√©.',
                faq2Q: 'Puis-je ajuster la taille du pinceau?',
                faq2A: 'Oui, supporte l\'ajustement de 1px √† 50px. Vous pouvez utiliser le curseur ou la molette de la souris.',
                faq3Q: 'Comment sauvegarder l\'≈ìuvre?',
                faq3A: 'Cliquez sur "Sauver PNG" ou "Sauver JPG" en bas pour exporter votre ≈ìuvre en fichier image.',
                faq4Q: 'Supporte-t-il le dessin tactile?',
                faq4A: 'Oui, vous pouvez dessiner avec le doigt ou le stylet sur tablettes ou √©crans tactiles.',
                faq5Q: 'Puis-je ouvrir des images existantes?',
                faq5A: 'Vous pouvez importer des images comme arri√®re-plan et dessiner dessus, pratique pour l\'annotation.',
                faq_free_q: 'Cet outil est-il vraiment gratuit sans publicit√© ?',
                faq_free_a: 'Oui, 100% gratuit sans publicit√©, sans inscription, sans filigrane et sans limite d\'utilisation.',
                related_title: 'üîó Outils connexes',
                related_1: 'Palette de couleurs',
                related_1_desc: 'S√©lection et conversion',
                related_2: '√âditeur d\'images',
                related_2_desc: 'Recadrer, rotation, filtres',
                related_3: 'Convertisseur d\'images',
                related_3_desc: 'Conversion PNG/JPG/WebP',
                related_4: 'Cr√©ateur d\'ICO',
                related_4_desc: 'G√©n√©rer des ic√¥nes web',
                toast: {
                    undoSuccess: 'Annulation r√©ussie',
                    redoSuccess: 'Refaire r√©ussi',
                    canvasCleared: 'Canevas effac√©',
                    newCanvasCreated: 'Nouveau canevas cr√©√©',
                    sizeRange: 'La taille doit √™tre entre 100-3000',
                    imageSaved: 'Image sauvegard√©e en',
                    textAdded: 'Texte ajout√©, glisser pour d√©placer',
                    textDeleted: 'Texte supprim√©',
                    enterText: 'Veuillez entrer le contenu',
                    confirmClear: '√ätes-vous s√ªr de vouloir effacer?',
                    confirmClearWithText: '√ätes-vous s√ªr de vouloir effacer? (y compris le texte)'
                },
                langName: 'üåê Fran√ßais',
                trust_users: 'üåç Utilis√© par 50 000+ utilisateurs',
                trust_rating: '‚≠ê Note 4.9/5',
                trust_privacy: 'üîí 100% Priv√©',
                trust_free: 'üö´ Sans pub, sans inscription'
            },
            'es': {
                tool_name: 'Tablero de pintura',
                back: '‚Üê Volver',
                fill: 'Rellenar',
                size: 'Tama√±o',
                opacity: 'Opacidad',
                cancel: 'Cancelar',
                confirm: 'Confirmar',
                savePng: 'üíæ Guardar PNG',
                saveJpg: 'üíæ Guardar JPG',
                tooltip: {
                    brush: 'Pincel (B)',
                    eraser: 'Borrador (E)',
                    fill: 'Rellenar (G)',
                    text: 'Texto (X)',
                    line: 'L√≠nea (L)',
                    arrowRight: 'Flecha derecha (A)',
                    arrowLeft: 'Flecha izquierda (S)',
                    rect: 'Rect√°ngulo (R)',
                    circle: 'C√≠rculo (C)',
                    triangle: 'Tri√°ngulo (T)',
                    chooseColor: 'Elegir color',
                    undo: 'Deshacer (Ctrl+Z)',
                    redo: 'Rehacer (Ctrl+Y)',
                    newCanvas: 'Nuevo lienzo',
                    clearCanvas: 'Limpiar lienzo'
                },
                feature: {
                    brushes: '100% Gratis y Privado',
                    brushesDesc: 'Sin anuncios, sin registro, sin marca de agua. Todo se procesa localmente en tu navegador.',
                    colors: 'Colores ricos',
                    colorsDesc: 'Selecci√≥n libre de colores con opacidad',
                    undoRedo: 'Deshacer/Rehacer',
                    undoRedoDesc: 'Deshacer y rehacer para edici√≥n f√°cil',
                    export: 'Exportar y Guardar',
                    exportDesc: 'Exportar obra como imagen PNG'
                },
                textPanel: {
                    title: 'üìù A√±adir texto',
                    content: 'Contenido',
                    placeholder: 'Ingrese el texto...',
                    font: 'Fuente',
                    size: 'Tama√±o',
                    color: 'Color',
                    style: 'Estilo',
                    bold: 'Negrita',
                    italic: 'Cursiva'
                },
                status: {
                    canvasSize: 'Tama√±o del lienzo:',
                    mousePos: 'Posici√≥n del rat√≥n:',
                    currentTool: 'Herramienta actual:',
                    tip: 'üí° Consejo: Rueda ajusta el tama√±o'
                },
                tool: {
                    brush: 'Pincel',
                    eraser: 'Borrador',
                    fill: 'Rellenar',
                    text: 'Texto',
                    line: 'L√≠nea',
                    arrowRight: 'Flecha derecha',
                    arrowLeft: 'Flecha izquierda',
                    rect: 'Rect√°ngulo',
                    circle: 'C√≠rculo',
                    triangle: 'Tri√°ngulo'
                },
                modal: {
                    newCanvas: 'üìÑ Nuevo lienzo',
                    width: 'Ancho (px)',
                    height: 'Alto (px)',
                    create: 'Crear'
                },
                faq_title: 'Preguntas frecuentes',
                faq1Q: '¬øQu√© herramientas de dibujo se soportan?',
                faq1A: 'Soporta l√°piz, pincel, l√≠nea, rect√°ngulo, c√≠rculo, borrador y otras herramientas. Cada herramienta puede ajustar tama√±o y opacidad.',
                faq2Q: '¬øPuedo ajustar el tama√±o del pincel?',
                faq2A: 'S√≠, soporta ajuste de 1px a 50px. Puede usar el deslizador o la rueda del rat√≥n.',
                faq3Q: '¬øC√≥mo guardar la obra?',
                faq3A: 'Haga clic en "Guardar PNG" o "Guardar JPG" en la parte inferior para exportar su obra como archivo de imagen.',
                faq4Q: '¬øSoporta dibujo t√°ctil?',
                faq4A: 'S√≠, puede dibujar con el dedo o l√°piz en tabletas o pantallas t√°ctiles.',
                faq5Q: '¬øPuedo abrir im√°genes existantes?',
                faq5A: 'Puede importar im√°genes como fondo y dibujar sobre ellas, conveniente para anotaciones.',
                faq_free_q: '¬øEsta herramienta es realmente gratuita sin anuncios?',
                faq_free_a: 'S√≠, 100% gratuita sin anuncios, sin registro, sin marca de agua y sin l√≠mites de uso.',
                related_title: 'üîó Herramientas relacionadas',
                related_1: 'Paleta de colores',
                related_1_desc: 'Selecci√≥n y conversi√≥n',
                related_2: 'Editor de im√°genes',
                related_2_desc: 'Recortar, rotar, filtros',
                related_3: 'Convertidor de im√°genes',
                related_3_desc: 'Conversi√≥n PNG/JPG/WebP',
                related_4: 'Creador de ICO',
                related_4_desc: 'Generar iconos web',
                toast: {
                    undoSuccess: 'Deshacer exitoso',
                    redoSuccess: 'Rehacer exitoso',
                    canvasCleared: 'Lienzo limpiado',
                    newCanvasCreated: 'Nuevo lienzo creado',
                    sizeRange: 'El tama√±o debe estar entre 100-3000',
                    imageSaved: 'Imagen guardada como',
                    textAdded: 'Texto a√±adido, arrastrar para mover',
                    textDeleted: 'Texto eliminado',
                    enterText: 'Por favor ingrese el contenido',
                    confirmClear: '¬øEst√° seguro de que desea limpiar?',
                    confirmClearWithText: '¬øEst√° seguro de que desea limpiar? (incluyendo texto)'
                },
                langName: 'üåê Espa√±ol',
                trust_users: 'üåç Usado por m√°s de 50,000 usuarios',
                trust_rating: '‚≠ê Calificaci√≥n 4.9/5',
                trust_privacy: 'üîí 100% Privado',
                trust_free: 'üö´ Sin anuncios, sin registro'
            }
        };

        // ÁîªÂ∏ÉÂíå‰∏ä‰∏ãÊñá
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const previewCanvas = document.getElementById('previewCanvas');
        const previewCtx = previewCanvas.getContext('2d');

        // Áä∂ÊÄÅÂèòÈáè
        let isDrawing = false;
        let currentTool = 'brush';
        let currentColor = '#000000';
        let brushSize = 5;
        let opacity = 1;
        let lastX = 0;
        let lastY = 0;
        let startX = 0;
        let startY = 0;
        let fillShape = false;

        // ÂéÜÂè≤ËÆ∞ÂΩï
        let history = [];
        let historyIndex = -1;
        const maxHistory = 50;

        // Â∑•ÂÖ∑ÂêçÁß∞Êò†Â∞ÑÔºà‰ΩøÁî® i18nÔºâ
        function getToolName(tool) {
            return i18n[WebToolbox.getCurrentLang()].tool[tool] || tool;
        }

        // Âø´Êç∑ÈîÆÊò†Â∞Ñ
        const shortcuts = {
            'b': 'brush',
            'e': 'eraser',
            'g': 'fill',
            'x': 'text',
            'l': 'line',
            'a': 'arrowRight',
            's': 'arrowLeft',
            'r': 'rect',
            'c': 'circle',
            't': 'triangle'
        };

        // ÊñáÊú¨Áõ∏ÂÖ≥ÂèòÈáè
        let textObjects = [];
        let selectedTextObject = null;
        let isDraggingText = false;
        let textDragOffsetX = 0;
        let textDragOffsetY = 0;
        let pendingTextX = 0;
        let pendingTextY = 0;
        let editingTextId = null;

        // ÂàùÂßãÂåñ
        function init() {
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            saveHistory();

            // ÁªëÂÆöÂ∑•ÂÖ∑ÊåâÈíÆ‰∫ã‰ª∂
            document.querySelectorAll('.tool-btn[data-tool]').forEach(btn => {
                btn.addEventListener('click', () => selectTool(btn.dataset.tool));
            });

            // Â°´ÂÖÖÂΩ¢Áä∂ÂàáÊç¢
            document.getElementById('fillShape').addEventListener('change', (e) => {
                fillShape = e.target.checked;
            });

            // È¢úËâ≤ÈÄâÊã©Âô®
            const colorPicker = document.getElementById('colorPicker');
            const colorBtn = document.getElementById('colorBtn');
            colorPicker.addEventListener('input', (e) => {
                currentColor = e.target.value;
                colorBtn.style.background = currentColor;
                updateColorPresets();
            });

            // È¢ÑËÆæÈ¢úËâ≤
            document.querySelectorAll('.color-preset').forEach(preset => {
                preset.addEventListener('click', () => {
                    currentColor = preset.dataset.color;
                    colorBtn.style.background = currentColor;
                    colorPicker.value = currentColor;
                    updateColorPresets();
                });
            });

            // ÁîªÁ¨îÂ§ßÂ∞è
            const brushSizeSlider = document.getElementById('brushSize');
            const brushSizeValue = document.getElementById('brushSizeValue');
            brushSizeSlider.addEventListener('input', (e) => {
                brushSize = parseInt(e.target.value);
                brushSizeValue.textContent = brushSize;
            });

            // ÈÄèÊòéÂ∫¶
            const opacitySlider = document.getElementById('opacity');
            const opacityValue = document.getElementById('opacityValue');
            opacitySlider.addEventListener('input', (e) => {
                opacity = parseInt(e.target.value) / 100;
                opacityValue.textContent = e.target.value + '%';
            });

            // ÁîªÂ∏É‰∫ã‰ª∂
            const wrapper = document.getElementById('canvasWrapper');
            wrapper.addEventListener('mousedown', startDrawing);
            wrapper.addEventListener('mousemove', draw);
            wrapper.addEventListener('mouseup', stopDrawing);
            wrapper.addEventListener('mouseleave', stopDrawing);
            wrapper.addEventListener('mousemove', updateMousePos);

            // ÊªöËΩÆË∞ÉÊï¥Á≤óÁªÜ
            wrapper.addEventListener('wheel', (e) => {
                e.preventDefault();
                const delta = e.deltaY > 0 ? -1 : 1;
                brushSize = Math.max(1, Math.min(50, brushSize + delta));
                brushSizeSlider.value = brushSize;
                brushSizeValue.textContent = brushSize;
                showToast(`${i18n[WebToolbox.getCurrentLang()].size}: ${brushSize}px`);
            });

            // Ëß¶Êë∏ÊîØÊåÅ
            wrapper.addEventListener('touchstart', handleTouch);
            wrapper.addEventListener('touchmove', handleTouch);
            wrapper.addEventListener('touchend', stopDrawing);

            // ÈîÆÁõòÂø´Êç∑ÈîÆ
            document.addEventListener('keydown', handleKeyboard);

            // ËØ≠Ë®ÄÁî± common.js ÂàùÂßãÂåñ
        }

        // ÈÄâÊã©Â∑•ÂÖ∑
        function selectTool(tool) {
            document.querySelectorAll('.tool-btn[data-tool]').forEach(b => b.classList.remove('active'));
            document.querySelector(`[data-tool="${tool}"]`).classList.add('active');
            currentTool = tool;
            document.getElementById('currentTool').textContent = getToolName(tool);

            // Ê†πÊçÆÂ∑•ÂÖ∑Á±ªÂûãËÆæÁΩÆÂÖâÊ†á
            let cursor = 'crosshair';
            if (tool === 'fill') cursor = 'cell';
            else if (tool === 'text') cursor = 'text';
            canvas.style.cursor = cursor;
            previewCanvas.style.cursor = cursor;

            // ÂàáÊç¢Â∑•ÂÖ∑Êó∂ÈöêËóèÊñáÊú¨Èù¢Êùø
            if (tool !== 'text') {
                hideTextPanel();
            }
        }

        // ÈîÆÁõò‰∫ã‰ª∂Â§ÑÁêÜ
        function handleKeyboard(e) {
            if (e.ctrlKey && e.key === 'z') {
                e.preventDefault();
                undo();
            } else if (e.ctrlKey && e.key === 'y') {
                e.preventDefault();
                redo();
            } else if (shortcuts[e.key.toLowerCase()] && !e.ctrlKey && !e.altKey) {
                selectTool(shortcuts[e.key.toLowerCase()]);
            }
        }

        // Êõ¥Êñ∞È¢úËâ≤È¢ÑËÆæÊøÄÊ¥ªÁä∂ÊÄÅ
        function updateColorPresets() {
            document.querySelectorAll('.color-preset').forEach(preset => {
                preset.classList.toggle('active', preset.dataset.color.toLowerCase() === currentColor.toLowerCase());
            });
        }

        // Ëé∑ÂèñÁîªÂ∏ÉÂùêÊ†á
        function getCanvasCoords(e) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            return {
                x: (e.clientX - rect.left) * scaleX,
                y: (e.clientY - rect.top) * scaleY
            };
        }

        // ÂºÄÂßãÁªòÁîª
        function startDrawing(e) {
            // Â¶ÇÊûúÁÇπÂáªÁöÑÊòØÊñáÊú¨Èù¢ÊùøÂÜÖÈÉ®Ôºå‰∏çÂ§ÑÁêÜ
            const textPanel = document.getElementById('textPanel');
            if (textPanel.contains(e.target)) {
                return;
            }

            const coords = getCanvasCoords(e);

            // ÊñáÊú¨Â∑•ÂÖ∑ÁâπÊÆäÂ§ÑÁêÜ
            if (currentTool === 'text') {
                // Â¶ÇÊûúÈù¢ÊùøÂ∑≤ÁªèÊâìÂºÄÔºåÂÖàÂÖ≥Èó≠
                if (textPanel.classList.contains('active')) {
                    return;
                }
                // ÁÇπÂáªÁîªÂ∏ÉÊó∂ÊòæÁ§∫ÊñáÊú¨ÁºñËæëÈù¢Êùø
                showTextPanel(e.clientX, e.clientY, coords.x, coords.y);
                return;
            }

            isDrawing = true;
            lastX = coords.x;
            lastY = coords.y;
            startX = coords.x;
            startY = coords.y;

            if (currentTool === 'fill') {
                floodFill(Math.floor(coords.x), Math.floor(coords.y), hexToRgb(currentColor));
                saveHistory();
            } else if (currentTool === 'brush' || currentTool === 'eraser') {
                ctx.beginPath();
                ctx.arc(coords.x, coords.y, brushSize / 2, 0, Math.PI * 2);
                ctx.fillStyle = currentTool === 'eraser' ? '#ffffff' : currentColor;
                ctx.globalAlpha = currentTool === 'eraser' ? 1 : opacity;
                ctx.fill();
                ctx.globalAlpha = 1;
            }
        }

        // ÁªòÁîª‰∏≠
        function draw(e) {
            const coords = getCanvasCoords(e);

            if (!isDrawing) return;

            if (currentTool === 'brush' || currentTool === 'eraser') {
                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(coords.x, coords.y);
                ctx.strokeStyle = currentTool === 'eraser' ? '#ffffff' : currentColor;
                ctx.lineWidth = brushSize;
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';
                ctx.globalAlpha = currentTool === 'eraser' ? 1 : opacity;
                ctx.stroke();
                ctx.globalAlpha = 1;
                lastX = coords.x;
                lastY = coords.y;
            } else if (['line', 'arrowRight', 'arrowLeft', 'rect', 'circle', 'triangle'].includes(currentTool)) {
                // ÂÆûÊó∂È¢ÑËßàÂΩ¢Áä∂
                drawShapePreview(coords.x, coords.y);
            }
        }

        // ÁªòÂà∂ÁÆ≠Â§¥ËæÖÂä©ÂáΩÊï∞
        function drawArrowHead(ctx, fromX, fromY, toX, toY, headLen) {
            const angle = Math.atan2(toY - fromY, toX - fromX);
            ctx.beginPath();
            ctx.moveTo(toX, toY);
            ctx.lineTo(toX - headLen * Math.cos(angle - Math.PI / 6), toY - headLen * Math.sin(angle - Math.PI / 6));
            ctx.moveTo(toX, toY);
            ctx.lineTo(toX - headLen * Math.cos(angle + Math.PI / 6), toY - headLen * Math.sin(angle + Math.PI / 6));
            ctx.stroke();
        }

        // ÁªòÂà∂ÂΩ¢Áä∂È¢ÑËßà
        function drawShapePreview(endX, endY) {
            // Ê∏ÖÈô§È¢ÑËßàÁîªÂ∏É
            previewCtx.clearRect(0, 0, previewCanvas.width, previewCanvas.height);

            previewCtx.beginPath();
            previewCtx.strokeStyle = currentColor;
            previewCtx.fillStyle = currentColor;
            previewCtx.lineWidth = brushSize;
            previewCtx.globalAlpha = opacity;
            previewCtx.lineCap = 'round';
            previewCtx.lineJoin = 'round';

            // ÁÆ≠Â§¥Â§¥ÈÉ®ÈïøÂ∫¶ÔºåÊ†πÊçÆÁ∫øÊù°Á≤óÁªÜÂä®ÊÄÅË∞ÉÊï¥
            const arrowHeadLen = Math.max(15, brushSize * 3);

            switch (currentTool) {
                case 'line':
                    previewCtx.moveTo(startX, startY);
                    previewCtx.lineTo(endX, endY);
                    previewCtx.stroke();
                    break;
                case 'arrowRight':
                    // ÁîªÁõ¥Á∫ø
                    previewCtx.moveTo(startX, startY);
                    previewCtx.lineTo(endX, endY);
                    previewCtx.stroke();
                    // ÁîªÁÆ≠Â§¥ÔºàÂú®ÁªàÁÇπÔºâ
                    drawArrowHead(previewCtx, startX, startY, endX, endY, arrowHeadLen);
                    break;
                case 'arrowLeft':
                    // ÁîªÁõ¥Á∫ø
                    previewCtx.moveTo(startX, startY);
                    previewCtx.lineTo(endX, endY);
                    previewCtx.stroke();
                    // ÁîªÁÆ≠Â§¥ÔºàÂú®Ëµ∑ÁÇπÔºåÊñπÂêëÁõ∏ÂèçÔºâ
                    drawArrowHead(previewCtx, endX, endY, startX, startY, arrowHeadLen);
                    break;
                case 'rect':
                    if (fillShape) {
                        previewCtx.fillRect(startX, startY, endX - startX, endY - startY);
                    } else {
                        previewCtx.strokeRect(startX, startY, endX - startX, endY - startY);
                    }
                    break;
                case 'circle':
                    const radiusX = Math.abs(endX - startX) / 2;
                    const radiusY = Math.abs(endY - startY) / 2;
                    const centerX = startX + (endX - startX) / 2;
                    const centerY = startY + (endY - startY) / 2;
                    previewCtx.beginPath();
                    previewCtx.ellipse(centerX, centerY, radiusX, radiusY, 0, 0, Math.PI * 2);
                    if (fillShape) {
                        previewCtx.fill();
                    } else {
                        previewCtx.stroke();
                    }
                    break;
                case 'triangle':
                    previewCtx.moveTo(startX + (endX - startX) / 2, startY);
                    previewCtx.lineTo(endX, endY);
                    previewCtx.lineTo(startX, endY);
                    previewCtx.closePath();
                    if (fillShape) {
                        previewCtx.fill();
                    } else {
                        previewCtx.stroke();
                    }
                    break;
            }

            previewCtx.globalAlpha = 1;
        }

        // ÂÅúÊ≠¢ÁªòÁîª
        function stopDrawing(e) {
            if (!isDrawing) return;

            if (['line', 'arrowRight', 'arrowLeft', 'rect', 'circle', 'triangle'].includes(currentTool)) {
                const coords = getCanvasCoords(e);

                // Ê∏ÖÈô§È¢ÑËßà
                previewCtx.clearRect(0, 0, previewCanvas.width, previewCanvas.height);

                // ÁªòÂà∂Âà∞‰∏ªÁîªÂ∏É
                ctx.beginPath();
                ctx.strokeStyle = currentColor;
                ctx.fillStyle = currentColor;
                ctx.lineWidth = brushSize;
                ctx.globalAlpha = opacity;
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';

                // ÁÆ≠Â§¥Â§¥ÈÉ®ÈïøÂ∫¶
                const arrowHeadLen = Math.max(15, brushSize * 3);

                switch (currentTool) {
                    case 'line':
                        ctx.moveTo(startX, startY);
                        ctx.lineTo(coords.x, coords.y);
                        ctx.stroke();
                        break;
                    case 'arrowRight':
                        // ÁîªÁõ¥Á∫ø
                        ctx.moveTo(startX, startY);
                        ctx.lineTo(coords.x, coords.y);
                        ctx.stroke();
                        // ÁîªÁÆ≠Â§¥ÔºàÂú®ÁªàÁÇπÔºâ
                        drawArrowHead(ctx, startX, startY, coords.x, coords.y, arrowHeadLen);
                        break;
                    case 'arrowLeft':
                        // ÁîªÁõ¥Á∫ø
                        ctx.moveTo(startX, startY);
                        ctx.lineTo(coords.x, coords.y);
                        ctx.stroke();
                        // ÁîªÁÆ≠Â§¥ÔºàÂú®Ëµ∑ÁÇπÔºåÊñπÂêëÁõ∏ÂèçÔºâ
                        drawArrowHead(ctx, coords.x, coords.y, startX, startY, arrowHeadLen);
                        break;
                    case 'rect':
                        if (fillShape) {
                            ctx.fillRect(startX, startY, coords.x - startX, coords.y - startY);
                        } else {
                            ctx.strokeRect(startX, startY, coords.x - startX, coords.y - startY);
                        }
                        break;
                    case 'circle':
                        const radiusX = Math.abs(coords.x - startX) / 2;
                        const radiusY = Math.abs(coords.y - startY) / 2;
                        const centerX = startX + (coords.x - startX) / 2;
                        const centerY = startY + (coords.y - startY) / 2;
                        ctx.beginPath();
                        ctx.ellipse(centerX, centerY, radiusX, radiusY, 0, 0, Math.PI * 2);
                        if (fillShape) {
                            ctx.fill();
                        } else {
                            ctx.stroke();
                        }
                        break;
                    case 'triangle':
                        ctx.moveTo(startX + (coords.x - startX) / 2, startY);
                        ctx.lineTo(coords.x, coords.y);
                        ctx.lineTo(startX, coords.y);
                        ctx.closePath();
                        if (fillShape) {
                            ctx.fill();
                        } else {
                            ctx.stroke();
                        }
                        break;
                }

                ctx.globalAlpha = 1;
            }

            isDrawing = false;

            if (currentTool !== 'fill') {
                saveHistory();
            }
        }

        // Ëß¶Êë∏‰∫ã‰ª∂Â§ÑÁêÜ
        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 'mousemove', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            if (e.type === 'touchstart') {
                startDrawing(mouseEvent);
            } else {
                draw(mouseEvent);
            }
        }

        // Êõ¥Êñ∞Èº†Ê†á‰ΩçÁΩÆÊòæÁ§∫
        function updateMousePos(e) {
            const coords = getCanvasCoords(e);
            document.getElementById('mousePos').textContent = `${Math.floor(coords.x)}, ${Math.floor(coords.y)}`;
        }

        // Â°´ÂÖÖÁÆóÊ≥ï
        function floodFill(x, y, fillColor) {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            const width = canvas.width;
            const height = canvas.height;

            const targetColor = getPixelColor(data, x, y, width);

            if (colorsMatch(targetColor, fillColor)) return;

            const stack = [[x, y]];

            while (stack.length > 0) {
                const [cx, cy] = stack.pop();

                if (cx < 0 || cx >= width || cy < 0 || cy >= height) continue;

                const currentColor = getPixelColor(data, cx, cy, width);

                if (!colorsMatch(currentColor, targetColor)) continue;

                setPixelColor(data, cx, cy, width, fillColor);

                stack.push([cx + 1, cy]);
                stack.push([cx - 1, cy]);
                stack.push([cx, cy + 1]);
                stack.push([cx, cy - 1]);
            }

            ctx.putImageData(imageData, 0, 0);
        }

        function getPixelColor(data, x, y, width) {
            const index = (y * width + x) * 4;
            return { r: data[index], g: data[index + 1], b: data[index + 2], a: data[index + 3] };
        }

        function setPixelColor(data, x, y, width, color) {
            const index = (y * width + x) * 4;
            data[index] = color.r;
            data[index + 1] = color.g;
            data[index + 2] = color.b;
            data[index + 3] = 255;
        }

        function colorsMatch(c1, c2) {
            return c1.r === c2.r && c1.g === c2.g && c1.b === c2.b;
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : { r: 0, g: 0, b: 0 };
        }

        // ÂéÜÂè≤ËÆ∞ÂΩï
        function saveHistory() {
            historyIndex++;
            history = history.slice(0, historyIndex);
            history.push(canvas.toDataURL());
            if (history.length > maxHistory) {
                history.shift();
                historyIndex--;
            }
        }

        function undo() {
            if (historyIndex > 0) {
                historyIndex--;
                loadHistory();
                showToast(i18n[WebToolbox.getCurrentLang()].toast.undoSuccess);
            }
        }

        function redo() {
            if (historyIndex < history.length - 1) {
                historyIndex++;
                loadHistory();
                showToast(i18n[WebToolbox.getCurrentLang()].toast.redoSuccess);
            }
        }

        function loadHistory() {
            const img = new Image();
            img.onload = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0);
            };
            img.src = history[historyIndex];
        }

        // Ê∏ÖÁ©∫ÁîªÂ∏É
        function clearCanvas() {
            if (confirm(i18n[WebToolbox.getCurrentLang()].toast.confirmClearWithText)) {
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                clearTextLayer();
                saveHistory();
                showToast(i18n[WebToolbox.getCurrentLang()].toast.canvasCleared);
            }
        }

        // ‰øùÂ≠òÂõæÁâá
        function saveImage(format) {
            // ÂÖàÂ∞ÜÊñáÊú¨Ê∏≤ÊüìÂà∞ÁîªÂ∏É
            renderAllTextToCanvas();

            const link = document.createElement('a');
            const timestamp = new Date().toISOString().slice(0, 19).replace(/[:-]/g, '');

            if (format === 'jpg') {
                const tempCanvas = document.createElement('canvas');
                tempCanvas.width = canvas.width;
                tempCanvas.height = canvas.height;
                const tempCtx = tempCanvas.getContext('2d');
                tempCtx.fillStyle = '#ffffff';
                tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
                tempCtx.drawImage(canvas, 0, 0);
                link.href = tempCanvas.toDataURL('image/jpeg', 0.9);
                link.download = `paint_${timestamp}.jpg`;
            } else {
                link.href = canvas.toDataURL('image/png');
                link.download = `paint_${timestamp}.png`;
            }

            link.click();
            showToast(`${i18n[WebToolbox.getCurrentLang()].toast.imageSaved} ${format.toUpperCase()}`);

            // ‰øùÂ≠òÂêéÊÅ¢Â§çÂéÜÂè≤ËÆ∞ÂΩï
            saveHistory();
        }

        // Êñ∞Âª∫ÁîªÂ∏ÉÊ®°ÊÄÅÊ°Ü
        function showNewCanvasModal() {
            document.getElementById('newCanvasModal').classList.add('active');
        }

        function hideNewCanvasModal() {
            document.getElementById('newCanvasModal').classList.remove('active');
        }

        function setCanvasSize(width, height) {
            document.getElementById('canvasWidth').value = width;
            document.getElementById('canvasHeight').value = height;
        }

        function createNewCanvas() {
            const width = parseInt(document.getElementById('canvasWidth').value);
            const height = parseInt(document.getElementById('canvasHeight').value);

            if (width < 100 || width > 3000 || height < 100 || height > 3000) {
                showToast(i18n[WebToolbox.getCurrentLang()].toast.sizeRange, true);
                return;
            }

            canvas.width = width;
            canvas.height = height;
            previewCanvas.width = width;
            previewCanvas.height = height;

            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, width, height);
            document.getElementById('canvasSize').textContent = `${width} √ó ${height}`;

            history = [];
            historyIndex = -1;
            saveHistory();

            hideNewCanvasModal();
            showToast(`${i18n[WebToolbox.getCurrentLang()].toast.newCanvasCreated} (${width}√ó${height})`);
        }

        // Toast ÊèêÁ§∫
        function showToast(message, isError = false) {
            // ÁßªÈô§Â∑≤ÊúâÁöÑ toast
            document.querySelectorAll('.toast').forEach(t => t.remove());

            const toast = document.createElement('div');
            toast.className = 'toast' + (isError ? ' error' : '');
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 1500);
        }
        function showTextPanel(clientX, clientY, canvasX, canvasY) {
            const panel = document.getElementById('textPanel');
            const wrapper = document.getElementById('canvasWrapper');
            const wrapperRect = wrapper.getBoundingClientRect();

            // ËÆ∞ÂΩïÁîªÂ∏ÉÂùêÊ†á
            pendingTextX = canvasX;
            pendingTextY = canvasY;

            // ËÆ°ÁÆóÈù¢Êùø‰ΩçÁΩÆÔºàÁõ∏ÂØπ‰∫é wrapperÔºâ
            let panelX = clientX - wrapperRect.left + 10;
            let panelY = clientY - wrapperRect.top + 10;

            // Á°Æ‰øùÈù¢Êùø‰∏çË∂ÖÂá∫Âè≥ËæπÁïå
            if (panelX + 280 > wrapperRect.width) {
                panelX = clientX - wrapperRect.left - 290;
            }
            // Á°Æ‰øùÈù¢Êùø‰∏çË∂ÖÂá∫‰∏ãËæπÁïå
            if (panelY + 250 > wrapperRect.height) {
                panelY = clientY - wrapperRect.top - 260;
            }

            panel.style.left = Math.max(10, panelX) + 'px';
            panel.style.top = Math.max(10, panelY) + 'px';
            panel.classList.add('active');

            // Â¶ÇÊûúÊòØÁºñËæëÊ®°ÂºèÔºåÂ°´ÂÖÖÁé∞ÊúâÊñáÊú¨‰ø°ÊÅØ
            if (editingTextId !== null) {
                const textObj = textObjects.find(t => t.id === editingTextId);
                if (textObj) {
                    document.getElementById('textContent').value = textObj.content;
                    document.getElementById('textFont').value = textObj.font;
                    document.getElementById('textSize').value = textObj.size;
                    document.getElementById('textColor').value = textObj.color;
                    document.getElementById('textBold').checked = textObj.bold;
                    document.getElementById('textItalic').checked = textObj.italic;
                }
            } else {
                // Êñ∞Âª∫ÊñáÊú¨Êó∂Ê∏ÖÁ©∫ËæìÂÖ•
                document.getElementById('textContent').value = '';
                document.getElementById('textColor').value = currentColor;
            }

            // ËÅöÁÑ¶Âà∞ÊñáÊú¨ËæìÂÖ•Ê°Ü
            setTimeout(() => document.getElementById('textContent').focus(), 100);
        }

        // ÈöêËóèÊñáÊú¨ÁºñËæëÈù¢Êùø
        function hideTextPanel() {
            document.getElementById('textPanel').classList.remove('active');
            editingTextId = null;
        }

        // Á°ÆËÆ§Ê∑ªÂä†/ÁºñËæëÊñáÊú¨
        function confirmText() {
            const content = document.getElementById('textContent').value.trim();
            if (!content) {
                showToast(i18n[WebToolbox.getCurrentLang()].toast.enterText, true);
                return;
            }

            const font = document.getElementById('textFont').value;
            const size = parseInt(document.getElementById('textSize').value) || 24;
            const color = document.getElementById('textColor').value;
            const bold = document.getElementById('textBold').checked;
            const italic = document.getElementById('textItalic').checked;

            if (editingTextId !== null) {
                // Êõ¥Êñ∞Áé∞ÊúâÊñáÊú¨
                updateTextObject(editingTextId, { content, font, size, color, bold, italic });
            } else {
                // ÂàõÂª∫Êñ∞ÊñáÊú¨
                createTextObject(pendingTextX, pendingTextY, content, font, size, color, bold, italic);
            }

            hideTextPanel();
        }

        // ÂàõÂª∫ÊñáÊú¨ÂØπË±°
        function createTextObject(x, y, content, font, size, color, bold, italic) {
            const id = Date.now();
            const textObj = {
                id, x, y, content, font, size, color, bold, italic
            };
            textObjects.push(textObj);
            renderTextObject(textObj);
            showToast(i18n[WebToolbox.getCurrentLang()].toast.textAdded);
        }

        // Ê∏≤ÊüìÊñáÊú¨ÂØπË±°Âà∞ DOM
        function renderTextObject(textObj) {
            const layer = document.getElementById('textLayer');
            const rect = canvas.getBoundingClientRect();
            const scaleX = rect.width / canvas.width;
            const scaleY = rect.height / canvas.height;

            const div = document.createElement('div');
            div.className = 'text-object';
            div.id = 'text-' + textObj.id;
            div.textContent = textObj.content;
            div.style.left = (textObj.x * scaleX) + 'px';
            div.style.top = (textObj.y * scaleY) + 'px';
            div.style.fontFamily = textObj.font;
            div.style.fontSize = (textObj.size * scaleY) + 'px';
            div.style.color = textObj.color;
            div.style.fontWeight = textObj.bold ? 'bold' : 'normal';
            div.style.fontStyle = textObj.italic ? 'italic' : 'normal';

            // ÊãñÂä®‰∫ã‰ª∂
            div.addEventListener('mousedown', (e) => startDragText(e, textObj.id));
            // ÂèåÂáªÁºñËæë
            div.addEventListener('dblclick', (e) => editTextObject(e, textObj.id));

            layer.appendChild(div);
        }

        // Êõ¥Êñ∞ÊñáÊú¨ÂØπË±°
        function updateTextObject(id, props) {
            const textObj = textObjects.find(t => t.id === id);
            if (!textObj) return;

            Object.assign(textObj, props);

            // Êõ¥Êñ∞ DOM
            const div = document.getElementById('text-' + id);
            if (div) {
                const rect = canvas.getBoundingClientRect();
                const scaleY = rect.height / canvas.height;

                div.textContent = textObj.content;
                div.style.fontFamily = textObj.font;
                div.style.fontSize = (textObj.size * scaleY) + 'px';
                div.style.color = textObj.color;
                div.style.fontWeight = textObj.bold ? 'bold' : 'normal';
                div.style.fontStyle = textObj.italic ? 'italic' : 'normal';
            }
        }

        // ÂºÄÂßãÊãñÂä®ÊñáÊú¨
        function startDragText(e, id) {
            e.stopPropagation();
            e.preventDefault();

            isDraggingText = true;
            selectedTextObject = id;

            const div = document.getElementById('text-' + id);
            div.classList.add('selected');

            const rect = div.getBoundingClientRect();
            textDragOffsetX = e.clientX - rect.left;
            textDragOffsetY = e.clientY - rect.top;

            document.addEventListener('mousemove', dragText);
            document.addEventListener('mouseup', stopDragText);
        }

        // ÊãñÂä®ÊñáÊú¨
        function dragText(e) {
            if (!isDraggingText || !selectedTextObject) return;

            const wrapper = document.getElementById('canvasWrapper');
            const wrapperRect = wrapper.getBoundingClientRect();
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;

            // ËÆ°ÁÆóÊñ∞‰ΩçÁΩÆ
            let newX = e.clientX - wrapperRect.left - textDragOffsetX;
            let newY = e.clientY - wrapperRect.top - textDragOffsetY;

            // ÈôêÂà∂Âú®ÁîªÂ∏ÉËåÉÂõ¥ÂÜÖ
            newX = Math.max(0, Math.min(newX, rect.width - 50));
            newY = Math.max(0, Math.min(newY, rect.height - 20));

            const div = document.getElementById('text-' + selectedTextObject);
            if (div) {
                div.style.left = newX + 'px';
                div.style.top = newY + 'px';

                // Êõ¥Êñ∞ÊñáÊú¨ÂØπË±°ÂùêÊ†á
                const textObj = textObjects.find(t => t.id === selectedTextObject);
                if (textObj) {
                    textObj.x = newX * scaleX;
                    textObj.y = newY * scaleY;
                }
            }
        }

        // ÂÅúÊ≠¢ÊãñÂä®ÊñáÊú¨
        function stopDragText() {
            isDraggingText = false;

            if (selectedTextObject) {
                const div = document.getElementById('text-' + selectedTextObject);
                if (div) {
                    div.classList.remove('selected');
                }
            }

            selectedTextObject = null;
            document.removeEventListener('mousemove', dragText);
            document.removeEventListener('mouseup', stopDragText);
        }

        // ÂèåÂáªÁºñËæëÊñáÊú¨
        function editTextObject(e, id) {
            e.stopPropagation();
            editingTextId = id;

            const textObj = textObjects.find(t => t.id === id);
            if (!textObj) return;

            showTextPanel(e.clientX, e.clientY, textObj.x, textObj.y);
        }

        // Â∞ÜÊâÄÊúâÊñáÊú¨Ê∏≤ÊüìÂà∞ÁîªÂ∏É‰∏äÔºà‰øùÂ≠òÊó∂Ë∞ÉÁî®Ôºâ
        function renderAllTextToCanvas() {
            textObjects.forEach(textObj => {
                ctx.save();
                ctx.font = `${textObj.italic ? 'italic ' : ''}${textObj.bold ? 'bold ' : ''}${textObj.size}px "${textObj.font}"`;
                ctx.fillStyle = textObj.color;
                ctx.textBaseline = 'top';

                // Â§ÑÁêÜÂ§öË°åÊñáÊú¨
                const lines = textObj.content.split('\n');
                lines.forEach((line, index) => {
                    ctx.fillText(line, textObj.x, textObj.y + index * textObj.size * 1.2);
                });

                ctx.restore();
            });
        }

        // Ê∏ÖÁ©∫ÊñáÊú¨Â±Ç
        function clearTextLayer() {
            document.getElementById('textLayer').innerHTML = '';
            textObjects = [];
        }

        // Âà†Èô§ÈÄâ‰∏≠ÁöÑÊñáÊú¨ÔºàÊåâ Delete ÈîÆÔºâ
        function deleteSelectedText() {
            if (selectedTextObject) {
                const div = document.getElementById('text-' + selectedTextObject);
                if (div) div.remove();
                textObjects = textObjects.filter(t => t.id !== selectedTextObject);
                selectedTextObject = null;
                showToast(i18n[WebToolbox.getCurrentLang()].toast.textDeleted);
            }
        }

        // Êõ¥Êñ∞ÈîÆÁõò‰∫ã‰ª∂Â§ÑÁêÜÔºåÊ∑ªÂä†Âà†Èô§ÊñáÊú¨ÊîØÊåÅ
        const originalHandleKeyboard = handleKeyboard;
        handleKeyboard = function(e) {
            // Â¶ÇÊûúÊ≠£Âú®ÁºñËæëÊñáÊú¨Èù¢ÊùøÔºå‰∏çÂ§ÑÁêÜÂø´Êç∑ÈîÆ
            if (document.getElementById('textPanel').classList.contains('active')) {
                if (e.key === 'Escape') {
                    hideTextPanel();
                }
                return;
            }

            // Âà†Èô§ÈÄâ‰∏≠ÁöÑÊñáÊú¨
            if (e.key === 'Delete' || e.key === 'Backspace') {
                if (selectedTextObject) {
                    e.preventDefault();
                    deleteSelectedText();
                    return;
                }
            }

            originalHandleKeyboard(e);
        };

        // ÂàùÂßãÂåñ
        init();

        window._translations = i18n;
    </script>
    <script src="common/common.js" data-tool-id="paint-board" data-tool-name="Paint Board" data-category="image"></script>
    <script>WebToolbox.init(window._translations);</script>
</body>
</html>
