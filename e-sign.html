<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CT8E5N460D"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-CT8E5N460D');</script>
  <title>E-Sign Tool - Free Online PDF Signature | No Ads, No Signup | ç”µå­ç­¾åå·¥å…· | Web Toolbox</title>
  <meta name="description" content="Free online electronic signature tool to sign PDF in browser. Draw your signature and place it on any PDF page. âœ… No ads âœ… No signup âœ… No limits.">
  <meta name="keywords" content="sign pdf online,electronic signature,pdf signature tool,ç”µå­ç­¾å,åœ¨çº¿ç­¾å,no ads,no signup,no login,no watermark,free unlimited,browser-based,no installation,local processing">
  <meta name="author" content="UseMagicTools"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name="googlebot" content="index, follow"><meta name="bingbot" content="index, follow"><meta name="revisit-after" content="7 days"><meta name="rating" content="general"><meta name="distribution" content="global"><meta name="language" content="en">
  <link rel="canonical" href="https://www.usemagictools.com/e-sign.html"><link rel="alternate" hreflang="en" href="https://www.usemagictools.com/e-sign.html"><link rel="alternate" hreflang="zh-CN" href="https://www.usemagictools.com/e-sign.html"><link rel="alternate" hreflang="fr" href="https://www.usemagictools.com/e-sign.html"><link rel="alternate" hreflang="es" href="https://www.usemagictools.com/e-sign.html"><link rel="alternate" hreflang="x-default" href="https://www.usemagictools.com/e-sign.html">
  <meta property="og:type" content="website"><meta property="og:url" content="https://www.usemagictools.com/e-sign.html"><meta property="og:title" content="E-Sign Tool - Free Online PDF Signature | No Ads, No Signup"><meta property="og:description" content="Draw signature and add it to PDF pages online."><meta property="og:image" content="https://www.usemagictools.com/screenshots/e-sign-v1.webp"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="og:locale" content="en_US"><meta property="og:locale:alternate" content="zh_CN"><meta property="og:site_name" content="Web Toolbox">
  <meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@usemagictools"><meta name="twitter:creator" content="@usemagictools"><meta name="twitter:title" content="E-Sign Tool - Free Online PDF Signature | No Ads, No Signup"><meta name="twitter:description" content="Electronic signature workflow for PDF files."><meta name="twitter:image" content="https://www.usemagictools.com/screenshots/e-sign-v1.webp">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"WebApplication","name":"E-Sign Tool","alternateName":["ç”µå­ç­¾åå·¥å…·","Sign PDF Online","Electronic Signature"],"url":"https://www.usemagictools.com/e-sign.html","description":"Free online tool to draw electronic signature and sign PDF files.","inLanguage":["en","zh-CN","fr","es"],"applicationCategory":"UtilitiesApplication","operatingSystem":"Web Browser","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"author":{"@type":"Person","name":"UseMagicTools"},"publisher":{"@type":"Organization","name":"Web Toolbox","url":"https://www.usemagictools.com/"},"featureList":["Draw handwritten signature","Place signature on PDF page","Live PDF preview","Click to position signature","Export signed PDF","No upload required","No ads","No signup required","No watermark","100% browser-based","Unlimited usage"],"screenshot":"https://www.usemagictools.com/screenshots/e-sign-v1.webp"}</script>
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.usemagictools.com/"},{"@type":"ListItem","position":2,"name":"E-Sign Tool","item":"https://www.usemagictools.com/e-sign.html"}]}</script>
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"HowTo","name":"How to Sign PDF Online","totalTime":"PT1M","step":[{"@type":"HowToStep","position":1,"name":"Upload PDF","text":"Select PDF document you want to sign."},{"@type":"HowToStep","position":2,"name":"Draw signature","text":"Draw your signature in canvas and choose page and position."},{"@type":"HowToStep","position":3,"name":"Export signed PDF","text":"Click Sign & Download to generate signed PDF file."}]}</script>
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"What is an electronic signature tool?","acceptedAnswer":{"@type":"Answer","text":"An electronic signature tool allows you to draw or add a signature to digital documents such as PDF files. It is commonly used for contracts, invoices, approvals, and internal document workflows."}},{"@type":"Question","name":"Can I sign PDF without creating account?","acceptedAnswer":{"@type":"Answer","text":"Yes. This free online e-signature tool works directly in your browser with absolutely no login, signup, or account creation required. Simply upload your PDF, draw or type your signature, place it on the document, and download the signed file instantly. No ads, no watermarks, and no usage limits â€” everything processes privately in your browser."}},{"@type":"Question","name":"Can I choose signature position and page number?","acceptedAnswer":{"@type":"Answer","text":"Yes. You can click anywhere on the PDF preview to place your signature at the exact position you want, or use convenient preset positions like bottom-right, bottom-center, or bottom-left. You can also select which specific page to sign. This flexibility makes it easy to sign contracts and forms accurately. Completely free with no signup needed."}},{"@type":"Question","name":"Will my contract file be uploaded to server?","acceptedAnswer":{"@type":"Answer","text":"No. The entire signing process runs locally in your browser using client-side JavaScript for PDF rendering and manipulation. Your PDF documents, signature images, and personal data are never uploaded to any server or stored anywhere externally. This makes the tool safe for signing confidential contracts, legal agreements, and sensitive business documents with complete privacy."}},{"@type":"Question","name":"Is this tool really free with no ads?","acceptedAnswer":{"@type":"Answer","text":"Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All processing happens locally in your browser â€” your data is never uploaded to any server."}}]}</script>

  <style>
    :root{--bg:#020617;--panel:#0b1220;--card:#0f172a;--text:#e2e8f0;--muted:#94a3b8;--border:rgba(148,163,184,.15);--border-hover:rgba(148,163,184,.32);--pri:#38bdf8;--pri2:#0284c7;--pri-glow:rgba(56,189,248,.22);--accent:#a78bfa;--radius:14px;--glass:rgba(15,23,42,.72)}
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:"Inter","SF Pro Text",-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:var(--bg);color:var(--text);min-height:100vh;padding:24px 16px 60px;overflow-x:hidden}

    /* èƒŒæ™¯æµ®åŠ¨å…‰çƒ */
    body::before,body::after{content:'';position:fixed;border-radius:50%;pointer-events:none;z-index:0;filter:blur(80px);opacity:.45}
    body::before{width:600px;height:600px;top:-120px;left:-80px;background:radial-gradient(circle,rgba(56,189,248,.3),transparent 70%);animation:bgFloat 18s ease-in-out infinite}
    body::after{width:500px;height:500px;bottom:-100px;right:-60px;background:radial-gradient(circle,rgba(34,197,94,.2),transparent 70%);animation:bgFloat 22s ease-in-out infinite reverse}
    @keyframes bgFloat{0%,100%{transform:translate(0,0)}50%{transform:translate(40px,30px)}}

    .container{max-width:1200px;margin:0 auto;padding:40px;position:relative;z-index:1}

    h1{text-align:center;font-size:2.4rem;font-weight:800;letter-spacing:-.03em;background:linear-gradient(135deg,#bae6fd 0%,#38bdf8 40%,#a78bfa 100%);-webkit-background-clip:text;background-clip:text;color:transparent;animation:fadeInUp .7s ease both}
    .subtitle{text-align:center;color:var(--muted);margin:8px 0 24px;font-size:15px;animation:fadeInUp .7s .08s ease both}

    /* æ­¥éª¤æŒ‡ç¤ºå™¨ */
    .steps{display:flex;justify-content:center;gap:8px;margin-bottom:24px;animation:fadeInUp .7s .14s ease both}
    .step-dot{display:flex;align-items:center;gap:6px;padding:6px 14px;border-radius:20px;font-size:13px;font-weight:600;background:var(--glass);border:1px solid var(--border);color:var(--muted);transition:all .35s ease;backdrop-filter:blur(8px)}
    .step-dot.active{color:var(--pri);border-color:var(--pri);background:rgba(56,189,248,.12);box-shadow:0 0 16px var(--pri-glow)}
    .step-dot.done{color:#22c55e;border-color:rgba(34,197,94,.4);background:rgba(34,197,94,.1)}
    .step-num{width:22px;height:22px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:11px;background:rgba(148,163,184,.15);transition:all .3s}
    .step-dot.active .step-num{background:var(--pri);color:#fff}
    .step-dot.done .step-num{background:#22c55e;color:#fff}
    .step-sep{width:32px;height:2px;background:var(--border);border-radius:1px;align-self:center}

    /* å·¥ä½œåŒº */
    .workspace{display:grid;grid-template-columns:1fr 1fr;gap:16px;animation:fadeInUp .7s .2s ease both}

    /* ç»ç’ƒå¡ç‰‡ */
    .glass-card{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);padding:16px;transition:border-color .3s}
    .glass-card:hover{border-color:var(--border-hover)}
    .card-label{font-size:13px;font-weight:600;color:var(--pri);margin-bottom:12px;display:flex;align-items:center;gap:6px;text-transform:uppercase;letter-spacing:.04em}
    .card-label span{font-size:16px}

    /* PDF é¢„è§ˆåŒº */
    .preview-area{position:relative;background:rgba(2,6,23,.6);border:2px dashed var(--border);border-radius:12px;min-height:420px;display:flex;align-items:center;justify-content:center;overflow:hidden;cursor:pointer;transition:border-color .3s,background .3s}
    .preview-area.has-pdf{border-style:solid;cursor:crosshair}
    .preview-area.drag-over{border-color:var(--pri);background:rgba(56,189,248,.06)}
    .drop-prompt{text-align:center;color:var(--muted);padding:40px;transition:opacity .3s}
    .drop-prompt .icon{font-size:48px;margin-bottom:12px;display:block;opacity:.5}
    .drop-prompt .main-text{font-size:15px;margin-bottom:6px;color:var(--text)}
    .drop-prompt .sub-text{font-size:13px}
    .preview-area.has-pdf .drop-prompt{display:none}

    .pdf-canvas-wrap{position:relative;display:none;max-width:100%;max-height:560px}
    .preview-area.has-pdf .pdf-canvas-wrap{display:block}
    #pdfCanvas{max-width:100%;max-height:560px;border-radius:4px;display:block}
    /* ç­¾åå¹½çµå åŠ  */
    .sig-ghost{position:absolute;pointer-events:none;opacity:.65;border:2px dashed var(--pri);border-radius:4px;transition:opacity .2s;display:none}
    .sig-ghost img{width:100%;height:100%;object-fit:contain}

    .page-nav{display:flex;align-items:center;justify-content:center;gap:10px;margin-top:10px}
    .page-btn{width:34px;height:34px;border-radius:8px;border:1px solid var(--border);background:var(--glass);color:var(--text);font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}
    .page-btn:hover:not(:disabled){border-color:var(--pri);color:var(--pri)}
    .page-btn:disabled{opacity:.3;cursor:default}
    .page-info{font-size:13px;color:var(--muted);min-width:60px;text-align:center}

    /* ç­¾åæ¿ */
    .sig-section{display:flex;flex-direction:column;gap:12px}
    .sig-toolbar{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
    .color-btn{width:28px;height:28px;border-radius:50%;border:2px solid transparent;cursor:pointer;transition:all .2s;flex-shrink:0}
    .color-btn.active{border-color:var(--pri);box-shadow:0 0 8px var(--pri-glow);transform:scale(1.15)}
    .thickness-wrap{display:flex;align-items:center;gap:4px;margin-left:4px}
    .thickness-wrap input[type="range"]{width:70px;accent-color:var(--pri)}
    .thickness-label{font-size:11px;color:var(--muted);min-width:20px}
    .sig-btn{padding:6px 10px;border-radius:8px;border:1px solid var(--border);background:transparent;color:var(--muted);font-size:12px;cursor:pointer;transition:all .2s}
    .sig-btn:hover{color:var(--text);border-color:var(--border-hover)}

    .sig-pad-wrap{border:1px solid var(--border);border-radius:12px;overflow:hidden;background:#fff;position:relative}
    #sigPad{width:100%;height:200px;display:block;touch-action:none;cursor:crosshair}
    .sig-pad-hint{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#cbd5e1;font-size:14px;pointer-events:none;transition:opacity .3s}
    .sig-pad-wrap.has-stroke .sig-pad-hint{opacity:0}

    /* æ”¾ç½®ä¸å¯¼å‡º */
    .place-section{margin-top:4px}
    .place-row{display:flex;gap:8px;align-items:center;margin-bottom:10px;flex-wrap:wrap}
    .place-label{font-size:13px;color:var(--muted);min-width:50px}
    .place-select,.place-input{background:rgba(2,6,23,.7);border:1px solid var(--border);color:var(--text);border-radius:8px;padding:8px 10px;font-size:13px;transition:border-color .2s}
    .place-select:focus,.place-input:focus{outline:none;border-color:var(--pri);box-shadow:0 0 0 3px var(--pri-glow)}
    .place-input{width:70px}
    .size-slider{display:flex;align-items:center;gap:8px;width:100%}
    .size-slider input[type="range"]{flex:1;accent-color:var(--pri)}
    .size-val{font-size:12px;color:var(--muted);min-width:36px;text-align:right}

    .export-btn{width:100%;padding:14px;border-radius:12px;border:none;font-size:15px;font-weight:700;cursor:pointer;background:linear-gradient(135deg,var(--pri),var(--pri2));color:#fff;position:relative;overflow:hidden;transition:transform .2s,box-shadow .2s}
    .export-btn:hover{transform:translateY(-1px);box-shadow:0 8px 24px rgba(56,189,248,.3)}
    .export-btn:active{transform:translateY(0)}
    .export-btn:disabled{opacity:.5;cursor:default;transform:none;box-shadow:none}
    .export-btn.success{background:linear-gradient(135deg,#22c55e,#16a34a);animation:successPop .4s ease}
    @keyframes successPop{0%{transform:scale(1)}50%{transform:scale(1.03)}100%{transform:scale(1)}}

    .status{font-size:13px;min-height:18px;color:var(--pri);margin-top:8px;text-align:center;transition:color .2s}
    .status.err{color:#f87171}

    /* åŠ¨ç”» */
    /* Features */
    .features-section{margin-top:30px}
    .features-section h2,.faq-section h2{font-size:1.3rem;margin-bottom:16px;color:var(--text)}
    .features-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-top:12px}
    .feature{border:1px solid var(--border);border-radius:12px;padding:14px;background:rgba(2,6,23,.45);transition:border-color .25s,transform .25s}
    .feature:hover{border-color:var(--border-hover);transform:translateY(-2px)}
    .feature h4{margin:8px 0 6px;font-size:14px}
    .feature p{color:var(--muted);font-size:13px;line-height:1.55}

    /* FAQ */
    .faq-section{margin-top:30px}

    /* Related Tools */
    .related-tools{margin-top:30px}
    .related-tools h3{font-size:1.1rem;margin-bottom:12px;color:var(--text)}
    .related-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
    .faq-item{border:1px solid var(--border);border-radius:12px;margin-bottom:8px;overflow:hidden;background:rgba(2,6,23,.45);transition:border-color .2s}
    .faq-item:hover{border-color:var(--border-hover)}
    .faq-question{width:100%;text-align:left;background:transparent;border:0;color:var(--text);padding:14px 16px;font-size:14px;cursor:pointer;display:flex;justify-content:space-between;align-items:center}
    .faq-question::after{content:'+';font-size:18px;color:var(--muted);transition:transform .2s}
    .faq-item.active .faq-question::after{transform:rotate(45deg);color:var(--pri)}
    .faq-answer{display:none;padding:0 16px 14px;color:var(--muted);font-size:13px;line-height:1.65}.faq-item.active .faq-answer{display:block}

    /* å“åº”å¼ */
    @media(max-width:960px){.workspace{grid-template-columns:1fr}.features-grid,.related-grid{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:640px){h1{font-size:1.8rem}.features-grid,.related-grid{grid-template-columns:1fr}.steps{flex-wrap:wrap}.step-sep{width:16px}.sig-toolbar{gap:6px}}
  </style>
    <link rel="stylesheet" href="common/common.css">
</head>
<body>
<div class="container">
  <h1 data-i18n="title">E-Sign Tool</h1>
  <p class="subtitle" data-i18n="subtitle">Draw your signature and place it on PDF pages â€” click to position</p>

  <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
  <div class="steps">
    <div class="step-dot active" id="step1"><span class="step-num">1</span><span data-i18n="step1">Upload PDF</span></div>
    <div class="step-sep"></div>
    <div class="step-dot" id="step2"><span class="step-num">2</span><span data-i18n="step2">Draw Signature</span></div>
    <div class="step-sep"></div>
    <div class="step-dot" id="step3"><span class="step-num">3</span><span data-i18n="step3">Place & Export</span></div>
  </div>

  <!-- å·¥ä½œåŒº -->
  <div class="workspace">
    <!-- å·¦åˆ—ï¼šPDF é¢„è§ˆ -->
    <div class="glass-card">
      <div class="card-label"><span>ğŸ“„</span> <span data-i18n="pdfPreview">PDF Preview</span></div>
      <div class="preview-area" id="previewArea">
        <div class="drop-prompt" id="dropPrompt">
          <span class="icon">ğŸ“„</span>
          <div class="main-text" data-i18n="dropMain">Drop PDF here or click to upload</div>
          <div class="sub-text" data-i18n="dropSub">Your file stays local â€” nothing is uploaded</div>
        </div>
        <div class="pdf-canvas-wrap" id="canvasWrap">
          <canvas id="pdfCanvas"></canvas>
          <div class="sig-ghost" id="sigGhost"><img id="sigGhostImg" alt=""></div>
        </div>
      </div>
      <input id="fileInput" type="file" accept="application/pdf" style="display:none">
      <div class="page-nav" id="pageNav" style="display:none">
        <button class="page-btn" id="prevPage" disabled>â—€</button>
        <span class="page-info" id="pageInfo">1 / 1</span>
        <button class="page-btn" id="nextPage" disabled>â–¶</button>
      </div>
    </div>

    <!-- å³åˆ—ï¼šç­¾å + æ”¾ç½® + å¯¼å‡º -->
    <div class="glass-card sig-section">
      <div class="card-label"><span>âœï¸</span> <span data-i18n="drawLabel">Draw Signature</span></div>
      <div class="sig-toolbar">
        <button class="color-btn active" data-color="#1a1a2e" style="background:#1a1a2e" title="Black"></button>
        <button class="color-btn" data-color="#1e40af" style="background:#1e40af" title="Blue"></button>
        <button class="color-btn" data-color="#991b1b" style="background:#991b1b" title="Red"></button>
        <div class="thickness-wrap">
          <span class="thickness-label">1</span>
          <input type="range" id="penSize" min="1" max="8" value="3">
          <span class="thickness-label">8</span>
        </div>
        <button class="sig-btn" id="undoBtn" data-i18n="undo">Undo</button>
        <button class="sig-btn" id="clearSigBtn" data-i18n="clearSig">Clear</button>
      </div>
      <div class="sig-pad-wrap" id="sigPadWrap">
        <canvas id="sigPad" width="800" height="280"></canvas>
        <div class="sig-pad-hint" data-i18n="sigHint">Sign here with mouse or touch</div>
      </div>

      <div class="place-section">
        <div class="card-label" style="margin-top:4px"><span>ğŸ“</span> <span data-i18n="placeLabel">Placement</span></div>
        <div class="place-row">
          <span class="place-label" data-i18n="position">Position</span>
          <select class="place-select" id="posPreset">
            <option value="click" data-i18n="posClick">Click on PDF preview</option>
            <option value="br" data-i18n="posBR">Bottom Right</option>
            <option value="bl" data-i18n="posBL">Bottom Left</option>
            <option value="bc" data-i18n="posBC">Bottom Center</option>
          </select>
        </div>
        <div class="place-row">
          <span class="place-label" data-i18n="sigSize">Size</span>
          <div class="size-slider">
            <input type="range" id="sigSize" min="60" max="300" value="160">
            <span class="size-val" id="sizeVal">160</span>
          </div>
        </div>
      </div>

      <button class="export-btn" id="exportBtn" data-i18n="export">Sign & Download PDF</button>
      <div class="status" id="status"></div>
    </div>
  </div>

  <!-- Trust Bar -->
  <div class="trust-bar">
    <span class="trust-item" data-i18n="trust_users">ğŸŒ Used by 50,000+ users</span>
    <span class="trust-item" data-i18n="trust_rating">â­ 4.9/5 rating</span>
    <span class="trust-item" data-i18n="trust_privacy">ğŸ”’ 100% Private</span>
    <span class="trust-item" data-i18n="trust_free">ğŸš« No Ads, No Signup</span>
  </div>

  <!-- Features -->
  <section class="features-section"><h2 data-i18n="features_title">E-Sign Features</h2>
    <div class="features-grid">
      <article class="feature"><div>ğŸ”’</div><h4 data-i18n="f1_t">100% Free & Private</h4><p data-i18n="f1_d">No ads, no signup, no watermark. PDF signing runs locally in browser. Your contracts never leave your device.</p></article>
      <article class="feature"><div>âœï¸</div><h4 data-i18n="f2_t">Handwritten Signature</h4><p data-i18n="f2_d">Draw electronic signature with mouse or touch. Choose ink color and pen thickness for a natural look.</p></article>
      <article class="feature"><div>ğŸ‘ï¸</div><h4 data-i18n="f3_t">Live PDF Preview</h4><p data-i18n="f3_d">See your PDF pages in real time. Click on the preview to position your signature exactly where you want it.</p></article>
      <article class="feature"><div>â¬‡ï¸</div><h4 data-i18n="f4_t">Instant PDF Export</h4><p data-i18n="f4_d">Generate signed PDF and download immediately. Supports multi-page documents with page-by-page navigation.</p></article>
    </div>
  </section>

  <!-- FAQ -->
  <section class="faq-section"><h2 data-i18n="faq_title">Frequently Asked Questions</h2>
    <div class="faq-item"><button class="faq-question"><span data-i18n="faq1_q">What is an electronic signature tool?</span></button><div class="faq-answer" data-i18n="faq1_a">An electronic signature tool allows you to draw or add a signature to digital documents such as PDF files. It is commonly used for contracts, invoices, approvals, and internal document workflows. Unlike wet ink signatures, e-signatures can be applied instantly from any device with a browser.</div></div>
    <div class="faq-item"><button class="faq-question"><span data-i18n="faq2_q">Can I sign PDF without creating account?</span></button><div class="faq-answer" data-i18n="faq2_a">Yes. This online e-sign tool works directly in browser with no login and no signup. You can upload, draw your signature, position it on any page, and download the signed PDF in seconds.</div></div>
    <div class="faq-item"><button class="faq-question"><span data-i18n="faq3_q">How do I choose signature position?</span></button><div class="faq-answer" data-i18n="faq3_a">You can click directly on the PDF preview to place your signature at the exact location. Alternatively, use the position presets (Bottom Right, Bottom Left, Bottom Center) for quick placement. A ghost preview shows exactly where the signature will appear.</div></div>
    <div class="faq-item"><button class="faq-question"><span data-i18n="faq4_q">Will my contract file be uploaded to server?</span></button><div class="faq-answer" data-i18n="faq4_a">No. The entire signing process is handled locally in your browser using PDF-lib. Your PDF file and signature data never leave your device â€” there is no server-side processing or data transmission involved.</div></div>
    <div class="faq-item"><button class="faq-question"><span data-i18n="faq_free_q">Is this tool really free with no ads?</span></button><div class="faq-answer" data-i18n="faq_free_a">Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All processing happens locally in your browser â€” your data is never uploaded to any server.</div></div>
  </section>

  <!-- Related Tools -->
  <section class="related-tools">
    <h3 data-i18n="relatedToolsTitle">Related Tools</h3>
    <div class="related-grid">
      <a class="related-card" href="pdf-merge.html">
        <div>ğŸ“‘</div>
        <h4 data-i18n="relatedTool1">PDF Merge</h4>
        <p data-i18n="relatedTool1Desc">Merge signed documents into one file.</p>
      </a>
      <a class="related-card" href="pdf-compress.html">
        <div>ğŸ—œï¸</div>
        <h4 data-i18n="relatedTool2">PDF Compress</h4>
        <p data-i18n="relatedTool2Desc">Reduce size after adding signatures.</p>
      </a>
      <a class="related-card" href="pdf-protect.html">
        <div>ğŸ”</div>
        <h4 data-i18n="relatedTool3">PDF Protect</h4>
        <p data-i18n="relatedTool3Desc">Encrypt signed PDFs before sharing.</p>
      </a>
      <a class="related-card" href="watermark-tool.html">
        <div>ğŸ’§</div>
        <h4 data-i18n="relatedTool4">Watermark Tool</h4>
        <p data-i18n="relatedTool4Desc">Add extra watermark to signed files.</p>
      </a>
    </div>
  </section>
</div>

<script>
(function(){'use strict';
  /* ========== pdf.js åˆå§‹åŒ– ========== */
  if(window.pdfjsLib){
    pdfjsLib.GlobalWorkerOptions.workerSrc='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
  }

  /* ========== i18n ========== */
var i18n={
    en:{tool_name:'E-Sign Tool',back:'Back to Toolbox',title:'E-Sign Tool',subtitle:'Draw your signature and place it on PDF pages â€” click to position',step1:'Upload PDF',step2:'Draw Signature',step3:'Place & Export',pdfPreview:'PDF Preview',dropMain:'Drop PDF here or click to upload',dropSub:'Your file stays local â€” nothing is uploaded',drawLabel:'Draw Signature',sigHint:'Sign here with mouse or touch',undo:'Undo',clearSig:'Clear',placeLabel:'Placement',position:'Position',posClick:'Click on PDF preview',posBR:'Bottom Right',posBL:'Bottom Left',posBC:'Bottom Center',sigSize:'Size','export':'Sign & Download PDF',loading:'Loading PDF...',ok:'Signed PDF downloaded!',needPdf:'Please upload a PDF first',needSign:'Please draw your signature first',clickHint:'Click on the PDF preview to position your signature',err:'Failed to sign PDF',trust_users:'ğŸŒ Used by 50,000+ users',trust_rating:'â­ 4.9/5 rating',trust_privacy:'ğŸ”’ 100% Private',trust_free:'ğŸš« No Ads, No Signup',features_title:'E-Sign Features',f1_t:'100% Free & Private',f1_d:'No ads, no signup, no watermark. PDF signing runs locally in browser. Your contracts never leave your device.',f2_t:'Handwritten Signature',f2_d:'Draw electronic signature with mouse or touch. Choose ink color and pen thickness for a natural look.',f3_t:'Live PDF Preview',f3_d:'See your PDF pages in real time. Click on the preview to position your signature exactly where you want it.',f4_t:'Instant PDF Export',f4_d:'Generate signed PDF and download immediately. Supports multi-page documents with page-by-page navigation.',faq_title:'Frequently Asked Questions',faq1_q:'What is an electronic signature tool?',faq1_a:'An electronic signature tool allows you to draw or add a signature to digital documents such as PDF files. It is commonly used for contracts, invoices, approvals, and internal document workflows. Unlike wet ink signatures, e-signatures can be applied instantly from any device with a browser.',faq2_q:'Can I sign PDF without creating account?',faq2_a:'Yes. This online e-sign tool works directly in browser with no login and no signup. You can upload, draw your signature, position it on any page, and download the signed PDF in seconds.',faq3_q:'How do I choose signature position?',faq3_a:'You can click directly on the PDF preview to place your signature at the exact location. Alternatively, use the position presets (Bottom Right, Bottom Left, Bottom Center) for quick placement. A ghost preview shows exactly where the signature will appear.',faq4_q:'Will my contract file be uploaded to server?',faq4_a:'No. The entire signing process is handled locally in your browser using PDF-lib. Your PDF file and signature data never leave your device â€” there is no server-side processing or data transmission involved.',faq_free_q:'Is this tool really free with no ads?',faq_free_a:'Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All processing happens locally in your browser â€” your data is never uploaded to any server.',relatedToolsTitle:'Related Tools',relatedTool1:'PDF Merge',relatedTool1Desc:'Merge signed documents into one file.',relatedTool2:'PDF Compress',relatedTool2Desc:'Reduce size after adding signatures.',relatedTool3:'PDF Protect',relatedTool3Desc:'Encrypt signed PDFs before sharing.',relatedTool4:'Watermark Tool',relatedTool4Desc:'Add extra watermark to signed files.'},
    'zh-CN':{tool_name:'ç”µå­ç­¾åå·¥å…·',back:'è¿”å›å·¥å…·ç®±',title:'ç”µå­ç­¾åå·¥å…·',subtitle:'æ‰‹å†™ç­¾åå¹¶æ”¾ç½®åˆ° PDF é¡µé¢ â€” ç‚¹å‡»é¢„è§ˆåŒºå®šä½',step1:'ä¸Šä¼  PDF',step2:'æ‰‹å†™ç­¾å',step3:'æ”¾ç½®å¹¶å¯¼å‡º',pdfPreview:'PDF é¢„è§ˆ',dropMain:'æ‹–æ‹½ PDF åˆ°æ­¤å¤„ï¼Œæˆ–ç‚¹å‡»ä¸Šä¼ ',dropSub:'æ–‡ä»¶ä¸ä¼šç¦»å¼€ä½ çš„è®¾å¤‡',drawLabel:'æ‰‹å†™ç­¾å',sigHint:'åœ¨æ­¤ç”¨é¼ æ ‡æˆ–è§¦æ§ç­¾å',undo:'æ’¤é”€',clearSig:'æ¸…ç©º',placeLabel:'æ”¾ç½®è®¾ç½®',position:'ä½ç½®',posClick:'åœ¨ PDF é¢„è§ˆä¸Šç‚¹å‡»',posBR:'å³ä¸‹è§’',posBL:'å·¦ä¸‹è§’',posBC:'åº•éƒ¨å±…ä¸­',sigSize:'å¤§å°','export':'ç­¾ç½²å¹¶ä¸‹è½½ PDF',loading:'æ­£åœ¨åŠ è½½ PDF...',ok:'ç­¾ç½²æˆåŠŸï¼Œå·²ä¸‹è½½ï¼',needPdf:'è¯·å…ˆä¸Šä¼  PDF æ–‡ä»¶',needSign:'è¯·å…ˆç»˜åˆ¶ç­¾å',clickHint:'ç‚¹å‡» PDF é¢„è§ˆåŒºåŸŸæ”¾ç½®ç­¾å',err:'PDF ç­¾ç½²å¤±è´¥',trust_users:'ğŸŒ è¶…è¿‡ 50,000 ç”¨æˆ·ä½¿ç”¨',trust_rating:'â­ 4.9/5 å¥½è¯„',trust_privacy:'ğŸ”’ 100% éšç§å®‰å…¨',trust_free:'ğŸš« æ— å¹¿å‘Šã€æ— éœ€æ³¨å†Œ',features_title:'ç”µå­ç­¾ååŠŸèƒ½',f1_t:'100% å…è´¹ä¸”å®‰å…¨',f1_d:'æ— å¹¿å‘Šã€æ— éœ€æ³¨å†Œã€æ— æ°´å°ã€‚PDF ç­¾ç½²åœ¨æµè§ˆå™¨æœ¬åœ°å®Œæˆï¼ŒåˆåŒæ–‡ä»¶ä¸ä¼šç¦»å¼€ä½ çš„è®¾å¤‡ã€‚',f2_t:'æ‰‹å†™ç­¾å',f2_d:'ç”¨é¼ æ ‡æˆ–è§¦æ§ç»˜åˆ¶ç­¾åï¼Œå¯é€‰æ‹©å¢¨æ°´é¢œè‰²å’Œç¬”ç”»ç²—ç»†ã€‚',f3_t:'PDF å®æ—¶é¢„è§ˆ',f3_d:'å®æ—¶æŸ¥çœ‹ PDF é¡µé¢ï¼Œç‚¹å‡»é¢„è§ˆåŒºå³å¯ç²¾ç¡®å®šä½ç­¾åä½ç½®ã€‚',f4_t:'å³æ—¶å¯¼å‡º PDF',f4_d:'ä¸€é”®ç”Ÿæˆç­¾ç½²åçš„ PDF æ–‡ä»¶ï¼Œæ”¯æŒå¤šé¡µæ–‡æ¡£é€é¡µæµè§ˆã€‚',faq_title:'å¸¸è§é—®é¢˜',faq1_q:'ä»€ä¹ˆæ˜¯ç”µå­ç­¾åå·¥å…·ï¼Ÿ',faq1_a:'ç”µå­ç­¾åå·¥å…·å¯å°†ç­¾åæ·»åŠ åˆ° PDF ç­‰æ•°å­—æ–‡æ¡£ä¸­ï¼Œå¸¸ç”¨äºåˆåŒã€å‘ç¥¨ã€å®¡æ‰¹å’Œå†…éƒ¨æµç¨‹ã€‚ä¸ä¼ ç»Ÿç­¾åä¸åŒï¼Œç”µå­ç­¾åå¯åœ¨ä»»ä½•è®¾å¤‡çš„æµè§ˆå™¨ä¸­å³æ—¶å®Œæˆã€‚',faq2_q:'ä¸æ³¨å†Œä¹Ÿèƒ½ç­¾ç½² PDF å—ï¼Ÿ',faq2_a:'å¯ä»¥ã€‚è¯¥å·¥å…·æ— éœ€ç™»å½•æˆ–æ³¨å†Œï¼Œä¸Šä¼ åç»˜åˆ¶ç­¾åã€å®šä½æ”¾ç½®ï¼Œå³å¯ä¸‹è½½ç­¾ç½²åçš„ PDFã€‚',faq3_q:'å¦‚ä½•é€‰æ‹©ç­¾åä½ç½®ï¼Ÿ',faq3_a:'ä½ å¯ä»¥ç›´æ¥ç‚¹å‡» PDF é¢„è§ˆæ¥æ”¾ç½®ç­¾åï¼Œä¹Ÿå¯ä½¿ç”¨é¢„è®¾ä½ç½®ï¼ˆå³ä¸‹è§’ã€å·¦ä¸‹è§’ã€åº•éƒ¨å±…ä¸­ï¼‰å¿«é€Ÿå®šä½ã€‚åŠé€æ˜é¢„è§ˆä¼šæ˜¾ç¤ºç­¾åå°†å‡ºç°çš„ç¡®åˆ‡ä½ç½®ã€‚',faq4_q:'æ–‡ä»¶ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨å—ï¼Ÿ',faq4_a:'ä¸ä¼šã€‚æ•´ä¸ªç­¾ç½²æµç¨‹åœ¨æµè§ˆå™¨æœ¬åœ°ä½¿ç”¨ PDF-lib å®Œæˆï¼ŒPDF æ–‡ä»¶å’Œç­¾åæ•°æ®ä¸ä¼šç¦»å¼€ä½ çš„è®¾å¤‡ã€‚',faq_free_q:'è¿™ä¸ªå·¥å…·çœŸçš„å…è´¹ä¸”æ— å¹¿å‘Šå—ï¼Ÿ',faq_free_a:'æ˜¯çš„ï¼Œ100% å…è´¹ï¼Œæ— å¹¿å‘Šã€æ— éœ€æ³¨å†Œã€æ— æ°´å°ã€æ— é™åˆ¶ã€‚æ‰€æœ‰å¤„ç†éƒ½åœ¨æµè§ˆå™¨æœ¬åœ°å®Œæˆï¼Œä½ çš„æ•°æ®ä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨ã€‚',relatedToolsTitle:'ç›¸å…³å·¥å…·',relatedTool1:'PDF åˆå¹¶',relatedTool1Desc:'åˆå¹¶ç­¾ç½²åçš„å¤šä¸ªæ–‡ä»¶ã€‚',relatedTool2:'PDF å‹ç¼©',relatedTool2Desc:'ç­¾ç½²åå‹ç¼©ä½“ç§¯ã€‚',relatedTool3:'PDF ä¿æŠ¤',relatedTool3Desc:'åˆ†äº«å‰åŠ å¯†ç­¾ç½²æ–‡ä»¶ã€‚',relatedTool4:'æ°´å°å·¥å…·',relatedTool4Desc:'ç»™ç­¾ç½²æ–‡æ¡£åŠ é¢å¤–æ°´å°ã€‚'},
    fr:{tool_name:'Outil signature Ã©lectronique',back:'Retour Ã  la boÃ®te Ã  outils',title:'Outil signature Ã©lectronique',subtitle:'Dessinez votre signature et placez-la dans PDF â€” cliquez pour positionner',step1:'Charger PDF',step2:'Dessiner signature',step3:'Placer et exporter',pdfPreview:'AperÃ§u PDF',dropMain:'Glissez PDF ici ou cliquez pour charger',dropSub:'Votre fichier reste local',drawLabel:'Dessiner signature',sigHint:'Signez ici avec souris ou toucher',undo:'Annuler',clearSig:'Effacer',placeLabel:'Placement',position:'Position',posClick:'Cliquez sur l\'aperÃ§u PDF',posBR:'En bas Ã  droite',posBL:'En bas Ã  gauche',posBC:'En bas au centre',sigSize:'Taille','export':'Signer et tÃ©lÃ©charger PDF',loading:'Chargement PDF...',ok:'PDF signÃ© tÃ©lÃ©chargÃ© !',needPdf:'Choisissez un PDF',needSign:'Dessinez votre signature',clickHint:'Cliquez sur l\'aperÃ§u pour positionner',err:'Ã‰chec de la signature',trust_users:'ğŸŒ UtilisÃ© par 50 000+ utilisateurs',trust_rating:'â­ Note 4.9/5',trust_privacy:'ğŸ”’ 100% PrivÃ©',trust_free:'ğŸš« Sans pub, sans inscription',features_title:'Fonctions signature',f1_t:'100% Gratuit et PrivÃ©',f1_d:'Sans publicitÃ©, sans inscription, sans filigrane. Signature locale navigateur.',f2_t:'Signature manuscrite',f2_d:'Dessinez avec souris ou toucher. Choisissez couleur et Ã©paisseur.',f3_t:'AperÃ§u PDF en direct',f3_d:'Visualisez les pages et cliquez pour positionner la signature.',f4_t:'Export PDF immÃ©diat',f4_d:'GÃ©nÃ©rez le PDF signÃ© et tÃ©lÃ©chargez-le instantanÃ©ment.',faq_title:'Questions frÃ©quentes',faq1_q:'Qu\'est-ce qu\'un outil de signature Ã©lectronique ?',faq1_a:'Il permet d\'ajouter une signature aux documents numÃ©riques comme PDF. UtilisÃ© pour contrats, factures et validation. Contrairement Ã  la signature manuscrite, elle peut Ãªtre appliquÃ©e instantanÃ©ment depuis n\'importe quel navigateur.',faq2_q:'Puis-je signer sans compte ?',faq2_a:'Oui, aucun login requis. Chargez, signez et tÃ©lÃ©chargez en quelques secondes.',faq3_q:'Comment choisir la position ?',faq3_a:'Cliquez sur l\'aperÃ§u PDF pour placer la signature ou utilisez les prÃ©rÃ©glages (bas droite, bas gauche, bas centre). Un aperÃ§u fantÃ´me montre l\'emplacement exact.',faq4_q:'Le fichier est-il uploadÃ© ?',faq4_a:'Non, tout se fait localement dans le navigateur avec PDF-lib. Aucune donnÃ©e n\'est transmise.',faq_free_q:'Cet outil est-il vraiment gratuit et sans pub ?',faq_free_a:'Oui, 100% gratuit, sans publicitÃ©, sans inscription, sans filigrane et sans limites. Tout est traitÃ© localement dans votre navigateur.',relatedToolsTitle:'Outils associÃ©s',relatedTool1:'Fusion PDF',relatedTool1Desc:'Fusionner docs signÃ©s.',relatedTool2:'Compresser PDF',relatedTool2Desc:'RÃ©duire taille aprÃ¨s signature.',relatedTool3:'Protection PDF',relatedTool3Desc:'Chiffrer PDF signÃ©.',relatedTool4:'Outil filigrane',relatedTool4Desc:'Ajouter filigrane.'},
    es:{tool_name:'Herramienta de firma electrÃ³nica',back:'Volver a la caja de herramientas',title:'Herramienta de firma electrÃ³nica',subtitle:'Dibuja tu firma y colÃ³cala en pÃ¡ginas PDF â€” haz clic para posicionar',step1:'Subir PDF',step2:'Dibujar firma',step3:'Colocar y exportar',pdfPreview:'Vista previa PDF',dropMain:'Arrastra PDF aquÃ­ o haz clic para subir',dropSub:'Tu archivo no sale de tu dispositivo',drawLabel:'Dibujar firma',sigHint:'Firma aquÃ­ con ratÃ³n o toque',undo:'Deshacer',clearSig:'Limpiar',placeLabel:'ColocaciÃ³n',position:'PosiciÃ³n',posClick:'Clic en vista previa PDF',posBR:'Abajo derecha',posBL:'Abajo izquierda',posBC:'Abajo centro',sigSize:'TamaÃ±o','export':'Firmar y descargar PDF',loading:'Cargando PDF...',ok:'Â¡PDF firmado descargado!',needPdf:'Primero sube un PDF',needSign:'Primero dibuja tu firma',clickHint:'Haz clic en la vista previa para posicionar',err:'Error al firmar PDF',trust_users:'ğŸŒ Usado por mÃ¡s de 50,000 usuarios',trust_rating:'â­ CalificaciÃ³n 4.9/5',trust_privacy:'ğŸ”’ 100% Privado',trust_free:'ğŸš« Sin anuncios, sin registro',features_title:'Funciones de firma',f1_t:'100% Gratis y Privado',f1_d:'Sin anuncios, sin registro, sin marca de agua. Firma local en navegador.',f2_t:'Firma manuscrita',f2_d:'Dibuja con ratÃ³n o toque. Elige color y grosor del trazo.',f3_t:'Vista previa en vivo',f3_d:'Ve las pÃ¡ginas PDF y haz clic para posicionar la firma exactamente.',f4_t:'ExportaciÃ³n inmediata',f4_d:'Genera el PDF firmado y descÃ¡rgalo al instante.',faq_title:'Preguntas frecuentes',faq1_q:'Â¿QuÃ© es una herramienta de firma electrÃ³nica?',faq1_a:'Permite agregar firma a documentos digitales como PDF. Se usa para contratos, facturas y aprobaciones. A diferencia de la firma en papel, se aplica instantanÃ©neamente desde cualquier navegador.',faq2_q:'Â¿Puedo firmar sin cuenta?',faq2_a:'SÃ­, no necesitas login. Sube, firma y descarga en segundos.',faq3_q:'Â¿CÃ³mo elijo la posiciÃ³n?',faq3_a:'Haz clic en la vista previa PDF para colocar la firma o usa preajustes (abajo derecha, abajo izquierda, abajo centro). Una vista fantasma muestra la ubicaciÃ³n exacta.',faq4_q:'Â¿El archivo se sube al servidor?',faq4_a:'No, todo ocurre localmente en el navegador con PDF-lib. NingÃºn dato se transmite.',faq_free_q:'Â¿Es realmente gratis y sin anuncios?',faq_free_a:'SÃ­, 100% gratis, sin anuncios, sin registro, sin marca de agua y sin lÃ­mites. Todo se procesa localmente en tu navegador.',relatedToolsTitle:'Herramientas relacionadas',relatedTool1:'Unir PDF',relatedTool1Desc:'Une documentos firmados.',relatedTool2:'Comprimir PDF',relatedTool2Desc:'Reduce tamaÃ±o tras firmar.',relatedTool3:'Proteger PDF',relatedTool3Desc:'Cifra PDF firmado.',relatedTool4:'Marca de agua',relatedTool4Desc:'AÃ±ade marca adicional.'}
  };
function t(k){var lang=WebToolbox.getCurrentLang();var d=i18n[lang]||i18n.en;return d[k]||i18n.en[k]||k;}

  /* ========== DOM å¼•ç”¨ ========== */
  var fileInput=document.getElementById('fileInput');
  var previewArea=document.getElementById('previewArea');
  var pdfCanvas=document.getElementById('pdfCanvas');
  var pdfCtx=pdfCanvas.getContext('2d');
  var sigGhost=document.getElementById('sigGhost');
  var sigGhostImg=document.getElementById('sigGhostImg');
  var pageInfo=document.getElementById('pageInfo');
  var pageNav=document.getElementById('pageNav');
  var statusEl=document.getElementById('status');
  var exportBtn=document.getElementById('exportBtn');
  var posPreset=document.getElementById('posPreset');
  var sigSizeSlider=document.getElementById('sigSize');
  var sizeVal=document.getElementById('sizeVal');
  var sigPad=document.getElementById('sigPad');
  var sigCtx=sigPad.getContext('2d');
  var sigPadWrap=document.getElementById('sigPadWrap');

  /* ========== çŠ¶æ€ ========== */
  var pdfBytes=null,pdfDoc=null,pdfName='signed.pdf';
  var currentPage=1,totalPages=0,renderScale=1,pageWidth=0,pageHeight=0;
  var hasStroke=false,strokes=[],currentStroke=[];
  var sigX=0,sigY=0,clickPlaced=false;
  var penColor='#1a1a2e',penWidth=3;

  function setStatus(v,isErr){statusEl.textContent=v||'';statusEl.className='status'+(isErr?' err':'');}
  function updateStep(n){
    for(var i=1;i<=3;i++){
      var el=document.getElementById('step'+i);
      el.className='step-dot'+(i<n?' done':(i===n?' active':''));
    }
  }

  /* ========== PDF åŠ è½½ä¸é¢„è§ˆ ========== */
  function loadPdf(arrayBuf){
    pdfBytes=new Uint8Array(arrayBuf);
    setStatus(t('loading'));
    pdfjsLib.getDocument({data:pdfBytes.slice()}).promise.then(function(doc){
      pdfDoc=doc;
      totalPages=doc.numPages;
      currentPage=1;
      pageNav.style.display='flex';
      updateStep(2);
      renderPage(currentPage);
      setStatus('');
    }).catch(function(e){setStatus('PDF error: '+e.message,true);});
  }

  function renderPage(num){
    pdfDoc.getPage(num).then(function(page){
      /* æ ¹æ®å®¹å™¨å®½åº¦è‡ªé€‚åº”ç¼©æ”¾ */
      var vp0=page.getViewport({scale:1});
      pageWidth=vp0.width;
      pageHeight=vp0.height;
      var maxW=previewArea.clientWidth-24;
      renderScale=Math.min(maxW/vp0.width,2);
      var vp=page.getViewport({scale:renderScale});
      pdfCanvas.width=vp.width;
      pdfCanvas.height=vp.height;
      page.render({canvasContext:pdfCtx,viewport:vp}).promise.then(function(){
        previewArea.classList.add('has-pdf');
        pageInfo.textContent=num+' / '+totalPages;
        document.getElementById('prevPage').disabled=(num<=1);
        document.getElementById('nextPage').disabled=(num>=totalPages);
        updateGhost();
      });
    });
  }

  document.getElementById('prevPage').addEventListener('click',function(){if(currentPage>1){currentPage--;renderPage(currentPage);}});
  document.getElementById('nextPage').addEventListener('click',function(){if(currentPage<totalPages){currentPage++;renderPage(currentPage);}});

  /* æ–‡ä»¶é€‰æ‹© */
  previewArea.addEventListener('click',function(e){
    if(!pdfDoc){fileInput.click();return;}
    /* ç‚¹å‡»æ”¾ç½®ç­¾å */
    if(posPreset.value==='click'&&hasStroke){
      var rect=pdfCanvas.getBoundingClientRect();
      var cx=e.clientX-rect.left;
      var cy=e.clientY-rect.top;
      sigX=cx;sigY=cy;
      clickPlaced=true;
      updateGhost();
      updateStep(3);
    }
  });
  fileInput.addEventListener('change',function(){
    var f=fileInput.files&&fileInput.files[0];
    if(!f)return;
    pdfName=f.name.replace(/\.pdf$/i,'')+'-signed.pdf';
    f.arrayBuffer().then(loadPdf);
  });

  /* æ‹–æ‹½ä¸Šä¼  */
  ['dragenter','dragover'].forEach(function(ev){previewArea.addEventListener(ev,function(e){e.preventDefault();previewArea.classList.add('drag-over');});});
  ['dragleave','drop'].forEach(function(ev){previewArea.addEventListener(ev,function(e){e.preventDefault();previewArea.classList.remove('drag-over');});});
  previewArea.addEventListener('drop',function(e){
    var f=e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files[0];
    if(f&&f.type==='application/pdf'){
      pdfName=f.name.replace(/\.pdf$/i,'')+'-signed.pdf';
      f.arrayBuffer().then(loadPdf);
    }
  });

  /* ========== ç­¾åæ¿ ========== */
  sigCtx.lineCap='round';sigCtx.lineJoin='round';
  var drawing=false;

  function sigPoint(e){
    var r=sigPad.getBoundingClientRect();
    var cx=(e.clientX!==undefined?e.clientX:e.touches[0].clientX)-r.left;
    var cy=(e.clientY!==undefined?e.clientY:e.touches[0].clientY)-r.top;
    return{x:cx*sigPad.width/r.width,y:cy*sigPad.height/r.height};
  }
  function sigStart(e){
    drawing=true;
    currentStroke=[{x:0,y:0,color:penColor,width:penWidth}];
    var p=sigPoint(e);
    currentStroke[0].x=p.x;currentStroke[0].y=p.y;
    sigCtx.strokeStyle=penColor;sigCtx.lineWidth=penWidth;
    sigCtx.beginPath();sigCtx.moveTo(p.x,p.y);
    e.preventDefault();
  }
  function sigMove(e){
    if(!drawing)return;
    var p=sigPoint(e);
    currentStroke.push({x:p.x,y:p.y});
    sigCtx.lineTo(p.x,p.y);sigCtx.stroke();sigCtx.beginPath();sigCtx.moveTo(p.x,p.y);
    hasStroke=true;
    sigPadWrap.classList.add('has-stroke');
    e.preventDefault();
  }
  function sigEnd(){
    if(!drawing)return;
    drawing=false;
    if(currentStroke.length>1){strokes.push(currentStroke);}
    currentStroke=[];
    updateGhostImg();
  }

  sigPad.addEventListener('mousedown',sigStart);sigPad.addEventListener('mousemove',sigMove);window.addEventListener('mouseup',sigEnd);
  sigPad.addEventListener('touchstart',sigStart,{passive:false});sigPad.addEventListener('touchmove',sigMove,{passive:false});window.addEventListener('touchend',sigEnd);

  /* ç¬”é¢œè‰² */
  document.querySelectorAll('.color-btn').forEach(function(btn){
    btn.addEventListener('click',function(){
      document.querySelectorAll('.color-btn').forEach(function(b){b.classList.remove('active');});
      btn.classList.add('active');
      penColor=btn.getAttribute('data-color');
    });
  });
  /* ç¬”ç²—ç»† */
  document.getElementById('penSize').addEventListener('input',function(){penWidth=parseInt(this.value,10);});

  /* æ’¤é”€ */
  document.getElementById('undoBtn').addEventListener('click',function(){
    if(strokes.length===0)return;
    strokes.pop();
    redrawSig();
    if(strokes.length===0){hasStroke=false;sigPadWrap.classList.remove('has-stroke');}
    updateGhostImg();
  });
  /* æ¸…ç©º */
  document.getElementById('clearSigBtn').addEventListener('click',function(){
    strokes=[];currentStroke=[];hasStroke=false;
    sigCtx.clearRect(0,0,sigPad.width,sigPad.height);
    sigPadWrap.classList.remove('has-stroke');
    sigGhost.style.display='none';
    updateGhostImg();
  });

  function redrawSig(){
    sigCtx.clearRect(0,0,sigPad.width,sigPad.height);
    strokes.forEach(function(st){
      if(st.length<2)return;
      sigCtx.strokeStyle=st[0].color;sigCtx.lineWidth=st[0].width;
      sigCtx.beginPath();sigCtx.moveTo(st[0].x,st[0].y);
      for(var i=1;i<st.length;i++){sigCtx.lineTo(st[i].x,st[i].y);}
      sigCtx.stroke();
    });
  }

  /* ========== ç­¾åå¹½çµå åŠ  ========== */
  function updateGhostImg(){
    if(!hasStroke){sigGhostImg.src='';return;}
    sigGhostImg.src=sigPad.toDataURL('image/png');
    updateGhost();
  }

  function updateGhost(){
    if(!pdfDoc||!hasStroke){sigGhost.style.display='none';return;}
    var sw=parseInt(sigSizeSlider.value,10);
    /* ç­¾åå®½é«˜æ¯” */
    var ratio=sigPad.height/sigPad.width;
    var displayW=sw*renderScale;
    var displayH=displayW*ratio;
    var pos=posPreset.value;
    var gx,gy;

    if(pos==='click'&&clickPlaced){
      gx=sigX-displayW/2;
      gy=sigY-displayH/2;
    }else if(pos==='br'){
      gx=pdfCanvas.width-displayW-20*renderScale;
      gy=pdfCanvas.height-displayH-20*renderScale;
    }else if(pos==='bl'){
      gx=20*renderScale;
      gy=pdfCanvas.height-displayH-20*renderScale;
    }else if(pos==='bc'){
      gx=(pdfCanvas.width-displayW)/2;
      gy=pdfCanvas.height-displayH-20*renderScale;
    }else{
      sigGhost.style.display='none';return;
    }

    sigGhost.style.display='block';
    sigGhost.style.left=gx+'px';
    sigGhost.style.top=gy+'px';
    sigGhost.style.width=displayW+'px';
    sigGhost.style.height=displayH+'px';
  }

  posPreset.addEventListener('change',function(){clickPlaced=false;updateGhost();});
  sigSizeSlider.addEventListener('input',function(){sizeVal.textContent=this.value;updateGhost();});

  /* ========== å¯¼å‡ºç­¾ç½² PDF ========== */
  exportBtn.addEventListener('click',async function(){
    if(!pdfBytes){setStatus(t('needPdf'),true);return;}
    if(!hasStroke){setStatus(t('needSign'),true);return;}

    var pos=posPreset.value;
    if(pos==='click'&&!clickPlaced){setStatus(t('clickHint'),true);return;}

    exportBtn.disabled=true;
    setStatus(t('loading'));

    try{
      var doc=await PDFLib.PDFDocument.load(pdfBytes.slice());
      var pages=doc.getPages();
      var pidx=Math.max(0,Math.min(pages.length-1,currentPage-1));
      var pg=pages[pidx];
      var pgW=pg.getWidth(),pgH=pg.getHeight();
      var sw=parseInt(sigSizeSlider.value,10);
      var ratio=sigPad.height/sigPad.width;
      var sigW=sw,sigH=sw*ratio;

      /* è®¡ç®— PDF åæ ‡ï¼ˆåŸç‚¹å·¦ä¸‹è§’ï¼‰ */
      var pdfX,pdfY;
      if(pos==='click'){
        pdfX=(sigX/pdfCanvas.width)*pgW-sigW/2;
        pdfY=pgH-(sigY/pdfCanvas.height)*pgH-sigH/2;
      }else if(pos==='br'){
        pdfX=pgW-sigW-20;pdfY=20;
      }else if(pos==='bl'){
        pdfX=20;pdfY=20;
      }else{
        pdfX=(pgW-sigW)/2;pdfY=20;
      }

      /* è¾¹ç•Œçº¦æŸ */
      pdfX=Math.max(0,Math.min(pgW-sigW,pdfX));
      pdfY=Math.max(0,Math.min(pgH-sigH,pdfY));

      var sigDataUrl=sigPad.toDataURL('image/png');
      var sigImg=await doc.embedPng(sigDataUrl);
      pg.drawImage(sigImg,{x:pdfX,y:pdfY,width:sigW,height:sigH});

      var out=await doc.save();
      var blob=new Blob([out],{type:'application/pdf'});
      var a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=pdfName;a.click();URL.revokeObjectURL(a.href);

      setStatus(t('ok'));
      exportBtn.classList.add('success');
      setTimeout(function(){exportBtn.classList.remove('success');},1500);
    }catch(err){
      setStatus(t('err')+': '+err.message,true);
    }finally{
      exportBtn.disabled=false;
    }
  });

  /* ========== å¯¼å‡º translations ========== */
  window._translations=i18n;
})();
</script>
    <script src="common/common.js" data-tool-id="e-sign" data-tool-name="E-Sign Tool" data-category="pdf"></script>
    <script>WebToolbox.init(window._translations);</script>

</body>
</html>
